if (typeof performance !== "undefined" && performance.mark) performance.mark("MeasureParseTime::start::Sway~Consumption.chunk.js");(window.webpackJsonp=window.webpackJsonp||[]).push([[1],{10:
/*!************************************************!*\
  !*** ./src/Consumption/index.tsx + 98 modules ***!
  \************************************************/
/*! exports provided: ISyncStateReporter, IReportingOptions, IDocumentSynchronizer, createDocumentModelDelta, DocumentSynchronizer, fullDocumentContinuationToken, monitorJoinSession, routeDetailsPropertyName, lastNotificationPropertyName, observableUpdateType, pollingForNotificationsPropertyName, ISyncStateStore, SyncStateStore, IMessageBusNotificationClient, IMessageBusNotification, MessageBusNotificationType, IAuthorListNotification, IAuthoringBundleContents, FontFaceAdder, IFontFaceAdder, ConsumptionAttributes, AspectRatioCalculator, IKeyframeAnimator, KeyframeAnimator, ITransitionAnimator, TransitionAnimator, documentComponentRegistry, IAuthoringComponentRegistration, IDocumentComponentRegistration, IDocumentContext, DocumentContextFactory, IDocumentContextFactory, ConsumptionSelectors, DocumentBlock, IDocumentBlock, DocumentBlockFactory, IViewModelCreateProps, LayoutViewModelFactory, ILayoutViewModelFactory, IAuthoringViewModelCreateProps, IDocumentRefResolvers, IViewModelFactory, DocumentViewFactory, IDocumentView, IModelViewProps, DocumentViewModelFactory, IDecoratorState, AuthoringViewModelType, IAuthoringViewModelClass, IAuthoringViewModel, IDocumentViewModelClass, IDocumentViewModel, IViewModelProps, BlockTextViewModel, CaptionedContentViewModel, CellViewModel, ComparisonViewModel, DocumentHeadingViewModel, FlowBodyViewModel, FlowDocViewModel, H1ViewModel, H2ViewModel, ImageViewModel, LiquidLayoutViewModel, MediaAndTextViewModel, ParagraphViewModel, TextRunStore, TextFormatter, IResolvedTextRunWithChildren, IResolvedTextRunWithNoChildren, OrnamentViewModel, RowViewModel, SelectionStore, ISelectionStore, SlideshowViewModel, StackViewModel, StyleWrapper, TableViewModel, TextViewModel, Text, TextListViewModel, UniformGridViewModel, UnknownViewModel, UnpopulatedViewModel, VideoViewModel, DocumentContent, DocumentContentStore, IPendingRef, IViewReferenceCache, ViewReferenceCache, AnimationsEnabledStore, IAnimationsEnabledStore, RightHeader, RightHeaderStore, IDocumentNavigationLaunchStatus, IDocumentNavigationLauncherStore, DocumentNavigationLauncherStore, FocusHolder, IFocusHolder, bindConsumptionContainer, ConsumptionInjectionTypes, ConsumptionUiStrings, DocumentModelStore, IDocumentModelStore, IDocumentModelStoreReadWrite, IStoredDocumentModel, IDocumentModelStoreChangeNotifier, findInLayoutSubtree, IDocumentSegmentFetcherProgress, IDocumentAnimationRefResolver, IDocumentAnimationSequenceRefResolver, IDocumentContractRefResolver, IDocumentDecoratorRefResolver, IDocumentDefaultTemplateContentNodeResolver, IDocumentStyleRefResolver, IDocumentComputedStyleRefResolver, IDevToolsDependencies, createDiffPatcher, GenericClientActionMonitor, getContentParent, getContentGrandparent, viewportToDomRect, directionToDirAttribute, ISelectionStyleResolver, SelectionStyleResolver, IFocusStyleResolver, FocusStyleResolver, IVisibleComponentTracker, VisibleComponentTracker, initialize */
/*! all exports used */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@sway/documentmodel/js/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@sway/internalapi/js/InternalApi.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/aria-roles/aria-roles.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/classnames/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/history/es/index.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/http-status-codes/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/inversify/lib/inversify.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/jsondiffpatch/dist/jsondiffpatch.esm.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/mobx-safe/src/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/mobx-utils/mobx-utils.module.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/mobx/lib/mobx.module.js (<- Module uses injected variables (process, global)) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/url/url.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/mobx-react/index.module.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/MessageBar/MessageBar.types.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Shimmer/Shimmer.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Spinner/Spinner.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Spinner/Spinner.types.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/react/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Bundles/BundleImporter.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Bundles/SwayBundleImporter.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/ClientActions/ClientActionData.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Common/BackgroundTaskWrapper.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Components/Accessibility/PageRegionNavigator.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Components/Router/RouteDefinitions.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Components/Router/RouteDetails.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Components/Router/RouterStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Components/SiteComponents/StickyHeaderContainer/StickyHeaderContainerStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Dialogs/SwayDialogSchedulerStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Events/ActivityMonitor.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Events/EventTypes.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Events/KeyNames.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Injection/BootInjectionTypes.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Localization/BootUiStrings.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Logging/AlreadyLoggedError.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Logging/Logger.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Settings/FeatureGateList.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Settings/SettingsStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Styles/FontUtilities.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Utilities/CreatePromise.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Utilities/DeepCopy.ts because of ./src/Authoring/NodeCreation/DefaultLayoutNodeStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Utilities/Iteration.ts because of ./src/Authoring/NodeCreation/LayoutNodeFactories/ImageLayoutNodeFactory.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Utilities/NamedObserver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Adapters/DevToolsBundleImporter.ts because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Adapters/DocumentNavigationBundleImporter.ts because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/CalloutStore.tsx because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/ConsumptionAttributes.ts because of ./src/Authoring/Components/AuthoringComponents/ParagraphPlaceholder.tsx */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/ConsumptionSelectors.ts because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/BaseDocumentViewModel.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/DocumentBlock/LayoutViewModelFactory.ts because of ./src/Authoring/Components/AuthoringComponents/DocumentHeadingPlaceholderViewModel.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/FocusStyleResolver.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/H1/H1ViewModel.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/H2/H2ViewModel.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/Paragraph/ParagraphViewModel.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/Paragraph/TextFormatter.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/Paragraph/TextRunStore.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/SelectionStore.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/SelectionStyleResolver.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/Unknown/UnknownViewModel.ts because of ./src/Authoring/Components/AuthoringComponents/DocumentHeadingPlaceholderViewModel.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/ViewModelContextUtilities.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/DocumentComponents/VisibleComponentTracker.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/Referencing/ViewReferenceCache.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/Settings/AccessibilityViewSwitcher.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/Settings/AnimationsEnabledStore.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/Settings/UserAnimationsEnabledStore.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/Sharing/SharingMenuStore.ts because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/SiteComponents/Header/Buttons/FeedbackButtonStore.ts because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/SiteComponents/Header/CogWheelMenuStore.ts because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/SiteComponents/Header/RightHeader.tsx because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/SiteComponents/Header/RightHeaderStore.ts because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/SiteComponents/Navigation/DocumentNavigationLauncherStore.ts because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Injection/ConsumptionInjectionTypes.ts because of ./src/Authoring/Synchronization/ChangeSynchronization/ChangeSynchronizer.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Localization/ConsumptionUIStrings.ts because of ./src/Authoring/Components/SiteComponents/AuthoringHeaderStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Models/DocumentModelStore.ts because of ./src/Authoring/Synchronization/ChangeSynchronization/ChangeSynchronizer.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Models/DocumentModelTraversal.ts because of ./src/Authoring/Synchronization/ModelEditor/ModelEditor.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Notification/Messages/MessageBusNotification.ts because of ./src/Authoring/Synchronization/ChangeSynchronization/ChangeSynchronizer.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Synchronization/DocumentSynchronizer.ts because of ./src/Authoring/Synchronization/ChangeSynchronization/ChangeSynchronizer.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Synchronization/Monitoring.ts because of ./src/Authoring/Synchronization/ChangeSynchronization/ChangeSynchronizer.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Utilities/DomRect.ts because of ./src/Authoring/Components/AuthoringViewModelResolver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Utilities/TextDirection.ts because of ./src/Authoring/Components/AuthoringComponents/TextEdit.tsx */function(e,t,n){"use strict";n.r(t);var o,r=n(346),i=n(286),a=n(17),s=n(289),c=n(61),u=n(5),l=n(0),d=n(2),p=n(343),h=18e4,f=1e3,m=function(){function e(e,t,n){var o=this;this.setInterval=e,this.clearInterval=t,this.activityMonitor=n,this.totalActiveTime=0,this.activeTimeInterval=0,this.updateActiveTime=function(){return __awaiter(o,void 0,Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return this.activityMonitor.getMsSinceLastActive()<h?(this.totalActiveTime+=f,[2]):(this.clearInterval(this.activeTimeInterval),this.activeTimeInterval=0,[4,this.activityMonitor.untilActive(h)]);case 1:return e.sent(),this.ensureTimeTrackingIntervalIsRunning(),[2]}})})},this.ensureTimeTrackingIntervalIsRunning=function(){0===o.activeTimeInterval&&(o.activeTimeInterval=o.setInterval(o.updateActiveTime,f))}}return e.prototype.start=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.activityMonitor.untilActive(h)];case 1:return e.sent(),this.ensureTimeTrackingIntervalIsRunning(),[2]}})})},e.prototype.getTotalActiveTime=function(){return this.totalActiveTime},e.prototype.resetActiveTime=function(){this.totalActiveTime=0},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.SetInterval)),__param(1,Object(d.inject)(a.a.ClearInterval)),__param(2,Object(d.inject)(p.a))],e)}(),g=n(69),b=n(254),y=n(18),v=new Set([g.LayoutNodeType.Image,g.LayoutNodeType.Paragraph]),_=function(){function e(e,t,n){var o=this;this.getTimestamp=e,this.visibleComponentTracker=t,this.modelStore=n,this.timeSpentAtComponents=new Map,this.timeComponentsEnteredView=new Map,this.visibleComponentsInDocumentCount=0,this.visibleComponentChange=function(e){"add"===e.type?o.recordComponentEnteredView(e.newValue.model.contractRef):"delete"===e.type&&o.recordComponentLeaveView(e.oldValue.model.contractRef)},this.recordComponentEnteredView=function(e){o.timeComponentsEnteredView.set(e,o.getTimestamp())},this.recordComponentLeaveView=function(e){var t=o.getTimestamp(),n=o.timeComponentsEnteredView.get(e);void 0===n&&(n=t);var r=t-n,i=o.timeSpentAtComponents.get(e);void 0===i&&(i=0),o.timeSpentAtComponents.set(e,i+r),o.timeComponentsEnteredView.delete(e)}}return e.prototype.start=function(){this.visibleComponentTracker.observe(this.visibleComponentChange);for(var e=0,t=Array.from(this.visibleComponentTracker.visibleComponents);e<t.length;e++){var n=t[e];this.recordComponentEnteredView(n.model.contractRef)}for(var o=0,r=this.modelStore.model.documentIndex.readingStats.perContentCount;o<r.length;o++){var i=r[o];v.has(i.type)&&(this.visibleComponentsInDocumentCount+=i.count)}},e.prototype.getVisibleContentCount=function(){return this.visibleComponentsInDocumentCount},e.prototype.getTimeSpentAtContentIds=function(){var e=this,t=new Map(this.timeSpentAtComponents);return this.timeComponentsEnteredView.forEach(function(n,o){var r=t.get(o);void 0===r&&(r=0);var i=r+(e.getTimestamp()-n);t.set(o,i)}),t},e.prototype.resetTimeSpentAtComponents=function(){this.timeSpentAtComponents.clear()},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.GetTimestamp)),__param(1,Object(d.inject)(b.b)),__param(2,Object(d.inject)(y.a))],e)}(),S=n(76),w=function(){function e(e,t){var n=this;this.viewport=e,this.eventEmitter=t,this.maxScrollDepth=0,this.currentScrollDepth=0,this.updateMaxScrollDepth=function(e){var t=0,o=n.viewport.size;void 0!==o&&(t=o.height);var r=e.documentHeight,i=(e.scrollY+t)/r,a=(i=isNaN(i)?0:i)>1?1:i;n.maxScrollDepth=Math.max(n.maxScrollDepth,a),n.currentScrollDepth=a}}return e.prototype.start=function(){this.eventEmitter.on(S.a.ScrollThrottled,this.updateMaxScrollDepth)},e.prototype.getMaxScrollDepth=function(){return this.maxScrollDepth},e.prototype.resetMaxScrollDepth=function(){this.maxScrollDepth=this.currentScrollDepth},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.Viewport)),__param(1,Object(d.inject)(a.a.EventReceiver))],e)}(),C=18e5,j=function(){function e(e,t,n,o,r){var i=this;this.setTimeout=e,this.activityMonitor=t,this.activeTimeTracker=n,this.scrollDepthTracker=o,this.contentViewTimeTracker=r,this.expiredSessionCheck=function(){return __awaiter(i,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return this.activityMonitor.getMsSinceLastActive()>C?[4,this.activityMonitor.untilActive(C)]:[3,2];case 1:t.sent(),this.resumeSession(),t.label=2;case 2:return e=C-this.activityMonitor.getMsSinceLastActive(),this.setTimeout(this.expiredSessionCheck,e),[2]}})})}}return e.prototype.start=function(){this.setTimeout(this.expiredSessionCheck,C)},e.prototype.isSessionActive=function(){return this.activityMonitor.getMsSinceLastActive()<18e4},e.prototype.resumeSession=function(){this.activeTimeTracker.resetActiveTime(),this.scrollDepthTracker.resetMaxScrollDepth(),this.contentViewTimeTracker.resetTimeSpentAtComponents()},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.SetTimeout)),__param(1,Object(d.inject)(p.a)),__param(2,Object(d.inject)(m)),__param(3,Object(d.inject)(w)),__param(4,Object(d.inject)(_))],e)}(),M=n(19),R=n(15),O=function(){function e(e,t){this.contentViewTimeTracker=e,this.logger=t}return e.prototype.calculateCurrentGrade=function(){if(0===this.contentViewTimeTracker.getVisibleContentCount())return 0;var e=0,t=0;this.contentViewTimeTracker.getTimeSpentAtContentIds().forEach(function(n){n>=3e3?t++:n>=1e3&&e++});var n=(2*t+e)/this.contentViewTimeTracker.getVisibleContentCount();return this.logger.logTag(595957829,M.b.Info,"Generated read ratio grade",{overallGrade:n,quickCount:e,deepGradeCount:t,visibileContentCount:this.contentViewTimeTracker.getVisibleContentCount()}),n},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(_)),__param(1,Object(d.inject)(M.c))],e)}(),T=function(){function e(e,t,n,o,r,i,a,s,c){var u=this;this.analyticsApi=e,this.eventEmitter=t,this.setInterval=n,this.documentSettingsStore=o,this.activeTimeTracker=r,this.scrollDepthTracker=i,this.readRatioGrader=a,this.activeSessionMonitor=s,this.logger=c,this.uploadAnalytics=function(){return __awaiter(u,void 0,void 0,function(){var e,t,n,o;return __generator(this,function(r){switch(r.label){case 0:return this.activeSessionMonitor.isSessionActive()?(e=this.documentSettingsStore.settings.lookupId,t=this.activeTimeTracker.getTotalActiveTime(),n=this.scrollDepthTracker.getMaxScrollDepth(),o=this.readRatioGrader.calculateCurrentGrade(),[4,this.analyticsApi.submitAnalytics(e,t,n,o)]):[2];case 1:return r.sent(),this.logger.logTag(595957830,M.b.Info,"Uploaded Analytics",{totalActiveTime:t,scrollDepthPercent:n,readRatioGrade:o}),[2]}})})}}return e.prototype.start=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(e){return this.documentSettingsStore.settings.userAccess!==u.UserStoryAccess.Viewer?[2]:(this.eventEmitter.on(S.a.Blur,this.uploadAnalytics),this.eventEmitter.on(S.a.BrowserClose,this.uploadAnalytics),this.setInterval(this.uploadAnalytics,12e4),[2])})})},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(u.DocumentAnalyticsApi)),__param(1,Object(d.inject)(a.a.EventEmitter)),__param(2,Object(d.inject)(a.a.SetInterval)),__param(3,Object(d.inject)(R.a.DocumentSettingsStore)),__param(4,Object(d.inject)(m)),__param(5,Object(d.inject)(w)),__param(6,Object(d.inject)(O)),__param(7,Object(d.inject)(j)),__param(8,Object(d.inject)(M.c))],e)}(),A=n(60),P=[S.a.GenericClick,S.a.GlobalKeydown,S.a.GlobalMouseDown,S.a.ScrollThrottled],E=((o={})[S.a.GenericClick]=s.a.GenericClick,o[S.a.GlobalKeydown]=s.a.GlobalKeydown,o[S.a.GlobalMouseDown]=s.a.GlobalMouseDown,o[S.a.ScrollThrottled]=s.a.GlobalMouseWheel,o),I=function(){function e(e,t,n,o,r,i){var a=this;this.eventReceiver=e,this.clientActionRecorder=t,this.routerStore=n,this.logger=o,this.documentSettingsStore=r,this.flushLogs=i,this.genericClientActionCounters={},this.logAndResetCounters=function(){for(var e=0,t=Object.keys(a.genericClientActionCounters);e<t.length;e++){var n=t[e];a.clientActionRecorder.recordAction(E[n],{Count:a.genericClientActionCounters[n]}),a.genericClientActionCounters[n]=0}};for(var s=0,c=P;s<c.length;s++){var u=c[s];this.genericClientActionCounters[u]=0}this.isFirstInteractionLogged=!1}return e.prototype.monitorEvents=function(){for(var e=this,t=function(t){n.eventReceiver.on(t,function(){e.routerStore.routeDetails.pageMode===A.a.Document&&e.routerStore.routeDetails.inAuthoring||(e.genericClientActionCounters[t]++,e.isFirstInteractionLogged||(e.isFirstInteractionLogged=!0,e.logger.logTag(595986564,M.b.Info,"First users interaction",{Counter:E[t],storyId:e.documentSettingsStore.settings.storyId,lookupId:e.documentSettingsStore.settings.lookupId}),e.flushLogs()))})},n=this,o=0,r=P;o<r.length;o++){t(r[o])}this.eventReceiver.on(S.a.BrowserClose,this.logAndResetCounters)},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.EventEmitter)),__param(1,Object(d.inject)(a.a.ClientActionRecorder)),__param(2,Object(d.inject)(c.a)),__param(3,Object(d.inject)(M.c)),__param(4,Object(d.inject)(R.a.DocumentSettingsStore)),__param(5,Object(d.inject)(a.a.FlushLogs))],e)}(),x=n(58),V=function(e,t){for(var n=0;n<e.length;++n)if(e[n]===t)return!0;return!1},k=function(e){return e.querySelectorAll('button, [href], input, select, textarea, [tabindex]:not([tabindex="-1"])')},D=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.rootElementRef=l.createRef(),t.setFocus=function(e){if(null===t.rootElementRef.current)throw new Error("Cannot set region focus because root element is not defined. Region may have unmounted.");var n=k(t.rootElementRef.current);return void 0!==e&&V(n,e)?(e.focus(),!0):n.length>0&&(n[0].focus(),!0)},t}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=e.children,n=(e.navigator,e.order,__rest(e,["children","navigator","order"]));return l.createElement("div",__assign({role:x.Roles.Region,ref:this.rootElementRef},n),t)},t.prototype.componentDidMount=function(){this.props.navigator.addRegion({id:this.props.id,order:this.props.order,setFocus:this.setFocus})},t.prototype.componentWillUnmount=function(){this.props.navigator.removeRegion(this.props.id)},t}(l.Component),F=n(463),L=n(59),N=n(13),B=n(243),H={overflow:"hidden"},U=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return l.createElement("div",{className:B.a.DocumentContentContainer,lang:this.props.store.documentLanguage,dir:this.props.store.documentTextDirection},this.props.store.documentHeaderStore.documentHeader,l.createElement(D,{id:F.a.DocumentContent,navigator:this.props.store.pageRegionNavigator,order:F.c.DocumentContent,className:L(B.a.DocumentContent,this.props.store.styleProvider.css(H))},this.props.store.rootView))},t=__decorate([N.a],t)}(l.Component),W=n(3),q=n(77),G=n(490),z=n(302),K=function(){function e(e){this.authoringBundleImporter=e}return e.prototype.import=function(){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(e){return void 0===this.pendingLoad&&(this.pendingLoad=this.authoringBundleImporter.import()),[2,this.pendingLoad]})})},e}(),J=n(44),Q=n(9),$=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props,t=e.store,n=e.children,o=e.useSpan;if(!t.isAnimated)return n;var r=function(e){return l.cloneElement(n,{className:L.apply(void 0,e)})},i={onChange:t.onIntersectionObserverChange,triggerOnce:!0,rootMargin:"100% 0% 0% 0%"},a=!0===o?"span":"div";return l.createElement(t.intersectionObserver,__assign({tag:a},i),function(){var e=[n.props.className];return e.push(t.styleProvider.css(t.animatedStyles)),o?l.createElement("span",{ref:t.animationElementRef,"data-component":Q.a.Animation},r(e)):l.createElement("div",{ref:t.animationElementRef,"data-component":Q.a.Animation},r(e))}())},t.prototype.componentDidUpdate=function(){var e=this.props.store;e.setAnimationElementRef(),e.calculateViewportIntersection()},t=__decorate([N.a],t)}(l.Component),Y=Object(J.a)("BlockText",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement($,{store:n.animationStore},l.createElement("blockquote",{className:n.styleProvider.css(n.style),"data-component":Q.a.BlockText},t.renderMany(n.children)))}),Z=n(8),X=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"children",null),t}(Z.b),ee=function(e){return{position:"relative",display:e.captionPosition===g.CaptionPosition.Floating?"block":"table"}},te=function(e){return{bottom:0,width:"100%",boxSizing:"border-box",position:e.captionPosition===g.CaptionPosition.Floating?"absolute":"relative",display:e.captionPosition===g.CaptionPosition.Floating?"block":"table-caption",captionSide:"bottom"}},ne=function(e){return{transition:"max-height 0.5s ease-in-out",maxHeight:e.captionIsExpanded?"217px":"39px",overflowY:e.captionIsExpanded?"scroll":"hidden","& p":{textOverflow:e.captionIsExpanded?"initial":"ellipsis",overflow:e.captionIsExpanded?"initial":"hidden",whiteSpace:e.captionIsExpanded?"normal":"nowrap"}}},oe=Object(J.a)("CaptionedContent",function(e){var t,n=e.viewModel,o=e.viewFactory;return l.createElement($,{store:n.animationStore},l.createElement("div",{className:n.styleProvider.css(ee(n),n.style),"data-component":Q.a.CaptionedContent},o.render(n.media),l.createElement("div",{className:(t=n.styleProvider).css.apply(t,function(e){var t=[];return t.push(te(e)),e.captionPosition===g.CaptionPosition.Floating&&t.push(ne(e)),t}(n)),"data-component":Q.a.CaptionedContentCaption,role:x.Roles.Textbox},o.render(n.caption))))}),re=function(e){function t(t,n,o,r,i,s){var c=e.call(this,t,n,o,r,i,s)||this;return c.styleProvider=o.get(a.a.StyleProvider),c}return __extends(t,e),Object.defineProperty(t.prototype,"aspectRatio",{get:function(){return this.media.aspectRatio},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"media",{get:function(){return this.createChild(this.model.child)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"caption",{get:function(){return this.createChild(this.model.caption)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"captionIsExpanded",{get:function(){return void 0!==this.caption&&this.selectionStore.isSelected(this.caption)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"captionPosition",{get:function(){return this.model.position},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"aspectRatio",null),__decorate([W.computed],t.prototype,"media",null),__decorate([W.computed],t.prototype,"caption",null),__decorate([W.computed],t.prototype,"captionIsExpanded",null),__decorate([W.computed],t.prototype,"captionPosition",null),t}(Z.b),ie=Object(J.a)("ApplyCellType",function(e){var t=e.cellType,n=e.props,o=e.children,r=t===g.CellType.Data?"td":"th";return l.createElement(r,__assign({},n),o)}),ae=function(e){return{border:"1px solid #000000",padding:"8px",textAlign:"left",fontSize:"20px",width:e+"%"}},se=Object(J.a)("Cell",function(e){var t=e.viewFactory,n=e.viewModel,o={colSpan:n.content.columnSpan,"data-component":Q.a.Cell,rowSpan:n.content.rowSpan,className:n.styleProvider.css(ae(n.content.widthPercentage),n.style),key:n.model.id};return l.createElement(ie,{cellType:n.content.cellType,props:o},t.renderMany(n.children))}),ce=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"children",null),t}(Z.b),ue=Object(J.a)("DocumentHeading",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("div",{className:n.styleProvider.css(n.style),"data-component":Q.a.DocumentHeading,ref:n.viewReferenceCache.createRef(n.content.id)},t.render(n.background),t.render(n.title),t.render(n.subtitle),t.render(n.author))}),le=n(26),de={ariaLevel:1},pe=function(e){function t(t,n,o,r,i,a){var s=e.call(this,t,n,o,r,i,a)||this;return s.viewReferenceCache=o.get(le.c),s}return __extends(t,e),Object.defineProperty(t.prototype,"author",{get:function(){return this.createChild(this.model.author)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"title",{get:function(){return this.createChild(this.model.title,de)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this.createChild(this.model.background)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"subtitle",{get:function(){return this.createChild(this.model.subtitle)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"author",null),__decorate([W.computed],t.prototype,"title",null),__decorate([W.computed],t.prototype,"background",null),__decorate([W.computed],t.prototype,"subtitle",null),t}(Z.b),he=Object(J.a)("FlowBody",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("div",{className:n.styleProvider.css(n.style),"data-component":Q.a.FlowBody},t.renderMany(n.children))}),fe=function(e){function t(t,n,o,r,i,s){var c=e.call(this,t,n,o,r,i,s)||this;return c.styleProvider=o.get(a.a.StyleProvider),c}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"children",null),t}(Z.b),me=Object(J.a)("FlowDoc",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("div",{className:n.styleProvider.css(n.style),"data-component":Q.a.FlowDoc},t.renderMany(n.children))}),ge=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"children",null),t}(Z.b),be={marginTop:0,marginBottom:0},ye=Object(J.a)("H1",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("div",{className:n.styleProvider.css(n.style),"data-component":Q.a.H1,ref:n.viewReferenceCache.createRef(n.content.id)},t.render(n.background),l.createElement("div",{className:n.styleProvider.css(be)},t.render(n.title)))}),ve=n(87),_e=Object(J.a)("H2",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("div",{className:n.styleProvider.css(n.style),"data-component":Q.a.H2},t.render(n.title))}),Se=n(88),we=n(461),Ce=n(73),je=n(78),Me={cropContainer:{overflow:"hidden",position:"relative"},noCrop:{backgroundSize:"contain",backgroundRepeat:"no-repeat",backgroundPosition:"center"},image:{outline:0,display:"block",backgroundSize:"cover",width:"100%",height:"0"}},Re={circle:{borderColor:"white rgba(255,255,255,.4) rgba(255,255,255,.4)"}},Oe=100,Te=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.checkImageCullState=function(e){if(null!==e.imageElementRef.current){var t=e.imageElementRef.current.getBoundingClientRect(),n=Object(je.c)(e.viewport);n=Object(je.b)(n,Oe),Object(je.a)(t,n)&&e.onImagePreloadIntersectionChange(!0)}},t}return __extends(t,e),t.prototype.render=function(){var e,t=this.props.viewModel;return t.isLoading&&(e=l.createElement("div",{className:function(e){return e.styleProvider.css({position:"absolute",width:"100%",height:"100%",left:"0",top:"0",backgroundColor:"rgba(0,0,0,0.4)",pointerEvents:"none",display:"flex",flexDirection:"column",justifyContent:"center"})}(t)},l.createElement(we.a,{size:Ce.a.large,styles:Re}))),l.createElement(t.intersectionObserver,{onChange:t.onImagePreloadIntersectionChange,rootMargin:Oe+"%"},l.createElement(t.intersectionObserver,{onChange:t.onViewportIntersectionChange},l.createElement($,{store:t.animationStore},l.createElement("div",{className:t.classNameForImageWrapperDiv,ref:t.rootElementRef,"data-component":Q.a.ImageWrapper},l.createElement("img",{ref:t.imageElementRef,alt:t.content.altText,tabIndex:t.focusStyleResolver.shouldBeInTabOrder(t),className:function(e){return e.styleProvider.css(function(e){return{paddingBottom:function(e){return void 0!==e.model.cropInViewportSize?100*e.model.cropInViewportSize.height+"vh":(1/(void 0!==e.model.cropAspectRatio?e.model.cropAspectRatio:e.aspectRatio)*100).toFixed(3)+"%"}(e)}}(e),Me.image,e.shouldCropImage?Me.cropContainer:Me.noCrop,e.shouldCropImage?function(e){return{backgroundPosition:100*e.optimalCrop[0]+"% "+100*e.optimalCrop[1]+"%"}}(e):{},e.selectionStyleResolver.getSelectableStyle(e),e.selectionStyleResolver.getSelectionStyle(e),e.focusStyleResolver.getFocusStyle(e))}(t),"data-component":Q.a.Image,"data-crop":JSON.stringify(t.optimalCrop),onClick:t.onClick,onMouseDown:t.onMouseDown,onKeyDown:t.onKeyDown,style:void 0===t.source?void 0:{backgroundImage:"url("+t.source+")"},src:t.source}),e))))},t.prototype.componentDidUpdate=function(){var e=this.props.viewModel;this.checkImageCullState(e)},t.prototype.componentDidMount=function(){var e=this.props.viewModel;this.checkImageCullState(e),e.focusHolder.tryApplyFocusReservation(e.model.id,e.imageElementRef.current)},t.prototype.componentWillUnmount=function(){var e=this.props.viewModel;e.focusHolder.tryReserveFocus(e.model.id,e.imageElementRef.current)},t=__decorate([N.a],t)}(l.Component),Ae=n(347),Pe=n(7),Ee=function(e,t){var n={};if(void 0===t)return n;for(var o=0,r=Object.keys(t);o<r.length;o++){var i=r[o],a=t[i];if("string"==typeof a)for(var s=0,c=Object.keys(e);s<c.length;s++){var u=c[s];a=a.replace(u,e[u])}else"object"==typeof a&&(a=Ee(e,a));n[i]=a}return n},Ie=[.5,0],xe=function(){function e(e){var t=this;this.viewPort=e,this.areSimilarAspectRatios=function(e,t){return e<=1&&t<1||(e>=1&&t>1||1===t)},this.isAcceptableCropWithoutViewPort=function(e,n,o){var r=e.width*o.width/(e.height*o.height);return t.areSimilarAspectRatios(n,r)},this.isAcceptableCropWithViewPort=function(e,n,o,r){var i=t.relativeMediaDimensionsToViewPort(o,n),a=i.width,s=i.height,c=e.height*a,u=e.width*s;return r.height*n.height>=c&&r.width*n.width>=u},this.isAcceptableCrop=function(e,n,o){if(void 0!==n.cropAspectRatio)return t.isAcceptableCropWithoutViewPort(e,n.cropAspectRatio,o);var r=t.viewPort.size;return void 0!==r&&void 0!==n.cropInViewportSize&&t.isAcceptableCropWithViewPort(e,n.cropInViewportSize,o,r)}}return e.prototype.relativeMediaDimensionsToViewPort=function(e,t){if(void 0===this.viewPort.size)return{width:e.width,height:e.height};var n=void 0!==t?t:{width:1,height:1},o=this.viewPort.size.width*n.width,r=this.viewPort.size.height*n.height;return o/r>=e.width/e.height?{width:o,height:e.height*o/e.width}:{width:e.width*r/e.height,height:r}},e.prototype.getOptimalCrop=function(e,t,n){var o=this;return void 0===e&&(e=[]),function(e){return void 0===e?Ie:function(e){var t=void 0!==e.left?e.left:0,n=(t+(t+e.width))/2,o=void 0!==e.top?e.top:0;return[n,(o+(o+e.height))/2]}(e)}(e.filter(function(e){return o.isAcceptableCrop(e,t,n)})[0])},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.Viewport))],e)}(),Ve=n(250),ke=n(249),De=function(){function e(e){this.devicePixelRatio=e,this.highestQualityLoadedForSrc=new Map}var t;return t=e,e.prototype.getQuality=function(e,t){return this.updateQualityInDictionaryIfBetterAndReturnBest(e,this.getCurrentQuality(t))},e.prototype.updateQualityInDictionaryIfBetterAndReturnBest=function(e,t){var n=this.highestQualityLoadedForSrc.get(e);return void 0!==n&&n>=t?n:(this.highestQualityLoadedForSrc.set(e,t),t)},e.prototype.getCurrentQuality=function(e){var n=t.supportedWidthsSortedDesc;if(0!==e){for(var o=0;o<n.length;o++)if(n[o]<e*this.devicePixelRatio.devicePixelRatio)return n[0===o?0:o-1];return n[n.length-1]}return n[0]},e.supportedWidthsSortedDesc=[3840,2560,1920,1600,1280,960,800,640,480,320,160],e=t=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.DevicePixelRatio))],e)}(),Fe=function(e){function t(t,n,o,r,i,s){var c=e.call(this,t,n,o,r,i,s)||this;return c.onClick=function(){c.eventSubmitter.emit(S.a.ImagePress),c.activate()},c.onImagePreloadIntersectionChange=function(e){c.inImagePreloadRegion=e},c.onKeyDown=function(e){e.key!==Ae.a.Space&&e.key!==Ae.a.LegacySpace||(e.preventDefault(),c.eventSubmitter.emit(S.a.ImagePress),c.activate()),e.key===Ae.a.Enter&&(c.eventSubmitter.emit(S.a.ImagePress),c.activate())},c.onMouseDown=function(e){e.preventDefault()},c.rootElementRef=l.createRef(),c.eventSubmitter=o.get(a.a.EventSubmitter),c.styleProvider=o.get(a.a.StyleProvider),c.inImagePreloadRegion=!1,c.aspectRatioCalculator=o.get(xe),c.imageQualityCalculator=o.get(De),c.viewport=o.get(a.a.Viewport),c.selectionStyleResolver=o.get(ke.b),c.focusStyleResolver=o.get(Ve.a),c.viewReferenceCache=o.get(le.c),c.imageElementRef=l.createRef(),c.focusHolder=o.get(R.a.FocusHolder),c}return __extends(t,e),Object.defineProperty(t.prototype,"source",{get:function(){if(!this.shouldCullImage){var e=void 0===this.viewport.size?0:this.viewport.size.width,t=void 0===this.viewport.size?0:this.viewport.size.height;if(!(e<0||t<0)){var n=0,o=0;null!==this.imageElementRef.current&&(n=this.imageElementRef.current.getBoundingClientRect().width,o=this.imageElementRef.current.getBoundingClientRect().height);var r="?quality="+this.imageQualityCalculator.getQuality(this.content.sourceUrl,Math.max(n,o));return void 0!==this.model.filterEffects&&(r+="&filterEffectsFormula="+this.model.filterEffects),this.content.sourceUrl+r}}},enumerable:!0,configurable:!0}),t.prototype.activate=function(){this.selectionStore.isSelected(this)?this.selectionStore.deselectElement(this):this.selectionStore.selectElement(this.model.id)},Object.defineProperty(t.prototype,"aspectRatio",{get:function(){return this.content.width/this.content.height},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"optimalCrop",{get:function(){return this.aspectRatioCalculator.getOptimalCrop(this.model.crops,this.model,this.content)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldCropImage",{get:function(){return void 0!==this.model.cropAspectRatio||void 0!==this.model.cropInViewportSize},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"shouldCullImage",{get:function(){return!this.inImagePreloadRegion},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"classNameForImageWrapperDiv",{get:function(){var e={$aspectRatio$:""+this.aspectRatio,$width$:""+this.content.width,$height$:""+this.content.height};return this.styleProvider.css(this.style,{position:"relative"},Ee(e,this.computedStyle))},enumerable:!0,configurable:!0}),__decorate([W.observable],t.prototype,"inImagePreloadRegion",void 0),__decorate([W.computed],t.prototype,"source",null),__decorate([Pe.action],t.prototype,"onImagePreloadIntersectionChange",void 0),__decorate([Pe.action],t.prototype,"activate",null),__decorate([W.computed],t.prototype,"aspectRatio",null),__decorate([W.computed],t.prototype,"optimalCrop",null),__decorate([W.computed],t.prototype,"shouldCropImage",null),__decorate([W.computed],t.prototype,"shouldCullImage",null),__decorate([W.computed],t.prototype,"classNameForImageWrapperDiv",null),t}(Z.b),Le=n(52),Ne=function(){function e(e){var t=this;this.layoutViewModelFactory=e,this.create=function(e){var n=e.leafViewModel;if(void 0===n)throw new Error("Can't create a decorator view model without a leaf");var o=e.modelOrLeaf.decoratorRefs;if(void 0===o)return n;for(var r=0,i=o.slice().reverse();r<i.length;r++){var a=i[r],s=t.createChildLayoutVMFactoryForLeaf(n),c=e.refResolvers.resolveDecoratorRef(a);n=t.layoutViewModelFactory.constructViewModel(c,e.refResolvers,{},s)}return n}}return e.prototype.createChildLayoutVMFactoryForLeaf=function(e){var t=this,n={create:function(o){return o.modelOrLeaf.type===g.LayoutNodeType.DecoratorLeaf?e:t.layoutViewModelFactory.constructViewModel(o.modelOrLeaf,o.refResolvers,{},n)}};return n},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(Le.b))],e)}(),Be=function(){function e(e,t,n,o,r,i){void 0===i&&(i={}),this.model=e,this.refResolvers=t,this.layoutViewModelFactory=n,this.blockFactory=o,this.viewModelProps=i,this.contentViewModel=this.createContentViewModel(),this.documentContextStore=r.get(Nt),this.routerStore=r.get(c.a),this.decoratorViewModelFactory=r.get(Ne)}return e.prototype.createContentViewModel=function(){return this.layoutViewModelFactory.constructViewModel(this.model,this.refResolvers,this.viewModelProps,this.blockFactory)},e.prototype.createViewModel=function(e){for(var t=this.contentViewModel,n=0,o=this.contextualViewModelFactories;n<o.length;n++){t=o[n].create(__assign({},e,{contentViewModel:this.contentViewModel,leafViewModel:t,childViewModelFactory:this.blockFactory}))}return t},Object.defineProperty(e.prototype,"blockRootViewModel",{get:function(){return this.createViewModel({modelOrLeaf:this.model,refResolvers:this.refResolvers,viewModelProps:this.viewModelProps})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.contentViewModel.key},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"contextualViewModelFactories",{get:function(){var e=[];return this.routerStore.routeDetails.inAuthoring&&void 0!==this.authoringViewModelFactory&&e.push(this.authoringViewModelFactory),e.push(this.decoratorViewModelFactory),e},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"authoringViewModelFactory",{get:function(){return this.documentContextStore.documentContext.authoringViewModelFactory},enumerable:!0,configurable:!0}),__decorate([W.computed],e.prototype,"blockRootViewModel",null),__decorate([W.computed],e.prototype,"key",null),__decorate([W.computed],e.prototype,"contextualViewModelFactories",null),__decorate([W.computed],e.prototype,"authoringViewModelFactory",null),e}(),He=new Map([[0,{defaultRowLength:2,rowLengthForMediaCount:[0,1]}],[768,{defaultRowLength:3,rowLengthForMediaCount:[0,1,2,3,2]}]]),Ue={container:{lineHeight:"0"},media:function(e,t){return __assign({display:"inline-block"},function(e,t){for(var n,o={},r=0,i=Object.keys(e);r<i.length;r++){var a=i[r],s=e[a],c="0";s.isLastItemInRow||(c="0.65%");var u=s.aspectRatio/s.rowTotalAspectRatio*100;u-=.65*(s.rowLength-1)*s.aspectRatio/s.rowTotalAspectRatio;var l="0";s.isLastRow||(l="0.65%"),o["@media(min-width: "+a+"px)"]=((n={width:u+"%"})[t?"paddingLeft":"paddingRight"]=c,n.paddingBottom=l,n)}return o}(e,t))}},We=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderChildren=function(e){var n=e instanceof Be?e.contentViewModel:e,o=t.allMediaWidthsForViewportWidths[n.model.id],r=Ue.media(o,t.props.viewModel.isRtl);return l.createElement("div",{className:t.props.viewModel.styleProvider.css(r),key:n.key},t.props.viewFactory.render(e))},t}return __extends(t,e),Object.defineProperty(t.prototype,"allMediaWidthsForViewportWidths",{get:function(){for(var e=this,t={},n=0,o=this.props.viewModel.imageChildren;n<o.length;n++){var r=o[n];t[r.model.id]={}}return He.forEach(function(n,o){for(var r=e.props.viewModel.getRowsForWidth(n),i=0;i<r.length;++i){for(var a=r[i],s=0,c=0,u=a;c<u.length;c++){s+=(p=u[c]).aspectRatio}for(var l=0,d=a;l<d.length;l++){var p=d[l];t[p.model.id][o]={aspectRatio:p.aspectRatio,rowLength:a.length,rowTotalAspectRatio:s,isLastItemInRow:p===a[a.length-1],isLastRow:i===r.length-1}}}}),t},enumerable:!0,configurable:!0}),t.prototype.render=function(){return l.createElement("div",{className:this.props.viewModel.styleProvider.css(Ue.container,this.props.viewModel.style),"data-component":Q.a.LiquidLayout},this.props.viewModel.children.map(this.renderChildren))},__decorate([W.computed],t.prototype,"allMediaWidthsForViewportWidths",null),t=__decorate([N.a],t)}(l.Component),qe=function(e,t){var n=e.defaultRowLength;return t<e.rowLengthForMediaCount.length&&(n=e.rowLengthForMediaCount[t]),n<1&&(n=1),n>t?t:n},Ge={fitToParent:!0,isInLiquidLayout:!0},ze=function(e){function t(t,n,o,r,i,a){var s=e.call(this,t,n,o,r,i,a)||this;return s.documentModelStore=o.get(y.a),s}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children,Ge)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"imageChildren",{get:function(){for(var e=[],t=0,n=this.children;t<n.length;t++){var o=n[t];o instanceof Be?e.push(o.contentViewModel):e.push(o)}return e},enumerable:!0,configurable:!0}),t.prototype.getRowsForWidth=function(e){return function(e,t){for(var n=[],o=[],r=e.length,i=qe(t,r),a=0,s=e;a<s.length;a++){var c=s[a];--r,o.push(c),o.length>=i&&(n.push(o),o=[],i=qe(t,r))}return n}(this.imageChildren,e)},Object.defineProperty(t.prototype,"isRtl",{get:function(){return this.documentModelStore.model.documentProperties.isRtl},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"children",null),__decorate([W.computed],t.prototype,"imageChildren",null),__decorate([W.computed],t.prototype,"isRtl",null),t}(Z.b),Ke=function(e){return{float:e}},Je=Object(J.a)("MediaAndText",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("div",{className:n.styleProvider.css(n.style),"data-component":Q.a.MediaAndTextContainer},l.createElement("div",{className:n.styleProvider.css(Ke(n.float)),"data-component":Q.a.MediaAndTextMedia},t.render(n.media)),t.render(n.text))}),Qe={fitToParent:!1},$e=function(e){function t(t,n,o,r,i,a){var s=e.call(this,t,n,o,r,i,a)||this;return s.documentModelStore=o.get(y.a),s}return __extends(t,e),Object.defineProperty(t.prototype,"float",{get:function(){return this.documentModelStore.model.documentProperties.isRtl?"right":"left"},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"media",{get:function(){return this.createChild(this.model.first.type!==g.LayoutNodeType.Text?this.model.first:this.model.second,Qe)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"text",{get:function(){return this.createChild(this.model.first.type===g.LayoutNodeType.Text?this.model.first:this.model.second)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"float",null),__decorate([W.computed],t.prototype,"media",null),__decorate([W.computed],t.prototype,"text",null),t}(Z.b),Ye=function(e){return{container:{position:e.model.position},border:{pointerEvents:"none"}}},Ze=Object(J.a)("Ornament",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("div",{className:n.styleProvider.css(Ye(n).container),"data-component":Q.a.OrnamentContainer},l.createElement($,{store:n.animationStore},l.createElement("div",{className:n.styleProvider.css(Ye(n).border,n.style),"data-component":Q.a.Ornament})),t.render(n.child))}),Xe=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"child",{get:function(){return this.createChild(this.model.child)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"child",null),t}(Z.b),et=n(74),tt=Object(J.a)("TextRun",function(e){var t,n,o,r,i,a=e.store;if(void 0!==a.resolvedTextRun.children){var s=a.getChildTextRuns().map(function(e,t){return l.createElement(tt,{key:t,store:e})});r=void 0!==(i=a.resolvedTextRun).href?l.createElement("a",{href:i.href,target:"_blank",rel:"noopener noreferrer","data-component":Q.a.TextRun},s):l.createElement("span",{"data-component":Q.a.TextRun},s)}else{i=a.resolvedTextRun;var c=function(e,t){var n=[];if(void 0===t)return n;for(var o=0,r=t;o<r.length;o++){var i=r[o],a=e.get(i);void 0!==a&&n.push(a)}return n}(a.styleMap,i.attributes);o=i.text,r=void 0!==i.href?l.createElement("a",{href:i.href,"data-component":Q.a.TextRun},l.createElement("span",{className:(t=a.styleProvider).css.apply(t,c)},o)):l.createElement("span",{className:(n=a.styleProvider).css.apply(n,c),"data-component":Q.a.TextRun},o)}return l.createElement($,{store:a.animationStore,useSpan:!0},r)}),nt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props.viewModel;return l.createElement(e.intersectionObserver,{onChange:e.onViewportIntersectionChange},l.createElement("p",{"data-component":Q.a.Paragraph,className:e.className,dir:Object(et.a)(e.content.textDirection),ref:e.viewReferenceCache.createRef(e.content.id),onMouseUp:e.onMouseUp,onDragEnd:e.onMouseUp,onKeyUp:e.onKeyUp,role:e.role,"aria-level":e.viewModelProps.ariaLevel,tabIndex:e.focusStyleResolver.shouldBeInTabOrder(e)},function(e){var t=e.textRuns.map(function(e,t){return l.createElement(tt,{key:t,store:e})});return e.model.useWrapperSpan?l.createElement($,{store:e.animationStore,useSpan:!0},l.createElement("span",{"data-component":Q.a.TextWrapperSpan},t)):t}(e)))},t.prototype.componentDidMount=function(){var e=this.props.viewModel,t=e.getParagraphElementRef();null!==t&&void 0!==t&&e.focusHolder.tryApplyFocusReservation(e.model.id,t)},t.prototype.componentWillUnmount=function(){var e=this.props.viewModel,t=e.getParagraphElementRef();null!==t&&void 0!==t&&e.focusHolder.tryReserveFocus(e.model.id,t)},t=__decorate([N.a],t)}(l.Component),ot=n(89),rt=Object(J.a)("Row",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("tr",{"data-component":Q.a.Row,key:n.key},t.renderMany(n.cells))}),it=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"cells",{get:function(){return this.createChildren(this.model.children)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"cells",null),t}(Z.b),at=function(e){return void 0===e.contentViewModel?e.aspectRatio:e.contentViewModel.aspectRatio},st={containerOuter:{position:"relative",overflowX:"scroll",width:"50%"},containerInner:function(e){if(0===e.length)return{};for(var t=.7*at(e[0]),n=1;n<e.length;n+=1)t+=at(e[n]);return{display:"flex",flexDirection:"row",width:70*t+"%"}},media:function(e){return{display:"inline-block",width:100*e+"%"}}},ct=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderMedia=function(e){var n=st.media(t.allMediaWidthsForViewportWidths[e.model.id]);return l.createElement("div",{className:t.props.viewModel.styleProvider.css(n),key:e.key},t.props.viewFactory.render(e))},t}return __extends(t,e),Object.defineProperty(t.prototype,"allMediaWidthsForViewportWidths",{get:function(){for(var e={},t=0,n=this.props.viewModel.mediaRows;t<n.length;t++){for(var o=n[t],r=0,i=0,a=o;i<a.length;i++){var s=a[i];r+=at(s)}for(var c=0,u=o;c<u.length;c++){e[(s=u[c]).model.id]=at(s)/r*100}}return e},enumerable:!0,configurable:!0}),t.prototype.render=function(){return l.createElement("div",{className:this.props.viewModel.styleProvider.css(st.containerOuter,this.props.viewModel.style),"data-component":Q.a.Slideshow},l.createElement("div",{className:this.props.viewModel.styleProvider.css(st.containerInner(this.props.viewModel.children))},this.props.viewModel.children.map(this.renderMedia)))},__decorate([W.computed],t.prototype,"allMediaWidthsForViewportWidths",null),t=__decorate([N.a],t)}(l.Component),ut=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"mediaRows",{get:function(){for(var e=[],t=0,n=this.children;t<n.length;t++){var o=n[t];e.push(o)}return[e]},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"children",null),__decorate([W.computed],t.prototype,"mediaRows",null),t}(Z.b),lt=n(20),dt=700,pt={maxHeight:"100%",maxWidth:"100%"},ht=function(e){var t={alignItems:"center",display:"flex",height:"100%",justifyContent:"center",position:"absolute",transition:"all "+dt+"ms linear",transform:"rotate("+e.rotation+"deg)",width:"100%"};if(!e.animating)return t.userSelect="none",t.zIndex=0,t;t.cursor="pointer";var n=e.styleProvider.keyframes("cycle",{"0%":{margin:"0",transform:t.transform,zIndex:"1"},"50%":{marginLeft:"110%",marginTop:"-10%",transform:"rotate("+(e.rotation+45)+"deg)"},"75%":{zIndex:"0"},"100%":{margin:"0",transform:t.transform,zIndex:"0"}});return t.animation=n+" "+dt+"ms ease-in-out",t},ft=Object(J.a)("RotatedChild",function(e){return l.createElement("div",{className:L(B.a.RotatedChildContainer,e.styleProvider.css(ht(e)))},l.createElement("div",{"aria-label":e.animating?lt.a.StackFlipperLabel:void 0,className:L(B.a.RotatedChild,e.styleProvider.css(pt)),onClick:e.onClick,role:e.animating?x.Roles.Button:void 0},e.children))}),mt={cursor:"pointer",paddingBottom:61.80339887498547.toFixed(3)+"%",position:"relative",width:"75%"},gt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return l.createElement("div",{className:this.props.viewModel.styleProvider.css(mt,this.props.viewModel.style),"data-component":Q.a.Stack},this.renderRotatedChildren())},t.prototype.renderRotatedChildren=function(){for(var e=this.props,t=e.viewFactory,n=e.viewModel,o=n.children.slice(n.cyclingIndex).concat(n.children.slice(0,n.cyclingIndex)),r=[],i=o.length-1;i>=0;i-=1){var a=0===i?this.props.viewModel.onClick:void 0;r.push(l.createElement(ft,{animating:n.hasAdvanced&&i===o.length-1,key:o[i].key,onClick:a,rotation:5*((i+n.cyclingIndex)%o.length-1),styleProvider:this.props.viewModel.styleProvider},t.render(o[i])))}return r},t=__decorate([N.a],t)}(l.Component),bt=function(e){function t(t,n,o,r,i,s){var c=e.call(this,t,n,o,r,i,s)||this;return c._cyclingIndex=0,c._hasAdvanced=!1,c.isAnimating=!1,c.onClick=function(){c.isAnimating||(c._cyclingIndex=(c.cyclingIndex+1)%c.children.length,c._hasAdvanced=!0,c.isAnimating=!0,c.logger.logTag(595910855,M.b.Info,"Clicked to new focused index in stack",{focusedIndex:c._cyclingIndex}),c.setTimeout(c.finishAdvancing,dt))},c.finishAdvancing=function(){c.isAnimating=!1},c.logger=o.get(M.c),c.setTimeout=o.get(a.a.SetTimeout),c}return __extends(t,e),Object.defineProperty(t.prototype,"cyclingIndex",{get:function(){return this._cyclingIndex},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"hasAdvanced",{get:function(){return this._hasAdvanced},enumerable:!0,configurable:!0}),__decorate([W.observable],t.prototype,"_cyclingIndex",void 0),__decorate([W.observable],t.prototype,"_hasAdvanced",void 0),__decorate([W.observable],t.prototype,"isAnimating",void 0),__decorate([W.computed],t.prototype,"cyclingIndex",null),__decorate([W.computed],t.prototype,"children",null),__decorate([W.computed],t.prototype,"hasAdvanced",null),__decorate([Pe.action],t.prototype,"onClick",void 0),__decorate([Pe.action],t.prototype,"finishAdvancing",void 0),t}(Z.b),yt=Object(J.a)("StyleWrapper",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("div",{className:n.styleProvider.css(n.style),"data-component":Q.a.StyleWrapper},t.render(n.child))}),vt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"child",{get:function(){return this.createChild(this.model.child)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"child",null),t}(Z.b),_t={borderCollapse:"collapse",fontSize:"20px"},St=Object(J.a)("Table",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement("table",{className:n.styleProvider.css(n.style,_t),"data-component":Q.a.Table},l.createElement("tbody",null,t.renderMany(n.rows)))}),wt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"rows",{get:function(){return this.createChildren(this.model.children)},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"rows",null),t}(Z.b),Ct=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return l.createElement($,{store:this.props.viewModel.animationStore},l.createElement("div",{className:this.props.viewModel.styleProvider.css(this.props.viewModel.style),"data-component":Q.a.Text,ref:this.props.viewModel.setRootElementRef,dir:Object(et.a)(this.props.viewModel.content.textDirection)},this.props.viewFactory.renderMany(this.props.viewModel.children)))},t=__decorate([N.a],t)}(l.Component),jt=function(e){function t(t,n,o,r,i,a){var s=e.call(this,t,n,o,r,i,a)||this;return s.setRootElementRef=function(e){s._element=e,s.viewReferenceCache.createRef(s.content.id)(e)},s.selectionStyleResolver=o.get(ke.b),s.focusStyleResolver=o.get(Ve.a),s.viewReferenceCache=o.get(le.c),s.textElementRef=l.createRef(),s}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children,this.viewModelProps)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"element",{get:function(){return this._element},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"children",null),t}(Z.b),Mt={listStyle:"none","&:before":{display:"none"}},Rt=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderListItems=function(e){for(var n=e.filter(function(e){return e.model.type!==g.LayoutNodeType.TextList}).map(function(t){return e.indexOf(t)}),o=[],r=0;r<e.length;r++)if(e[r].model.type!==g.LayoutNodeType.TextList){var i=n.indexOf(r),a=r!==n[n.length-1]?e.slice(r,n[i+1]):e.slice(r);r=e.indexOf(a[a.length-1]),o.push(l.createElement("li",{key:a[0].key},a.map(function(e){return t.props.viewFactory.render(e)})))}else o.push(l.createElement("li",{key:e[r].key,className:t.props.styleProvider.css(Mt)},t.props.viewFactory.render(e[r])));return o},t}return __extends(t,e),t.prototype.render=function(){return this.renderListItems(this.props.items)},t}(l.Component),Ot=new Map([[g.NumberedListStyle.Decimal,{listStyleType:"decimal"}],[g.NumberedListStyle.DecimalLeadingZeros,{listStyleType:"decimal-leading-zero"}],[g.NumberedListStyle.LowerAlpha,{listStyleType:"lower-alpha"}],[g.NumberedListStyle.LowerGreek,{listStyleType:"lower-greek"}],[g.NumberedListStyle.LowerRoman,{listStyleType:"lower-roman"}],[g.NumberedListStyle.UpperAlpha,{listStyleType:"upper-alpha"}],[g.NumberedListStyle.UpperGreek,{listStyleType:"upper-greek"}],[g.NumberedListStyle.UpperRoman,{listStyleType:"roman"}]]),Tt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textListType",{get:function(){return this.model.textListType},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"children",null),__decorate([W.computed],t.prototype,"textListType",null),t}(Z.b),At=function(e,t){var n=l.createElement(Rt,{viewFactory:t,items:e.children,styleProvider:e.styleProvider}),o=e.styleProvider.css(function(e){if(e.model.textListType===g.TextNodeType.BulletedList){var t=e.content;return t.listStyle===g.BulletedListStyle.Character?{listStyle:"none","> li":{"&:before":{content:t.bulletValue}},"& li":{"&:before":{marginLeft:"-1.3em",width:"1.3em",float:t.textDirection===g.TextDirection.LeftToRight?"left":"right"}}}:{listStyle:"url("+t.bulletValue+")","& li":{"&:before":{content:"none"}}}}var n=e.content.listStyle,o=Ot.get(n);return void 0!==o?o:{}}(e));if(e.textListType===g.TextNodeType.BulletedList)return l.createElement("ul",{className:o,dir:Object(et.a)(e.content.textDirection)},n);var r=e.content.startValue;return l.createElement("ol",{start:r,className:o,dir:Object(et.a)(e.content.textDirection)},n)},Pt=Object(J.a)("TextList",function(e){var t=e.viewFactory,n=e.viewModel;return l.createElement($,{store:n.animationStore},l.createElement("div",{className:n.styleProvider.css(n.style),"data-component":Q.a.TextList},At(n,t)))}),Et=n(507),It={padding:"10px"},xt=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=this.props.viewModel,t=this.props.viewModel.styleProvider.css(It);return l.createElement(e.intersectionObserver,{onChange:e.onViewportIntersectionChange},l.createElement(e.intersectionObserver,{onChange:e.onFirstInView},l.createElement("div",{className:this.props.viewModel.styleProvider.css(e.style),"data-component":Q.a.Unpopulated},l.createElement(Et.a,{className:t}),l.createElement(Et.a,{className:t}),l.createElement(Et.a,{width:"75%",className:t}))))},t.prototype.componentDidMount=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(e){switch(e.label){case 0:return[4,this.props.viewModel.componentDidMount()];case 1:return e.sent(),[2]}})})},t.prototype.componentWillUnmount=function(){this.props.viewModel.componentWillUnmount()},t}(l.Component),Vt=function(e){function t(t,n,o,r,i,s){var c=e.call(this,t,n,o,r,i,s)||this;return c.model=t,c.isMounted=!1,c.hasEverMounted=!1,c.onFirstInView=function(e){e&&void 0===c.setInViewTimestamp&&(c.setInViewTimestamp=c.getTimestamp())},c.getTimestamp=o.get(a.a.GetTimestamp),c.logger=o.get(M.c),c.segmentFetcher=o.get(R.a.DocumentSegmentFetcher),c.setTimeout=o.get(a.a.SetTimeout),c}return __extends(t,e),Object.defineProperty(t.prototype,"key",{get:function(){return this.model.id},enumerable:!0,configurable:!0}),t.prototype.componentDidMount=function(){return __awaiter(this,void 0,void 0,function(){var e,t=this;return __generator(this,function(n){switch(n.label){case 0:return this.isMounted=!0,this.hasEverMounted?[2]:(this.hasEverMounted=!0,e=this.getTimestamp(),this.logger.logTag(595984905,M.b.Info,"Started loading unpopulated view model.",{inView:this.inView,key:this.model.id,setInViewTimestamp:this.setInViewTimestamp,startTime:e}),[4,this.segmentFetcher.loadSegment(this.model.segmentIndex)]);case 1:return n.sent(),this.logger.logTag(595984906,M.b.Info,"Finished loading unpopulated view model.",{endTime:this.getTimestamp(),inView:this.inView,key:this.model.id,setInViewTimestamp:this.setInViewTimestamp,startTime:e}),this.setTimeout(function(){t.isMounted&&t.logger.logTag(595955716,M.b.Error,"Segment shimmer was not removed after segment merge",{inView:t.inView,key:t.model.id,startTime:e})},1e4),[2]}})})},t.prototype.componentWillUnmount=function(){this.isMounted=!1},__decorate([W.computed],t.prototype,"key",null),t}(Z.b),kt=new Map([[g.LayoutNodeType.BackgroundImage,{view:Te,viewModelClass:Fe}],[g.LayoutNodeType.BlockText,{view:Y,viewModelClass:X}],[g.LayoutNodeType.Border,{view:yt,viewModelClass:vt}],[g.LayoutNodeType.CaptionedContent,{view:oe,viewModelClass:re}],[g.LayoutNodeType.Cell,{view:se,viewModelClass:ce}],[g.LayoutNodeType.StyleWrapper,{view:yt,viewModelClass:vt}],[g.LayoutNodeType.DocumentHeading,{view:ue,viewModelClass:pe}],[g.LayoutNodeType.FlowBody,{view:he,viewModelClass:fe}],[g.LayoutNodeType.FlowDoc,{view:me,viewModelClass:ge}],[g.LayoutNodeType.H1,{view:ye,viewModelClass:ve.a}],[g.LayoutNodeType.H2,{view:_e,viewModelClass:Se.a}],[g.LayoutNodeType.Image,{view:Te,viewModelClass:Fe}],[g.LayoutNodeType.LiquidLayout,{view:We,viewModelClass:ze}],[g.LayoutNodeType.MediaAndText,{view:Je,viewModelClass:$e}],[g.LayoutNodeType.Ornament,{view:Ze,viewModelClass:Xe}],[g.LayoutNodeType.Paragraph,{view:nt,viewModelClass:ot.a}],[g.LayoutNodeType.Row,{view:rt,viewModelClass:it}],[g.LayoutNodeType.Slideshow,{view:ct,viewModelClass:ut}],[g.LayoutNodeType.Stack,{view:gt,viewModelClass:bt}],[g.LayoutNodeType.Table,{view:St,viewModelClass:wt}],[g.LayoutNodeType.Text,{view:Ct,viewModelClass:jt}],[g.LayoutNodeType.TextList,{view:Pt,viewModelClass:Tt}],[g.LayoutNodeType.Unpopulated,{view:xt,viewModelClass:Vt}]]);
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var Dt,Ft={documentComponentRegistry:new Map,authoringViewModelFactory:void 0},Lt={documentComponentRegistry:kt,authoringViewModelFactory:void 0},Nt=function(){function e(e,t){this.authoringBundleImporter=e,this.routerStore=t}return Object.defineProperty(e.prototype,"documentContext",{get:function(){return this.routerStore.routeDetails.inAuthoring?this.getAuthoringDocumentContext():Lt},enumerable:!0,configurable:!0}),e.prototype.getAuthoringDocumentContext=function(){if(void 0===this.authoringBundleLoad&&(this.authoringBundleLoad=Object(z.a)(this.authoringBundleImporter.import())),"fulfilled"!==this.authoringBundleLoad.state||this.authoringBundleLoad.value.status!==q.b.Succeeded)return Ft;var e=this.authoringBundleLoad.value.contents;return{documentComponentRegistry:Object(G.b)(kt,e.documentComponentRegistry),authoringViewModelFactory:e.authoringViewModelFactory}},__decorate([W.computed],e.prototype,"documentContext",null),e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(K)),__param(1,Object(d.inject)(c.a))],e)}(),Bt=Object(J.a)("Block",function(e){var t=e.documentBlock,n=e.viewFactory.render(t.blockRootViewModel);return void 0===n?null:n}),Ht={padding:"20px",margin:"10px",display:"inline-block",backgroundColor:"#fed9cc"},Ut=Object(J.a)("Unknown",function(e){var t=e.viewModel,n=null;return t.showDebugInfo&&(n=l.createElement("code",null,"[","Type: "+JSON.stringify(t.model.type)+", Id: "+JSON.stringify(t.model.id),"]")),l.createElement("div",{"data-component":Q.a.Unknown,className:t.styleProvider.css(Ht)},lt.a.ContentMissingNotice," ",n)}),Wt=function(){function e(e){var t=this;this.documentContextStore=e,this.render=function(e){if(void 0!==e)return e instanceof Be?l.createElement(Bt,{key:e.key,viewFactory:t,documentBlock:e}):t.renderViewModel(e)},this.renderViewModel=function(e){var n=t.documentComponentRegistry.get(e.type),o=void 0===n?Ut:n.view;return l.createElement(o,{key:e.key,viewModel:e,viewFactory:t})},this.renderMany=function(e){var n=[];if(void 0!==e)for(var o=0,r=e;o<r.length;o++){var i=r[o],a=t.render(i);void 0!==a&&n.push(a)}return n}}return Object.defineProperty(e.prototype,"documentComponentRegistry",{get:function(){return this.documentContextStore.documentContext.documentComponentRegistry},enumerable:!0,configurable:!0}),__decorate([W.computed],e.prototype,"documentComponentRegistry",null),e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(Nt))],e)}(),qt=n(257),Gt=function(e,t,n,o){var r,i=[],a=t;if(e.type===g.LayoutNodeType.DecoratorLeaf){if(void 0===t)throw new Error("DecoratorState cannot be undefined when rendering a decorator");r=t.model,o=t.viewModelProps,i=t.remainingDecorators,a=void 0}else r=e,void 0===t&&void 0!==r.decoratorRefs&&(i=r.decoratorRefs);return i.length>0&&(a={model:r,remainingDecorators:i.slice(1),viewModelProps:o},r=n(i[0]),o={}),{model:r,viewModelProps:o,newDecoratorState:a}},zt=function(e){return!!e&&!!e.type},Kt=function(){function e(e,t,n,o){var r=this;this.componentRegistry=e,this.logger=t,this.siteSettingsStore=n,this.container=o,this.existingViewModels=new Map,this.create=function(e){void 0===e.useCache&&(e.useCache=!0),void 0===e.viewModelProps&&(e.viewModelProps={});var t=e.modelOrLeaf,n=e.refResolvers,o=e.useCache,i=e.decoratorState;if(!zt(t))return r.logger.logTag(595973517,M.b.Error,"Received invalid layout node",{model:JSON.stringify(t),decoratorState:JSON.stringify(i)}),new qt.a({id:"invalid"},r.container,n);var a=Gt(t,i,n.resolveDecoratorRef,e.viewModelProps),s=a.model,c=a.newDecoratorState,u=a.viewModelProps,l=void 0===c?s.type+"-"+s.id:s.type+"-"+s.id+">"+c.model.id;if(o){var d=r.existingViewModels.get(l);if(void 0!==d)return d}var p=r.constructViewModel(s,n,u,c);return o&&r.existingViewModels.set(l,p),p},this.createMany=function(e,t,n,o){for(var i=[],a=0,s=e;a<s.length;a++){var c=s[a];i.push(r.create({modelOrLeaf:c,refResolvers:t,viewModelProps:n,decoratorState:o}))}return i}}return e.prototype.constructViewModel=function(e,t,n,o){var r=this.componentRegistry.get(e.type);return void 0===r?(this.siteSettingsStore.settings.explicitlyV2||this.logger.logTag(595973513,M.b.Error,"Unable to find component for layout node",{id:e.id,type:e.type}),new qt.a(e,this.container,t)):new r.viewModelClass(e,o,this.container,t,n,this)},e}(),Jt=function(){function e(e,t,n){this.viewFactory=e,this.viewModelFactory=t,this.documentRefResolvers=n}return e.prototype.createRootView=function(e){var t=this.viewModelFactory.create({modelOrLeaf:e.layout,refResolvers:this.documentRefResolvers});return this.viewFactory.render(t)},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(Wt)),__param(1,Object(d.inject)(Kt)),__param(2,Object(d.inject)(R.a.DocumentRefResolvers))],e)}(),Qt=n(290),$t=n(80),Yt=function(e){var t;return(t={})[e?"left":"right"]=0,t.position="absolute",t.direction=e?"rtl":"ltr",t},Zt={icon:{color:"#dadada"},iconHovered:{color:"#dadada"},iconPressed:{color:"#dadada"},label:{color:"#dadada"},labelHovered:{color:"#dadada"},root:{backgroundColor:"rgba(34, 34, 34, 0.93)",color:"#dadada"},rootHovered:{color:"#dadada",backgroundColor:"rgb(80, 80, 80)"}},Xt=Object(J.a)("ConsumptionHeader",function(e){var t=e.store,n=t.siteSettingsStore.settings.isSiteUiRtl;return l.createElement(D,{id:F.a.ConsumptionHeader,order:F.c.ConsumptionHeader,navigator:t.pageRegionNavigator,className:t.styleProvider.css(Yt(n))},l.createElement($t.a,{buttonStyles:Zt,store:t.rightHeaderStore,isRtl:n}))}),en=n(79),tn=function(){function e(e,t,n,o,r){this.documentModelStore=e,this.rightHeaderStore=t,this.styleProvider=n,this.pageRegionNavigator=o,this.siteSettingsStore=r}return e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(y.a)),__param(1,Object(d.inject)(en.a)),__param(2,Object(d.inject)(a.a.StyleProvider)),__param(3,Object(d.inject)(F.b)),__param(4,Object(d.inject)(a.a.SiteSettingsStore))],e)}(),nn=function(){function e(e,t,n,o,r,i,a){this.authoringBundleImporter=e,this.documentSettingsStore=t,this.consumptionHeaderStore=n,this.stickyHeaderContainerStore=o,this.routerStore=r,this.siteSettingsStore=i,this.featureGates=a}return Object.defineProperty(e.prototype,"documentHeader",{get:function(){if(!(this.siteSettingsStore.settings.renderType===u.RenderType.ClientRender))return null;var e=this.routerStore.routeDetails.inAuthoring?this.getAuthoringDocumentHeader():this.getConsumptionDocumentHeader();return null===e?null:this.stickyHeaderContainerStore.createReactPortalToHeader(e)},enumerable:!0,configurable:!0}),e.prototype.getAuthoringDocumentHeader=function(){return void 0===this.authoringBundleLoad&&(this.authoringBundleLoad=Object(z.a)(this.authoringBundleImporter.import())),"fulfilled"!==this.authoringBundleLoad.state||this.authoringBundleLoad.value.status!==q.b.Succeeded?null:this.authoringBundleLoad.value.contents.header},e.prototype.getConsumptionDocumentHeader=function(){return this.documentSettingsStore.settings.canEdit&&this.featureGates.isEnabled(u.FeatureGates.OnCanvasAuthoring)&&(void 0===this.authoringBundleLoad&&(this.authoringBundleLoad=Object(z.a)(this.authoringBundleImporter.import())),"fulfilled"!==this.authoringBundleLoad.state)?null:l.createElement(Xt,{store:this.consumptionHeaderStore})},__decorate([W.computed],e.prototype,"documentHeader",null),e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(K)),__param(1,Object(d.inject)(R.a.DocumentSettingsStore)),__param(2,Object(d.inject)(tn)),__param(3,Object(d.inject)(Qt.a)),__param(4,Object(d.inject)(c.a)),__param(5,Object(d.inject)(a.a.SiteSettingsStore)),__param(6,Object(d.inject)(i.a))],e)}(),on=function(){function e(e,t,n,o,r){this.documentHeaderStore=e,this.documentModelStore=t,this.rootViewFactory=n,this.styleProvider=o,this.pageRegionNavigator=r}return Object.defineProperty(e.prototype,"documentLanguage",{get:function(){return this.documentModelStore.model.documentProperties.language},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"documentTextDirection",{get:function(){return this.documentModelStore.model.documentProperties.isRtl?"rtl":"ltr"},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"rootView",{get:function(){return this.rootViewFactory.createRootView(this.documentModelStore.model)},enumerable:!0,configurable:!0}),__decorate([W.computed],e.prototype,"documentLanguage",null),__decorate([W.computed],e.prototype,"documentTextDirection",null),__decorate([W.computed],e.prototype,"rootView",null),e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(nn)),__param(1,Object(d.inject)(y.a)),__param(2,Object(d.inject)(Jt)),__param(3,Object(d.inject)(a.a.StyleProvider)),__param(4,Object(d.inject)(F.b))],e)}(),rn=n(29),an=function(){function e(e,t,n){this.backgroundTaskWrapper=e,this.documentNavigationLauncherStore=t,this.eventReceiver=n}return e.prototype.subscribeToKeyboardEvents=function(){var e=this;this.eventReceiver.on(S.a.GlobalKeydown,function(t){(function(e){return e.key===Ae.a.UppercaseN&&e.altKey&&e.shiftKey})(t)&&(e.backgroundTaskWrapper.wrapInBackground(e.documentNavigationLauncherStore.requestOpen()),t.preventDefault(),t.stopPropagation())})},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(r.a)),__param(1,Object(d.inject)(rn.a)),__param(2,Object(d.inject)(a.a.EventReceiver))],e)}(),sn=n(262),cn=n(288),un=function(){function e(e,t){this.documentModelStore=e,this.styleProvider=t}return e.prototype.start=function(){var e=this;Object(W.observe)(this.documentModelStore.model.fontFiles,function(){return e.addFontFaces()},!0)},e.prototype.addFontFaces=function(){for(var e=0,t=this.documentModelStore.model.fontFiles;e<t.length;e++){var n=t[e];this.addFontFaceToStylesheet(n)}},e.prototype.addFontFaceToStylesheet=function(e){this.styleProvider.global("@font-face",{src:"url(/Content/"+e.fileName+")",fontFamily:Object(cn.a)(e.family),fontWeight:e.weight,fontStyle:e.style,fontStretch:e.stretch,fontDisplay:"swap"})},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(y.a)),__param(1,Object(d.inject)(a.a.StyleProvider))],e)}(),ln=n(354),dn=n(345),pn=function(){return function(e){var t=this;this.swayBundleImporter=e,this.import=function(){return __awaiter(t,void 0,void 0,function(){var e=this;return __generator(this,function(t){return[2,this.swayBundleImporter.import("@sway/authoring",function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return[2,Promise.all(/*! import() | Sway~Authoring */[n.e(6),n.e(3)]).then(n.bind(null,/*! @sway/authoring */493))]})})})]})})}}}(),hn=n(263),fn=n(307),mn=n(304),gn=function(e){for(var t=0,n=e;t<n.length;t++){var o=n[t];if(-1!==o.indexOf("0%")){if(0===o.indexOf("0%"))return o;if(o.includes(",0%")||o.includes(", 0%"))return o}if(-1!==o.indexOf("from"))return o}},bn=function(){function e(e,t){var n=this;this.styleProvider=e,this.logger=t,this.generateKeyframeStyle=function(e){return[n.styleProvider.keyframes(e.id,e.keyframes),e.definition].join(" ")}}return e.prototype.animatedStyle=function(e){var t=e.filter(function(e){return e.type===g.AnimationType.Keyframe});return 0===t.length?{}:{animation:t.map(this.generateKeyframeStyle).filter(function(e){return 0!==e.length}).join(",")}},e.prototype.initialKeyframeStyles=function(e){return function(e,t){for(var n=[],o=0,r=e;o<r.length;o++){var i=r[o];if(i.type!==g.AnimationType.Keyframe)break;var a=gn(Object.keys(i.keyframes));if(void 0===a){void 0!==t&&t.logTag(595972758,M.b.Warning,"Initial key not found.",{keys:Object.keys(i.keyframes)});break}n.push(i.keyframes[a])}return Object.assign.apply(Object,[{}].concat(n))}(e,this.logger)},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.StyleProvider)),__param(1,Object(d.inject)(M.c))],e)}(),yn=function(){function e(){this.filterTransitionAnimations=function(e){return e.filter(function(e){return e.type===g.AnimationType.Transition})}}return e.prototype.animatedStyle=function(e){return Object.assign.apply(Object,[{}].concat(this.filterTransitionAnimations(e).map(function(e){return e.activeStyle})))},e.prototype.getTransitionEffects=function(e){var t=this.filterTransitionAnimations(e).map(function(e){return e.transition}).join(", ");return{transition:""!==t?t:void 0}},e=__decorate([Object(d.injectable)()],e)}(),vn=function(e){return!!e&&!!e.type},_n=function(){return function(e,t){var n=this;this.container=e,this.logger=t,this.existingBlocks=new Map,this.create=function(e){var t=__assign({useCache:!0},e),o=t.modelOrLeaf,r=t.refResolvers,i=t.useCache,a=t.viewModelProps,s=o;if(!vn(s))return n.logger.logTag(595957770,M.b.Error,"Received invalid layout node",{model:JSON.stringify(s)}),new qt.a({id:"invalid"},n.container,r);var c=s.type+"-"+s.id;if(i){var u=n.existingBlocks.get(c);if(void 0!==u&&u.model===s)return u}var l=new Be(s,r,n.layoutViewModelFactory,n,n.container,a);return i&&n.existingBlocks.set(c,l),l},this.createMany=function(e,t,o){for(var r=[],i=0,a=e;i<a.length;i++){var s=a[i];r.push(n.create({modelOrLeaf:s,refResolvers:t,viewModelProps:o}))}return r},this.layoutViewModelFactory=e.get(Le.b)}}(),Sn=n(53),wn=n(47),Cn=n(251),jn=n(269),Mn=n(287),Rn=n(111),On=n(109);!function(e){e.Dismiss="share_dismiss",e.Error="share_error",e.LinkRevoked="share_linkrevoked",e.Ready="share_ready",e.Resize="share_resize"}(Dt||(Dt={}));
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var Tn=function(){function e(e,t,n,o,r,i,a){var s=this;this.eventReceiver=e,this.logger=t,this.documentSettingsStore=n,this.styleProvider=o,this.router=r,this.setTimeout=i,this.closeMenu=a,this._height=0,this._width=340,this._ready=!1,this.iframeRef=l.createRef(),this.onMessage=function(e){var t=s.iframeRef.current;if(null!==t&&e.source===t.contentWindow){var n;try{var o="string"==typeof e.data?JSON.parse(e.data):e.data;if(void 0===o.name)return void s.logger.logTag(595899668,M.b.Warning,"Non-SharingEvent received from message.",{data:e.data});n=o}catch(t){return void s.logger.logTag(595953186,M.b.Error,"Failed to parse message from share iframe",{data:e.data,error:t})}if(n.name===Dt.Resize)n.height>0&&(s._height=n.height),n.width>0&&(s._width=n.width);else if(n.name===Dt.Ready)s._ready=!0,s.trySetFocus();else if(n.name===Dt.Error)s._errorMessage=n.errorMessage,s.logger.logTag(595953187,M.b.Warning,"Share frame returned error",{errorMessage:n.errorMessage,debugErrorMessage:n.debugErrorMessage});else if(n.name===Dt.LinkRevoked){s.logger.logTag(595951962,M.b.Info,"Share frame notified of URL change",{newUrl:n.newUrl}),s.closeMenu();var r=Object(On.parse)(n.newUrl),i=Object(Mn.a)(Object(Rn.b)(void 0!==r.pathname?r.pathname:""));s.router.goToRoute(i)}else n.name===Dt.Dismiss&&s.closeMenu()}}}return Object.defineProperty(e.prototype,"height",{get:function(){return this._height},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"width",{get:function(){return this._width},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"ready",{get:function(){return this._ready},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"errorMessage",{get:function(){return this._errorMessage},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"sharePageUrl",{get:function(){return"/sharing/"+this.documentSettingsStore.settings.lookupId+"/ui"},enumerable:!0,configurable:!0}),e.prototype.onMount=function(){this._ready=!1,this._errorMessage=void 0,this.eventReceiver.on(S.a.Message,this.onMessage)},e.prototype.onUnmount=function(){this.eventReceiver.off(S.a.Message,this.onMessage)},e.prototype.trySetFocus=function(){var e=this.iframeRef.current;if(null!==e&&(this.setTimeout(function(){null!==e.contentWindow&&e.contentWindow.focus()},0),null!==e.contentDocument&&void 0!==e.contentDocument)){var t=e.contentDocument.getElementById("copyTextButtonConsumptionId");if(!(null!==t&&void 0!==t||null!==(t=e.contentDocument.getElementById("copyTextButtonId"))&&void 0!==t))return;this.setTimeout(function(){null!==t&&t.focus()},0)}},__decorate([W.observable],e.prototype,"_height",void 0),__decorate([W.computed],e.prototype,"height",null),__decorate([W.observable],e.prototype,"_width",void 0),__decorate([W.computed],e.prototype,"width",null),__decorate([W.observable],e.prototype,"_ready",void 0),__decorate([W.computed],e.prototype,"ready",null),__decorate([W.observable],e.prototype,"_errorMessage",void 0),__decorate([W.computed],e.prototype,"errorMessage",null),__decorate([Pe.action],e.prototype,"onMount",null),__decorate([Pe.action],e.prototype,"onMessage",void 0),e}(),An=function(e){return function(t){return new Tn(e.container.get(a.a.EventEmitter),e.container.get(M.c),e.container.get(R.a.DocumentSettingsStore),e.container.get(a.a.StyleProvider),e.container.get(c.a),e.container.get(a.a.SetTimeout),t)}},Pn=n(305),En=n(306),In=n(303),xn=function(){function e(e){this.getActiveElement=e}return e.prototype.tryReserveFocus=function(e,t){null!==t&&t===this.getActiveElement()&&(this.reservationId=e)},e.prototype.forceReserveFocus=function(e){this.reservationId=e},e.prototype.tryApplyFocusReservation=function(e,t){this.reservationId===e&&(this.reservationId=void 0,null!==t&&void 0!==t&&t.focus())},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.GetActiveElement))],e)}(),Vn=function(e,t){var n=t.get(e.type);if(void 0!==n)for(var o=0,r=n;o<r.length;o++){var i=r[o];i in e||(e[i]=void 0)}},kn=function(e){if(void 0!==e){Vn(e,g.layoutNodeChildOptionalKeys);var t=g.layoutNodeChildChildKeys.get(e.type);if(void 0!==t)for(var n=0,o=t;n<o.length;n++){var r=o[n];if(e[r]instanceof Array)for(var i=0,a=e[r];i<a.length;i++){var s=a[i];kn(s)}kn(e[r])}}},Dn=function(e){for(var t=0,n=Object.keys(e.contentNodes);t<n.length;t++){var o=n[t],r=e.contentNodes[o];Vn(r,g.contentNodeOptionalKeys)}if(void 0!==e.decorators)for(var i=0,a=Object.keys(e.decorators);i<a.length;i++){var s=a[i],c=e.decorators[s];kn(c)}if(void 0!==e.animations)for(var u=0,l=e.animations;u<l.length;u++){var d=l[u];Vn(d,g.animationOptionalKeys)}kn(e.layout)},Fn=function(e,t){return new Map(void 0===e?void 0:e.map(function(e){return[t(e),e]}))},Ln=n(344),Nn=n(84),Bn=n(54),Hn=n(57),Un=n(299),Wn=n(491),qn=n(268),Gn=function(e){return Array.isArray(e)&&1===e.length},zn=function(e){return Array.isArray(e)&&3===e.length&&0===e[1]&&0===e[2]},Kn=function(){var e=new qn.a({objectHash:function(e,t){return void 0!==e.id?e.id:"$$index:"+t}}),t=function(t){if(Object(W.isObservable)(t.left)&&function(e){return"a"!==e._t}(t.delta)){var n=t.left;(function(e){for(var t=0,n=Object.keys(e);t<n.length;t++){var o=n[t];if(Gn(e[o]))return!0}return!1})(t.delta)&&(n=__assign({},t.left));for(var o=0,r=Object.keys(t.delta);o<r.length;o++){var i=r[o];zn(t.delta[i])?n[i]=void 0:n[i]=e.patch(t.left[i],t.delta[i])}t.setResult(n).exit()}};return t.filterName="observableTypeChange",e.processor.pipes.patch.before("objects",t),e},Jn=function(e,t){for(var n={},o=0,r=Object.keys(t);o<r.length;o++){var i=r[o];i in e||(n[i]=[t[i]])}if(0!==Object.keys(n).length)return n},Qn=n(486),$n=function(){function e(e){this.logger=e}return e.prototype.merge=function(e,t,n){return this.mergeLayoutSubtree(e,t,n)},e.prototype.mergeLayoutSubtree=function(e,t,n){if(e.id!==t.id){var o="Id mismatch merging layout nodes.";throw this.logger.logTag(595966101,M.b.Error,o,{expectedId:e.id,segmentId:t.id}),new Qn.a(o)}if(t.type===g.LayoutNodeType.Unpopulated){if(e.type!==t.populatedType&&e.type!==g.LayoutNodeType.Unpopulated){o="Type mismatch skipping unpopulated layout node.";throw this.logger.logTag(595966102,M.b.Error,o,{nodeId:e.id,nodeType:e.type,typeInSegment:t.populatedType}),new Qn.a(o)}return e}if(e.type===g.LayoutNodeType.Unpopulated){if(t.type!==e.populatedType){o="Type mismatch merging layout nodes.";throw this.logger.logTag(595966103,M.b.Error,o,{nodeId:e.id,expectedType:e.populatedType,actualType:t.type}),new Qn.a(o)}return t}for(var r=0,i=function(e){var t=g.layoutNodeChildChildKeys.get(e.type);return void 0===t?[]:t}(e);r<i.length;r++){var a=i[r],s=e[a],c=t[a];if(void 0===s||void 0===c){if(s!==c){o="Mismatch between child properties";throw this.logger.logTag(595966104,M.b.Error,o,{modelId:void 0!==s?s.id:"undefined",segmentId:void 0!==c?c.id:"undefined"}),new Qn.a(o)}}else s instanceof Array?e[a]=this.mergeLayoutNodeChildren(e[a],t[a],n):e[a]=this.mergeLayoutSubtree(s,c,n)}return e},e.prototype.alignSegmentChildrenStart=function(e,t,n){if(t.type!==g.LayoutNodeType.Unpopulated)return 0;for(var o=0;o<e.length;o++){var r=e[o];if(r.id===t.id)return o;if(r.type===g.LayoutNodeType.Unpopulated&&r.segmentIndex>=t.segmentIndex){if(0===o)return o;var i=e[o-1];if(i.type===g.LayoutNodeType.Unpopulated&&i.segmentIndex<=t.segmentIndex)return o}}var a=e[e.length-1];if(a.type===g.LayoutNodeType.Unpopulated&&a.segmentIndex<=t.segmentIndex)return e.length;var s="Segment does not align with existing model children.";throw this.logger.logTag(595966105,M.b.Error,s,{segmentIndex:n,firstSegmentChild:t}),new Qn.a(s)},e.prototype.mergeLayoutNodeChildren=function(e,t,n){if(0===t.length)return e;for(var o=this.alignSegmentChildrenStart(e,t[0],n),r=[],i=0,a=t;i<a.length;i++){var s=a[i];o!==e.length&&s.id===e[o].id?(r.length>0&&(e.splice.apply(e,[o,0].concat(r)),o+=r.length,r=[]),e[o]=this.mergeLayoutSubtree(e[o],s,n),++o):r.push(s)}return r.length>0&&(e.splice.apply(e,[o,0].concat(r)),o+=r.length),this.validateMergedChildren(e,t,n,0===r.length,o),e},e.prototype.validateMergedChildren=function(e,t,n,o,r){if(!o&&r<e.length){var i=t[t.length-1],a=e[r];if(a.type!==g.LayoutNodeType.Unpopulated||i.type!==g.LayoutNodeType.Unpopulated||a.segmentIndex<i.segmentIndex){var s="End of merged segment children do not align with model.";throw this.logger.logTag(595966144,M.b.Error,s,{segmentIndex:n,nextModelChild:a,lastSegmentChild:i,nextChildIndexAfterMerge:r}),new Qn.a(s)}}},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(M.c))],e)}(),Yn=function(){function e(e,t,n){this.modelStore=e,this.layoutMerger=t,this.diffPatcher=n}return e.prototype.merge=function(e,t){var n=this.modelStore.model,o={};if(void 0!==e.animations&&e.animations.length>0){var r=Zn(Object(Wn.b)(n.animations),e.animations,function(e){return e.id}),i=this.diffPatcher.diff(Object(Wn.b)(n.animations),r);void 0!==i&&(o.animations=i)}if(void 0!==e.animationSequences&&e.animationSequences.length>0){var a=Zn(Object(Wn.b)(n.animationSequences),e.animationSequences,function(e){return e.id}),s=this.diffPatcher.diff(Object(Wn.b)(n.animationSequences),a);void 0!==s&&(o.animationSequences=s)}if(void 0!==e.fontFiles&&e.fontFiles.length>0){var c=Zn(Object(Wn.b)(n.fontFiles),e.fontFiles,function(e){return e.fileName}),u=this.diffPatcher.diff(Object(Wn.b)(n.fontFiles),c);void 0!==u&&(o.fontFiles=u)}if(void 0!==e.decorators){var l=Jn(n.decorators,e.decorators);void 0!==l&&(o.decorators=l)}if(void 0!==e.styles){var d=Jn(n.styles,e.styles);void 0!==d&&(o.styles=d)}if(void 0!==e.computedStyles){var p=Jn(n.computedStyles,e.computedStyles);void 0!==p&&(o.computedStyles=p)}var h=Jn(n.contentNodes,e.contentNodes);void 0!==h&&(o.contentNodes=h);var f=this.layoutMerger.merge(Object(Wn.a)(n.layout),e.layout,t),m=this.diffPatcher.diff(Object(Wn.a)(n.layout),f);void 0!==m&&(o.layout=m),Object.keys(o).length>0&&this.modelStore.patchDocumentModel(o,"Segment "+t)},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(y.a)),__param(1,Object(d.inject)($n)),__param(2,Object(d.inject)(R.a.JsonDiffPatcher))],e)}();function Zn(e,t,n){var o=new Map;t.forEach(function(e){o.set(n(e),e)});for(var r=0;r<e.length;++r){var i=n(e[r]),a=o.get(i);void 0!==a&&(e[r]=a,o.delete(i))}return o.forEach(function(t){e.push(t)}),e}
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */var Xn=function(){function e(e,t,n,o,r,i,a,s,c,u){this.modelStore=e,this.documentModelApi=t,this.documentSettingsStore=n,this.documentSegmentMerger=o,this.documentModelVersion=r,this.logger=i,this.dialogQueuer=a,this.refreshDialogPropsFactory=s,this.messageBarStore=c,this.refreshPageMessageBarPropsFactory=u,this.segmentRequests=new Map;var l=Object(Ln.a)(),d=l.promise,p=l.resolve;this.allSegmentsDownloadedPromise=d,this.allSegmentsDownloadedResolver=p,void 0!==this.modelStore.model.documentIndex.segments&&this.modelStore.model.documentIndex.segments.length<2&&this.allSegmentsDownloadedResolver()}return e.prototype.loadSegment=function(e){return __awaiter(this,void 0,Promise,function(){var t,n,o;return __generator(this,function(r){if(void 0!==(t=this.segmentRequests.get(e)))return[2,t];if(void 0===(n=this.getSegmentInfo(e)))throw new Error("Attempted to load segment which does not exist");return o=this.loadNewSegment(n,e),this.segmentRequests.set(e,o),[2,o]})})},e.prototype.loadNewSegment=function(e,t){return __awaiter(this,void 0,Promise,function(){var n;return __generator(this,function(o){switch(o.label){case 0:return[4,this.documentModelApi.getSegment(this.documentSettingsStore.settings.lookupId,this.documentModelVersion,e.continuationToken)];case 1:return(n=o.sent()).isSuccess?n.result&&0!==Object.keys(n.result).length?(this.updateDocumentModel(n.result,t),this.onLoadSuccess(),[2]):[2,new Promise(function(){})]:(this.handleApiFetchFailed(n),[2,new Promise(function(){})])}})})},e.prototype.getSegmentInfo=function(e){if(!(this.modelStore.model.documentIndex.segments.length<e))return this.modelStore.model.documentIndex.segments[e]},e.prototype.updateDocumentModel=function(e,t){Dn(e),this.documentSegmentMerger.merge(e,t)},e.prototype.onLoadSuccess=function(){var e=this;this.segmentRequests.size>=this.modelStore.model.documentIndex.segments.length-1&&Promise.all(this.segmentRequests).then(function(){return e.allSegmentsDownloadedResolver()})},e.prototype.handleApiFetchFailed=function(e){if(e.status===Hn.CONFLICT){var t=void 0;void 0!==e.error&&"SwayVersionChangedToV1"===e.error.code&&(this.logger.logTag(595968768,M.b.Info,"This sway's version has changed to a V1 sway which is incompatible with V2 segmentation"),t=e.error);var n=this.refreshDialogPropsFactory({message:lt.a.SwayVersionChangedToV1Message,logReason:"SwayVersionChangedToV1",priority:Nn.a.Error,errorMessageForDevelopers:t});this.dialogQueuer.queueDialog(n)}else if(e.status===Hn.BAD_REQUEST){void 0!==e.error&&"DocumentModelVersionNotSupported"===e.error.code?this.logger.logTag(595968978,M.b.Reporting,"Tried to fetch document model version which is no longer supported",{versionRequested:this.documentModelVersion}):void 0!==e.error&&"DocumentModelVersionDoesNotExist"===e.error.code?this.logger.logTag(595968979,M.b.Error,"Tried to fetch document model version which server does not yet support",{versionRequested:this.documentModelVersion}):this.logger.logTag(595968980,M.b.Warning,"Model segment request rejected for unknown reason.",{versionRequested:this.documentModelVersion,errorCode:void 0!==e.error?e.error.code:void 0,errorMessage:void 0!==e.error?e.error.message:void 0});n=this.refreshDialogPropsFactory({message:Bn.a.PageExpiredRefreshMessage,logReason:"SegmentModelRequestRejected"});this.dialogQueuer.queueDialog(n)}else{var o=this.refreshPageMessageBarPropsFactory(lt.a.SegmentLoadFailure,Un.a.warning);this.messageBarStore.addMessageBar("SegmentLoadFailed",o)}},__decorate([Pe.action],e.prototype,"updateDocumentModel",null),e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(y.a)),__param(1,Object(d.inject)(u.DocumentModelApi)),__param(2,Object(d.inject)(R.a.DocumentSettingsStore)),__param(3,Object(d.inject)(Yn)),__param(4,Object(d.inject)(a.a.DocumentModelVersion)),__param(5,Object(d.inject)(M.c)),__param(6,Object(d.inject)(a.a.DialogQueuer)),__param(7,Object(d.inject)(a.a.RefreshDialogPropsFactory)),__param(8,Object(d.inject)(a.a.PageMessageBarStore)),__param(9,Object(d.inject)(a.a.RefreshPageMessageBarPropsFactory))],e)}(),eo=function(){function e(e){this.apiFetcher=e}return e.prototype.getMessage=function(e){return __awaiter(this,void 0,Promise,function(){var t,n,o;return __generator(this,function(r){switch(r.label){case 0:return t={method:"DELETE",headers:{Authorization:e.authToken}},[4,this.apiFetcher.fetch(e.listenUrl,t,6e4)];case 1:return(n=r.sent()).ok?(o={isSuccess:!0,status:n.status,headers:t.headers},[4,n.text()]):[3,3];case 2:return[2,(o.result=r.sent(),o)];case 3:return[2,{isSuccess:!1,status:n.status,headers:t.headers,errorResponse:"getMessage request failed. status:"+n.status+" statusText: '"+n.statusText+"'",error:void 0}]}})})},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.ApiFetcher))],e)}(),to=n(46),no=function(){function e(e,t,n,o,r,i,a){this.notificationApi=e,this.documentSyncApi=t,this.routerStore=n,this.syncStateStore=o,this.activityMonitor=r,this.syncStateReporter=i,this.logger=a,this.lastNotification={type:to.c.Empty},this.pollingForNotifications=!1}return e.prototype.setupObservers=function(){Object(W.observe)(this.syncStateStore,"subscription",this.onNewSubscription.bind(this))},e.prototype.onNewSubscription=function(e){"update"===e.type&&void 0!==this.syncStateStore.subscription&&this.longPollForNewMessage()},e.prototype.renewSubscription=function(){var e=this;if(this.syncStateStore.joinedForAuthoring||this.syncStateStore.joinedForConsumption){if(void 0===this.syncStateStore.editSessionToken)throw new Error("Unable to renew without a valid editSessionToken");if(void 0===this.syncStateStore.clientId)throw new Error("Unable to renew without a valid clientId");if(this.routerStore.routeDetails.pageMode!==A.a.Document)throw new Error("Can not renew message subscription when not in document mode");this.syncStateStore.subscription=void 0,this.documentSyncApi.renewMessageSubscription(this.routerStore.routeDetails.lookupId,this.syncStateStore.editSessionToken,this.syncStateStore.clientId).then(function(t){t.isSuccess?e.syncStateStore.subscription=t.result:(e.logger.logTag(595883799,M.b.Error,"Unable to renew the message subscription",{status:t.status,error:t.errorResponse,headers:t.headers}),e.syncStateStore.joinExpired=!0)}).catch(this.syncStateReporter.reportRejectedPromiseAndThrow())}},e.prototype.sendPollRequest=function(e){return __awaiter(this,void 0,Promise,function(){var t=this;return __generator(this,function(n){switch(n.label){case 0:return this.pendingMessagePromise=this.notificationApi.getMessage(e),[4,this.pendingMessagePromise.then(function(e){t.pendingMessagePromise=void 0,e.isSuccess?t.processNotification(function(e){if(""===e)return{type:to.c.Empty};var t=e.split(":");if(1===t.length)throw new Error("Unexpected notification message");if(2!==t.length)throw new Error("Unable to parse notification message");var n=to.c[t[0]];switch(n){case to.c.StoryModel:return{type:n,editVersion:parseInt(t[1],10)};case to.c.SuggestedContent:return{type:n,contentType:t[1]};case to.c.AuthorList:return{type:n,authors:t[1]};default:throw new Error("Unhandled type of notification message")}}(e.result)):t.handleNotificationErrorResponse(e)}).catch(function(e){t.pendingMessagePromise=void 0,t.syncStateReporter.reportRejectedPromiseAndThrow()(e)})];case 1:return n.sent(),[2]}})})},e.prototype.longPollForNewMessage=function(){var e=this;void 0!==this.syncStateStore.subscription&&void 0===this.pendingMessagePromise&&(this.activityMonitor.getMsSinceLastActive()<9e4?(this.sendPollRequest(this.syncStateStore.subscription),this.pollingForNotifications=!0):(this.pollingForNotifications=!1,this.activityMonitor.untilActive(-1).then(function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return[2,this.sendPollRequest(this.syncStateStore.subscription)]})})}).catch(this.syncStateReporter.reportRejectedPromiseAndThrow())))},e.prototype.handleNotificationErrorResponse=function(e){var t=this;switch(e.status){case 490:this.activityMonitor.getMsSinceLastActive()<9e4?this.longPollForNewMessage():(this.pollingForNotifications=!1,this.activityMonitor.untilActive(-1).then(function(){return t.longPollForNewMessage()}).catch(this.syncStateReporter.reportRejectedPromiseAndThrow()));break;case 491:return this.logger.logTag(595883800,M.b.Warning,"Message bus sent a failure response",{status:e.status,error:e.errorResponse,headers:e.headers,editToken:this.syncStateStore.editSessionToken}),void this.renewSubscription();default:var n="Unrecognized response code from the service bus";throw this.logger.logTag(595883801,M.b.Error,n,{status:e.status,error:e.errorResponse,headers:e.headers}),new Error(n)}},e.prototype.processNotification=function(e){switch(e.type){case to.c.StoryModel:this.lastNotification=e;break;case to.c.AuthorList:"ExpiredSessionToken"===e.authors&&(this.syncStateStore.joinExpired=!0),this.lastNotification=e}this.longPollForNewMessage()},__decorate([W.observable],e.prototype,"lastNotification",void 0),__decorate([W.observable],e.prototype,"pollingForNotifications",void 0),e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(R.a.NotificationApi)),__param(1,Object(d.inject)(R.a.DocumentSyncApi)),__param(2,Object(d.inject)(c.a)),__param(3,Object(d.inject)(R.a.SyncStateStore)),__param(4,Object(d.inject)(p.a)),__param(5,Object(d.inject)(R.a.SyncStateReporter)),__param(6,Object(d.inject)(M.c))],e)}(),oo=n(50),ro={logLevel:M.b.Reporting},io=function(){function e(e){this.logger=e}return e.prototype.reportTag=function(e,t,n,o){void 0===n&&(n=ro),void 0!==n.logLevel&&this.logger.logTag(e,n.logLevel,t,o)},e.prototype.reportExceptionTag=function(e,t,n){return this.reportTag(e,t,{logLevel:M.b.Error},n),new Error(t)},e.prototype.reportRejectedPromiseAndThrow=function(){var e=this;return function(t){throw e.reportExceptionTag(0,t)}},e.prototype.report=function(e,t,n){this.reportTag(0,e,t,n)},e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(M.c))],e)}(),ao=u.ClientDeviceType.Desktop,so=function(){function e(e){this.viewport=e,this.joinExpired=!1,this.joinedForAuthoring=!1,this.joinedForConsumption=!1}return Object.defineProperty(e.prototype,"renderingClientInfo",{get:function(){return{clientDevice:ao,viewportWidth:void 0===this.viewport.size?1920:this.viewport.size.width,viewportHeight:void 0===this.viewport.size?1080:this.viewport.size.height,editMode:!0,embedHostMode:0,accessible:!1,viewOptionOverrides:{consumptionWorldId:"",fontScale:1,useLayoutRounding:!1,useLayoutV2:!0,validateStoryboards:!1}}},enumerable:!0,configurable:!0}),__decorate([W.observable],e.prototype,"joinExpired",void 0),__decorate([W.observable],e.prototype,"joinedForAuthoring",void 0),__decorate([W.observable],e.prototype,"joinedForConsumption",void 0),__decorate([W.observable],e.prototype,"clientState",void 0),__decorate([W.observable],e.prototype,"subscription",void 0),__decorate([W.observable],e.prototype,"editVersion",void 0),__decorate([W.observable],e.prototype,"clientId",void 0),__decorate([W.observable],e.prototype,"editSessionToken",void 0),__decorate([W.observable],e.prototype,"authors",void 0),e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(a.a.Viewport))],e)}(),co=function(e,t){var n=e.get(M.c).createChildLogger(M.a.Consumption);e.bind(M.c).toConstantValue(n);var o=e.get(a.a.ClientActionRecorder).createChildRecorder({StoryId:t.documentSettings.storyId});e.bind(a.a.ClientActionRecorder).toConstantValue(o),e.bind(sn.a).toSelf(),e.bind(j).toSelf(),e.bind(m).toSelf(),e.bind(T).toSelf(),e.bind(Cn.a).toSelf(),e.bind(xe).toSelf(),e.bind(In.a).toSelf(),e.bind(tn).toSelf(),e.bind(_).toSelf(),e.bind(Ne).toSelf(),e.bind(on).toSelf(),e.bind(Nt).toSelf(),e.bind(nn).toSelf(),e.bind(rn.a).toSelf(),e.bind(Yn).toSelf(),e.bind(an).toSelf(),e.bind(Wt).toSelf(),e.bind(En.a).toSelf(),e.bind(Ve.a).toSelf(),e.bind(un).toSelf(),e.bind(I).toSelf(),e.bind(De).toSelf(),e.bind($n).toSelf(),e.bind(O).toSelf(),e.bind(en.a).toSelf(),e.bind(Jt).toSelf(),e.bind(w).toSelf(),e.bind(wn.b).toSelf(),e.bind(ke.b).toSelf(),e.bind(Pn.a).toSelf(),e.bind(Sn.c).toSelf(),e.bind(jn.a).toSelf(),e.bind(le.c).toSelf(),e.bind(b.b).toSelf(),e.bind(R.a.SharingFrameStoreFactory).toFactory(An);var r=Kn();e.bind(R.a.JsonDiffPatcher).toConstantValue(r),e.bind(R.a.KeyframeAnimator).toConstantValue(new bn(e.get(a.a.StyleProvider),e.get(M.c))),e.bind(R.a.TransitionAnimator).toConstantValue(new yn);var s=new ln.a(e.get(q.a),e);e.bind(hn.a).toConstantValue(new hn.a(s)),e.bind(fn.a).toConstantValue(new fn.a(s));var c=new pn(s);e.bind(K).toConstantValue(new K(c)),e.bind(R.a.SharePreloadDelaySec).toConstantValue(Pn.b),e.bind(mn.a).to(mn.a).inTransientScope(),e.bind(R.a.DocumentSettingsStore).toConstantValue(new dn.a(t.documentSettings)),e.bind(R.a.FocusHolder).to(xn),Dn(t.documentModel);var l=new y.a(t.documentModel,r);e.bind(y.a).toConstantValue(l),function(e,t){var n={resolveComputedStyleRefs:function(e){for(var n=[],o=0,r=e;o<r.length;o++){var i=r[o];n.push(t.model.computedStyles[i])}return Object.assign.apply(Object,[{}].concat(n))},resolveContractRef:function(e){if(e in t.model.contentNodes)return t.model.contentNodes[e];throw new Error("Unknown contract model node: "+e+".")},resolveStyleRefs:function(e){for(var n=[],o=0,r=e;o<r.length;o++){var i=r[o];n.push(t.model.styles[i])}return Object.assign.apply(Object,[{}].concat(n))},resolveDecoratorRef:function(e){var n=t.model.$mobx.values.decorators.value;if(void 0!==n[e])return n[e];throw new Error("Unknown decorator: "+e+".")},resolveAnimationRefs:function(e){if(void 0===e)return[];var n=Object(W.computed)(function(){var e=t.model.animations;return Fn(e,function(e){return e.id})}).get();return e.map(function(e){return n.get(e)}).filter(function(e){return void 0!==e})},resolveAnimationSequenceRefs:function(e){if(void 0===e)return[];var n=Object(W.computed)(function(){var e=t.model.animationSequences;return Fn(e,function(e){return e.id})}).get();return e.map(function(e){return n.get(e)}).filter(function(e){return void 0!==e})}};e.bind(R.a.DocumentRefResolvers).toConstantValue(n)}(e,l),e.bind(R.a.DocumentSegmentFetcher).to(Xn),e.bind(Le.b).toConstantValue(new Le.b(kt,e.get(M.c),e));var d=e.get(i.a);d.isEnabled(u.FeatureGates.DocumentBlockFactory)?e.bind(Kt).toConstantValue(new _n(e,e.get(M.c))):e.bind(Kt).toConstantValue(new Kt(kt,e.get(M.c),e.get(a.a.SiteSettingsStore),e)),e.bind(_n).toConstantValue(new _n(e,e.get(M.c)));var p=e.get(a.a.SiteSettingsStore);if(d.isEnabled(u.FeatureGates.OnCanvasAuthoring)){var h=new u.DocumentSyncApi(p.settings.siteRootUrl,e.get(a.a.SwayApiFetcher));e.bind(R.a.DocumentSyncApi).toConstantValue(h),e.bind(R.a.NotificationApi).to(eo),e.bind(R.a.MessageBusNotificationClient).to(no),e.bind(R.a.SyncStateStore).to(so),e.bind(R.a.SyncStateReporter).to(io),e.get(R.a.MessageBusNotificationClient).setupObservers(),e.bind(R.a.DocumentSynchronizer).to(oo.a),e.get(R.a.DocumentSynchronizer).setupObservers()}var f=new u.DocumentAnalyticsApi(p.settings.siteRootUrl,e.get(a.a.SwayApiFetcher));e.bind(u.DocumentAnalyticsApi).toConstantValue(f)},uo=n(45),lo=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t._sliderPercentage=50,t.setSliderPercentage=function(e){t._sliderPercentage=e},t}return __extends(t,e),Object.defineProperty(t.prototype,"first",{get:function(){return this.createChild(this.model.first)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"second",{get:function(){return this.createChild(this.model.second)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"sliderPercentage",{get:function(){return this._sliderPercentage},enumerable:!0,configurable:!0}),__decorate([W.observable],t.prototype,"_sliderPercentage",void 0),__decorate([W.computed],t.prototype,"first",null),__decorate([W.computed],t.prototype,"second",null),__decorate([W.computed],t.prototype,"sliderPercentage",null),__decorate([Pe.action],t.prototype,"setSliderPercentage",void 0),t}(Z.b),po=n(270),ho=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"children",{get:function(){return this.createChildren(this.model.children,{fitToParent:!0})},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"children",null),t}(Z.b),fo=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),Object.defineProperty(t.prototype,"videoSrc",{get:function(){return this.content.videoSource},enumerable:!0,configurable:!0}),__decorate([W.computed],t.prototype,"videoSrc",null),t}(Z.b),mo=n(308),go=n(51);
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */n.d(t,"initialize",function(){return bo}),n.d(t,"ISyncStateReporter",function(){}),n.d(t,"IReportingOptions",function(){}),n.d(t,"IDocumentSynchronizer",function(){return oo.IDocumentSynchronizer}),n.d(t,"createDocumentModelDelta",function(){return oo.c}),n.d(t,"DocumentSynchronizer",function(){return oo.a}),n.d(t,"fullDocumentContinuationToken",function(){return oo.d}),n.d(t,"monitorJoinSession",function(){return uo.b}),n.d(t,"routeDetailsPropertyName",function(){return uo.e}),n.d(t,"lastNotificationPropertyName",function(){return uo.a}),n.d(t,"observableUpdateType",function(){return uo.c}),n.d(t,"pollingForNotificationsPropertyName",function(){return uo.d}),n.d(t,"ISyncStateStore",function(){}),n.d(t,"SyncStateStore",function(){return so}),n.d(t,"IMessageBusNotificationClient",function(){}),n.d(t,"IMessageBusNotification",function(){return to.IMessageBusNotification}),n.d(t,"MessageBusNotificationType",function(){return to.c}),n.d(t,"IAuthorListNotification",function(){return to.IAuthorListNotification}),n.d(t,"IAuthoringBundleContents",function(){}),n.d(t,"FontFaceAdder",function(){return un}),n.d(t,"IFontFaceAdder",function(){}),n.d(t,"ConsumptionAttributes",function(){return Q.a}),n.d(t,"AspectRatioCalculator",function(){return xe}),n.d(t,"IKeyframeAnimator",function(){}),n.d(t,"KeyframeAnimator",function(){return bn}),n.d(t,"ITransitionAnimator",function(){}),n.d(t,"TransitionAnimator",function(){return yn}),n.d(t,"documentComponentRegistry",function(){return kt}),n.d(t,"IAuthoringComponentRegistration",function(){}),n.d(t,"IDocumentComponentRegistration",function(){}),n.d(t,"IDocumentContext",function(){}),n.d(t,"DocumentContextFactory",function(){return Nt}),n.d(t,"IDocumentContextFactory",function(){}),n.d(t,"ConsumptionSelectors",function(){return B.a}),n.d(t,"DocumentBlock",function(){return Be}),n.d(t,"IDocumentBlock",function(){}),n.d(t,"DocumentBlockFactory",function(){return _n}),n.d(t,"IViewModelCreateProps",function(){}),n.d(t,"LayoutViewModelFactory",function(){return Le.b}),n.d(t,"ILayoutViewModelFactory",function(){return Le.ILayoutViewModelFactory}),n.d(t,"IAuthoringViewModelCreateProps",function(){}),n.d(t,"IDocumentRefResolvers",function(){}),n.d(t,"IViewModelFactory",function(){}),n.d(t,"DocumentViewFactory",function(){return Wt}),n.d(t,"IDocumentView",function(){}),n.d(t,"IModelViewProps",function(){}),n.d(t,"DocumentViewModelFactory",function(){return Kt}),n.d(t,"IDecoratorState",function(){}),n.d(t,"AuthoringViewModelType",function(){return Z.a}),n.d(t,"IAuthoringViewModelClass",function(){return Z.IAuthoringViewModelClass}),n.d(t,"IAuthoringViewModel",function(){return Z.IAuthoringViewModel}),n.d(t,"IDocumentViewModelClass",function(){return Z.IDocumentViewModelClass}),n.d(t,"IDocumentViewModel",function(){return Z.IDocumentViewModel}),n.d(t,"IViewModelProps",function(){return Z.IViewModelProps}),n.d(t,"BlockTextViewModel",function(){return X}),n.d(t,"CaptionedContentViewModel",function(){return re}),n.d(t,"CellViewModel",function(){return ce}),n.d(t,"ComparisonViewModel",function(){return lo}),n.d(t,"DocumentHeadingViewModel",function(){return pe}),n.d(t,"FlowBodyViewModel",function(){return fe}),n.d(t,"FlowDocViewModel",function(){return ge}),n.d(t,"H1ViewModel",function(){return ve.a}),n.d(t,"H2ViewModel",function(){return Se.a}),n.d(t,"ImageViewModel",function(){return Fe}),n.d(t,"LiquidLayoutViewModel",function(){return ze}),n.d(t,"MediaAndTextViewModel",function(){return $e}),n.d(t,"ParagraphViewModel",function(){return ot.a}),n.d(t,"TextRunStore",function(){return po.a}),n.d(t,"TextFormatter",function(){return Sn.c}),n.d(t,"IResolvedTextRunWithChildren",function(){return Sn.IResolvedTextRunWithChildren}),n.d(t,"IResolvedTextRunWithNoChildren",function(){return Sn.IResolvedTextRunWithNoChildren}),n.d(t,"OrnamentViewModel",function(){return Xe}),n.d(t,"RowViewModel",function(){return it}),n.d(t,"SelectionStore",function(){return wn.b}),n.d(t,"ISelectionStore",function(){return wn.ISelectionStore}),n.d(t,"SlideshowViewModel",function(){return ut}),n.d(t,"StackViewModel",function(){return bt}),n.d(t,"StyleWrapper",function(){return yt}),n.d(t,"TableViewModel",function(){return wt}),n.d(t,"TextViewModel",function(){return jt}),n.d(t,"Text",function(){return Ct}),n.d(t,"TextListViewModel",function(){return Tt}),n.d(t,"UniformGridViewModel",function(){return ho}),n.d(t,"UnknownViewModel",function(){return qt.a}),n.d(t,"UnpopulatedViewModel",function(){return Vt}),n.d(t,"VideoViewModel",function(){return fo}),n.d(t,"DocumentContent",function(){return U}),n.d(t,"DocumentContentStore",function(){return on}),n.d(t,"IPendingRef",function(){return le.IPendingRef}),n.d(t,"IViewReferenceCache",function(){return le.IViewReferenceCache}),n.d(t,"ViewReferenceCache",function(){return le.c}),n.d(t,"AnimationsEnabledStore",function(){return Cn.a}),n.d(t,"IAnimationsEnabledStore",function(){return Cn.IAnimationsEnabledStore}),n.d(t,"RightHeader",function(){return $t.a}),n.d(t,"RightHeaderStore",function(){return en.a}),n.d(t,"IDocumentNavigationLaunchStatus",function(){return rn.IDocumentNavigationLaunchStatus}),n.d(t,"IDocumentNavigationLauncherStore",function(){return rn.IDocumentNavigationLauncherStore}),n.d(t,"DocumentNavigationLauncherStore",function(){return rn.a}),n.d(t,"FocusHolder",function(){return xn}),n.d(t,"IFocusHolder",function(){}),n.d(t,"bindConsumptionContainer",function(){return co}),n.d(t,"ConsumptionInjectionTypes",function(){return R.a}),n.d(t,"ConsumptionUiStrings",function(){return lt.a}),n.d(t,"DocumentModelStore",function(){return y.a}),n.d(t,"IDocumentModelStore",function(){return y.IDocumentModelStore}),n.d(t,"IDocumentModelStoreReadWrite",function(){return y.IDocumentModelStoreReadWrite}),n.d(t,"IStoredDocumentModel",function(){return y.IStoredDocumentModel}),n.d(t,"IDocumentModelStoreChangeNotifier",function(){return y.IDocumentModelStoreChangeNotifier}),n.d(t,"findInLayoutSubtree",function(){return mo.a}),n.d(t,"IDocumentSegmentFetcherProgress",function(){}),n.d(t,"IDocumentAnimationRefResolver",function(){}),n.d(t,"IDocumentAnimationSequenceRefResolver",function(){}),n.d(t,"IDocumentContractRefResolver",function(){}),n.d(t,"IDocumentDecoratorRefResolver",function(){}),n.d(t,"IDocumentDefaultTemplateContentNodeResolver",function(){}),n.d(t,"IDocumentStyleRefResolver",function(){}),n.d(t,"IDocumentComputedStyleRefResolver",function(){}),n.d(t,"IDevToolsDependencies",function(){return hn.IDevToolsDependencies}),n.d(t,"createDiffPatcher",function(){return Kn}),n.d(t,"GenericClientActionMonitor",function(){return I}),n.d(t,"getContentParent",function(){return go.b}),n.d(t,"getContentGrandparent",function(){return go.a}),n.d(t,"viewportToDomRect",function(){return je.c}),n.d(t,"directionToDirAttribute",function(){return et.a}),n.d(t,"ISelectionStyleResolver",function(){return ke.ISelectionStyleResolver}),n.d(t,"SelectionStyleResolver",function(){return ke.b}),n.d(t,"IFocusStyleResolver",function(){return Ve.IFocusStyleResolver}),n.d(t,"FocusStyleResolver",function(){return Ve.a}),n.d(t,"IVisibleComponentTracker",function(){return b.IVisibleComponentTracker}),n.d(t,"VisibleComponentTracker",function(){return b.b});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var bo=function(e,t){co(e,t);var n=e.get(r.a);return e.get(i.a).isEnabled(u.FeatureGates.DocumentNavigation)&&n.wrapInBackground(e.get(rn.a).preload()),e.get(a.a.SiteSettingsStore).settings.renderType!==u.RenderType.ServerRender&&(e.get(_).start(),e.get(w).start(),e.get(m).start(),e.get(T).start(),e.get(j).start()),e.get(a.a.ClientActionRecorder).recordAction(s.a.PageLoad,{Referrer:document.referrer,PageLoadType:e.get(c.a).routeDetails.pageMode}),e.get(sn.a).subscribeToKeyboardEvents(),e.get(an).subscribeToKeyboardEvents(),e.get(un).start(),e.get(I).monitorEvents(),{view:l.createElement(U,{store:e.get(on)})}}},15:
/*!****************************************************************!*\
  !*** ./src/Consumption/Injection/ConsumptionInjectionTypes.ts ***!
  \****************************************************************/
/*! exports provided: ConsumptionInjectionTypes */
/*! exports used: ConsumptionInjectionTypes */function(e,t,n){"use strict";
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var o;n.d(t,"a",function(){return o}),function(e){e.ConsumptionDocumentContext="ConsumptionDocumentContext",e.DocumentRefResolvers="DocumentRefResolvers",e.DocumentModeStore="DocumentModeStore",e.DocumentSegmentFetcher="DocumentSegmentFetcher",e.DocumentSyncApi="DocumentSyncApi",e.NotificationApi="NotificationApi",e.DocumentSynchronizer="DocumentSynchronizer",e.MessageBusNotificationClient="MessageBusNotificationClient",e.DocumentSettingsStore="DocumentSettingsFetcher",e.FocusHolder="FocusHolder",e.JsonDiffPatcher="JsonDiffPatcher",e.KeyframeAnimator="KeyframeAnimator",e.SharingFrameStoreFactory="SharingFrameStoreFactory",e.SharePreloadDelaySec="SharePreloadDelaySec",e.TransitionAnimator="TransitionAnimator",e.SyncStateStore="SyncStateStore",e.SyncStateReporter="SyncStateReporter"}(o||(o={}))},18:
/*!******************************************************!*\
  !*** ./src/Consumption/Models/DocumentModelStore.ts ***!
  \******************************************************/
/*! exports provided: documentModelDefaults, DocumentModelStore */
/*! exports used: DocumentModelStore, IDocumentModelStore, IDocumentModelStoreChangeNotifier, IDocumentModelStoreReadWrite, IStoredDocumentModel */function(e,t,n){"use strict";n.d(t,"a",function(){return a});var o=n(/*! mobx */3),r=n(/*! mobx-safe */7),i={animations:[],animationSequences:[],computedStyles:{},decorators:{},documentIndex:{},documentProperties:{},fontFiles:[],styles:{}},a=function(){function e(e,t){var n=this;this.diffPatcher=t,this.onChangeCallbacks=[],this.patchDocumentModel=function(e,t){if(void 0!==e){for(var o=0,r=n.onChangeCallbacks;o<r.length;o++){(0,r[o])(e,n._model,t)}n._model=n.diffPatcher.patch(n._model,e)}},this.unpatchDocumentModel=function(e){void 0!==e&&(n._model=n.diffPatcher.unpatch(n._model,e))},this._model=__assign({},i,e)}return Object.defineProperty(e.prototype,"model",{get:function(){return this._model},enumerable:!0,configurable:!0}),e.prototype.registerOnChange=function(e){this.onChangeCallbacks.push(e)},__decorate([o.observable],e.prototype,"_model",void 0),__decorate([o.computed],e.prototype,"model",null),__decorate([r.action],e.prototype,"patchDocumentModel",void 0),__decorate([r.action],e.prototype,"unpatchDocumentModel",void 0),e}()},20:
/*!**************************************************************************!*\
  !*** ./src/Consumption/Localization/ConsumptionUIStrings.ts + 1 modules ***!
  \**************************************************************************/
/*! exports provided: ConsumptionUiStrings */
/*! exports used: ConsumptionUiStrings */function(e,t,n){"use strict";var o={};n.r(o),n.d(o,"AccessibilityViewLabel",function(){return r}),n.d(o,"AnimationsLabel",function(){return i}),n.d(o,"ContentMissingNotice",function(){return a}),n.d(o,"DialogLoadingAriaLabel",function(){return s}),n.d(o,"Edit",function(){return c}),n.d(o,"EditInV2",function(){return u}),n.d(o,"EditInStoryline",function(){return l}),n.d(o,"EditInStorylineLabel",function(){return d}),n.d(o,"EditLabel",function(){return p}),n.d(o,"FeedbackBubbleBody",function(){return h}),n.d(o,"FeedbackBubbleHeadline",function(){return f}),n.d(o,"FeedbackButtonAriaLabel",function(){return m}),n.d(o,"GiveUsFeedback",function(){return g}),n.d(o,"LearnMoreLinkText",function(){return b}),n.d(o,"NavigationButton",function(){return y}),n.d(o,"NavigationButtonAriaLabel",function(){return v}),n.d(o,"NavigationButtonTooltip",function(){return _}),n.d(o,"Off",function(){return S}),n.d(o,"On",function(){return w}),n.d(o,"OverflowMenuButtonLabel",function(){return C}),n.d(o,"OverflowMenuButtonTitle",function(){return j}),n.d(o,"Play",function(){return M}),n.d(o,"SegmentLoadFailure",function(){return R}),n.d(o,"SettingsMenuButtonLabel",function(){return O}),n.d(o,"SettingsMenuButtonTitle",function(){return T}),n.d(o,"ShareButton",function(){return A}),n.d(o,"ShareButtonLabel",function(){return P}),n.d(o,"ShareMenuAriaLabel",function(){return E}),n.d(o,"ShareTrustBubbleMessage",function(){return I}),n.d(o,"ShareTrustBubbleTitle",function(){return x}),n.d(o,"StackFlipperLabel",function(){return V}),n.d(o,"SwayVersionChangedToV1Message",function(){return k}),n.d(o,"ReportViolationButton",function(){return D});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var r="Accessibility View",i="Animations",a="Sorry, something went wrong. Some of your content may be missing.",s="Loading dialog",c="Edit",u="Edit in V2",l="Edit in Storyline",d="Edit in Storyline",p="Edit this Sway",h="You're using a beta version of Sway. Please send feedback to ",f="Tell us what you think!",m="Feedback",g="Give us feedback",b="Learn More",y="Navigation",v="Navigation menu",_="Navigate to different sections in this Sway",S="Off",w="On",C="More Sway options",j="Discover more available options",M="Play",R="Network issues are preventing us from opening parts of your Sway. Please refresh, or try again later.",O="View Settings",T="Change the settings of this Sway",A="Share",P="Share this Sway",E="Share menu",I="Only you can view this content. To invite others to view the content, use the Share menu.",x="This web page is private",V="Tap to flip through this stack",k="The author of this Sway made some changes. Please refresh to see the updates.",D="Report a violation";n.d(t,"a",function(){return o})},243:
/*!************************************************************!*\
  !*** ./src/Consumption/Components/ConsumptionSelectors.ts ***!
  \************************************************************/
/*! exports provided: consumptionPrefix, ConsumptionSelectors */
/*! exports used: ConsumptionSelectors */function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(/*! @sway/boot */49),r={CogWheelMenu:o.b+"consumption-cogwheelmenu",CogWheelMenuButton:o.b+"consumption-cogwheelmenu-button",ComparisonContainerFirst:o.b+"consumption-comparison-container-first",ComparisonContainerSecond:o.b+"consumption-comparison-container-second",DocumentContentContainer:o.b+"consumption-document-content-container",DocumentContent:o.b+"consumption-document-content",EditInV1:o.b+"consumption-editinv1",EnterExitAuthoring:o.b+"consumption-enter-exit-authoring",InternalFeedback:o.b+"consumption-internal-feedback",NavigationButton:o.b+"consumption-navigation",OpenDevTools:o.b+"consumption-open-devtools",OverflowMenuButton:o.b+"consumption-overflowmenu-button",RightHeader:o.b+"consumption-right-header",RotatedChild:o.b+"consumption-rotated-child",RotatedChildContainer:o.b+"consumption-rotated-child-container",ShareButton:o.b+"consumption-sharebutton",ShareMenu:o.b+"consumption-sharemenu",ShareMenuIframe:o.b+"consumption-shareiframe"};
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */},249:
/*!*********************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/SelectionStyleResolver.ts ***!
  \*********************************************************************************/
/*! exports provided: SelectionStyleResolver */
/*! exports used: ISelectionStyleResolver, SelectionStyleResolver */function(e,t,n){"use strict";n.d(t,"b",function(){return u});var o=n(/*! @sway/boot */61),r=n(/*! @sway/documentmodel */69),i=n(/*! inversify */2),a=n(/*! ./ViewModelContextUtilities */51),s=n(/*! ./SelectionStore */47),c={selection:{outline:"3px solid #008272",":hover":{outline:"3px solid #008272"}},selectable:{":hover":{outline:"1px solid #008272"}}},u=function(){function e(e,t){this.routerStore=e,this.selectionStore=t}return e.prototype.isSelectable=function(e){if(this.routerStore.routeDetails.inAuthoring)switch(e.type){case r.LayoutNodeType.Image:return!0;case r.LayoutNodeType.Paragraph:return Object(a.c)(e)}return!1},e.prototype.getSelectionStyle=function(e){return this.isSelectable(e)&&this.selectionStore.isSelected(e)?c.selection:{}},e.prototype.getSelectableStyle=function(e){return this.isSelectable(e)?c.selectable:{}},e=__decorate([Object(i.injectable)(),__param(0,Object(i.inject)(o.a)),__param(1,Object(i.inject)(s.b))],e)}()},250:
/*!*****************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/FocusStyleResolver.ts ***!
  \*****************************************************************************/
/*! exports provided: FocusStyleResolver */
/*! exports used: FocusStyleResolver, IFocusStyleResolver */function(e,t,n){"use strict";n.d(t,"a",function(){return u});var o=n(/*! @sway/boot */489),r=n(/*! @sway/boot */61),i=n(/*! @sway/documentmodel */69),a=n(/*! inversify */2),s=n(/*! ./ViewModelContextUtilities */51),c={"&:focus":{outline:"2px dotted #737373"}},u=function(){function e(e){this.routerStore=e}return e.prototype.isFocusable=function(e){if(this.routerStore.routeDetails.inAuthoring)switch(e.type){case i.LayoutNodeType.Image:return!0;case i.LayoutNodeType.Paragraph:return Object(s.c)(e)}return!1},e.prototype.shouldBeInTabOrder=function(e){return this.isFocusable(e)?o.a.IncludeInTabLoop:o.a.ExcludeFromTabLoop},e.prototype.getFocusStyle=function(e){return this.isFocusable(e)?c:{}},e=__decorate([Object(a.injectable)(),__param(0,Object(a.inject)(r.a))],e)}()},251:
/*!***********************************************************************!*\
  !*** ./src/Consumption/Components/Settings/AnimationsEnabledStore.ts ***!
  \***********************************************************************/
/*! exports provided: AnimationsEnabledStore */
/*! exports used: AnimationsEnabledStore, IAnimationsEnabledStore */function(e,t,n){"use strict";n.d(t,"a",function(){return l});var o=n(/*! @sway/boot */61),r=n(/*! @sway/boot */17),i=n(/*! @sway/internalapi */5),a=n(/*! inversify */2),s=n(/*! mobx */3),c=n(/*! ./AccessibilityViewSwitcher */262),u=n(/*! ./UserAnimationsEnabledStore */269),l=function(){function e(e,t,n,o){this.accessibilityViewSwitcher=e,this.userAnimationsEnabledStore=t,this.routerStore=n,this.siteSettingsStore=o}return Object.defineProperty(e.prototype,"isAnimationsEnabled",{get:function(){return this.userAnimationsEnabledStore.userAnimationsEnabled&&this.userCanEnableAnimations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"userCanEnableAnimations",{get:function(){return!this.accessibilityViewSwitcher.isAccessibilityViewEnabled&&this.siteSettingsStore.settings.renderType===i.RenderType.ClientRender&&!this.routerStore.routeDetails.inAuthoring},enumerable:!0,configurable:!0}),__decorate([s.computed],e.prototype,"isAnimationsEnabled",null),__decorate([s.computed],e.prototype,"userCanEnableAnimations",null),e=__decorate([Object(a.injectable)(),__param(0,Object(a.inject)(c.a)),__param(1,Object(a.inject)(u.a)),__param(2,Object(a.inject)(o.a)),__param(3,Object(a.inject)(r.a.SiteSettingsStore))],e)}()},254:
/*!**********************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/VisibleComponentTracker.ts ***!
  \**********************************************************************************/
/*! exports provided: VisibleComponentTracker */
/*! exports used: IVisibleComponentTracker, VisibleComponentTracker */function(e,t,n){"use strict";n.d(t,"b",function(){return a});var o=n(/*! inversify */2),r=n(/*! mobx */3),i=n(/*! mobx-safe */7),a=function(){function e(){this.visibleComponentMap=Object(r.observable)(new Map)}return Object.defineProperty(e.prototype,"visibleComponents",{get:function(){return this.visibleComponentMap.values()},enumerable:!0,configurable:!0}),e.prototype.observe=function(e){return this.visibleComponentMap.observe(e)},e.prototype.setVisibility=function(e,t){e?this.visibleComponentMap.set(t.key,t):this.visibleComponentMap.delete(t.key)},__decorate([r.computed],e.prototype,"visibleComponents",null),__decorate([i.action],e.prototype,"setVisibility",null),e=__decorate([Object(o.injectable)()],e)}()},257:
/*!***********************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/Unknown/UnknownViewModel.ts ***!
  \***********************************************************************************/
/*! exports provided: UnknownViewModel */
/*! exports used: UnknownViewModel */function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(/*! @sway/boot */17),r=n(/*! @sway/boot */286),i=n(/*! @sway/internalapi */5),a=n(/*! mobx */3),s=function(){function e(e,t,n){this.model=e,this.refResolvers=n,this.styleProvider=t.get(o.a.StyleProvider),this.featureGates=t.get(r.a)}return Object.defineProperty(e.prototype,"type",{get:function(){return this.model.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return this.model.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"showDebugInfo",{get:function(){return this.featureGates.isEnabled(i.FeatureGates.DeveloperTools)},enumerable:!0,configurable:!0}),__decorate([a.computed],e.prototype,"type",null),__decorate([a.computed],e.prototype,"key",null),__decorate([a.computed],e.prototype,"showDebugInfo",null),e}()},26:
/*!**********************************************************************!*\
  !*** ./src/Consumption/Components/Referencing/ViewReferenceCache.ts ***!
  \**********************************************************************/
/*! exports provided: ViewReferenceCache */
/*! exports used: IPendingRef, IViewReferenceCache, ViewReferenceCache */function(e,t,n){"use strict";n.d(t,"c",function(){return a});var o=n(/*! @sway/boot */344),r=n(/*! inversify */2),i=n(/*! mobx */3),a=function(){function e(){this.pendingRefs=new Map}return e.prototype.createRef=function(e){var t=this.pendingRefs.get(e);if(void 0!==t)return t.ref;var n=i.observable.box(void 0),r=Object(o.a)(),a=r.promise,s=r.resolve,c={elementPromise:a,element:n,exists:i.observable.box(!1),ref:function(e){n.set(e),c.exists.set(!0),s(n)}};return this.pendingRefs.set(e,c),c.ref},e.prototype.getPendingRef=function(e){return this.pendingRefs.get(e)},__decorate([i.action],e.prototype,"createRef",null),e=__decorate([Object(r.injectable)()],e)}()},262:
/*!**************************************************************************!*\
  !*** ./src/Consumption/Components/Settings/AccessibilityViewSwitcher.ts ***!
  \**************************************************************************/
/*! exports provided: AccessibilityViewSwitcher */
/*! exports used: AccessibilityViewSwitcher */function(e,t,n){"use strict";n.d(t,"a",function(){return d});var o=n(/*! @sway/boot */347),r=n(/*! @sway/boot */60),i=n(/*! @sway/boot */76),a=n(/*! @sway/boot */61),s=n(/*! @sway/boot */17),c=n(/*! inversify */2),u=n(/*! mobx */3),l=n(/*! mobx-safe */7),d=function(){function e(e,t){var n=this;this.routerStore=e,this.eventReceiver=t,this.setAccessibilityView=function(e){n.routerStore.replaceRoute(__assign({},n.routerStore.routeDetails,{isAccessibilityView:e}))}}return Object.defineProperty(e.prototype,"isAccessibilityViewEnabled",{get:function(){var e=!1;return this.routerStore.routeDetails.pageMode===r.a.Document&&this.routerStore.routeDetails.isAccessibilityView&&(e=!0),e},enumerable:!0,configurable:!0}),e.prototype.subscribeToKeyboardEvents=function(){var e=this;this.eventReceiver.on(i.a.GlobalKeydown,function(t){(function(e){return e.key===o.a.UppercaseV&&!e.ctrlKey&&e.altKey&&e.shiftKey})(t)&&e.setAccessibilityView(!e.isAccessibilityViewEnabled)})},__decorate([u.computed],e.prototype,"isAccessibilityViewEnabled",null),__decorate([l.action],e.prototype,"setAccessibilityView",void 0),e=__decorate([Object(c.injectable)(),__param(0,Object(c.inject)(a.a)),__param(1,Object(c.inject)(s.a.EventReceiver))],e)}()},263:
/*!************************************************************!*\
  !*** ./src/Consumption/Adapters/DevToolsBundleImporter.ts ***!
  \************************************************************/
/*! exports provided: DevToolsBundleImporter */
/*! exports used: DevToolsBundleImporter, IDevToolsDependencies */function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(/*! @sway/boot */77),r=function(){return function(e){var t=this;this.swayBundleImporter=e,this.import=function(){return __awaiter(t,void 0,Promise,function(){return __generator(this,function(e){return[2,{error:new Error("DevTools is not included in prod"),status:o.b.Failed}]})})}}}();
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */},269:
/*!***************************************************************************!*\
  !*** ./src/Consumption/Components/Settings/UserAnimationsEnabledStore.ts ***!
  \***************************************************************************/
/*! exports provided: UserAnimationsEnabledStore */
/*! exports used: UserAnimationsEnabledStore */function(e,t,n){"use strict";n.d(t,"a",function(){return a});var o=n(/*! inversify */2),r=n(/*! mobx */3),i=n(/*! mobx-safe */7),a=function(){function e(){var e=this;this._userAnimationsEnabled=!0,this.setUserAnimationsEnabled=function(t){e._userAnimationsEnabled=t}}return Object.defineProperty(e.prototype,"userAnimationsEnabled",{get:function(){return this._userAnimationsEnabled},enumerable:!0,configurable:!0}),__decorate([r.observable],e.prototype,"_userAnimationsEnabled",void 0),__decorate([r.computed],e.prototype,"userAnimationsEnabled",null),__decorate([i.action],e.prototype,"setUserAnimationsEnabled",void 0),e=__decorate([Object(o.injectable)()],e)}()},270:
/*!*********************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/Paragraph/TextRunStore.ts ***!
  \*********************************************************************************/
/*! exports provided: TextRunStore */
/*! exports used: TextRunStore */function(e,t,n){"use strict";n.d(t,"a",function(){return o});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var o=function(){function e(e,t,n,o){this.styleProvider=e,this.styleMap=t,this.resolvedTextRun=n,this.animationStore=o}return e.prototype.getChildTextRuns=function(){var t=this;if(void 0!==this.resolvedTextRun.children)return this.resolvedTextRun.children.map(function(n){return new e(t.styleProvider,t.styleMap,n,t.animationStore)})},e}()},29:
/*!*************************************************************************************************!*\
  !*** ./src/Consumption/Components/SiteComponents/Navigation/DocumentNavigationLauncherStore.ts ***!
  \*************************************************************************************************/
/*! exports provided: DocumentNavigationLauncherStore */
/*! exports used: DocumentNavigationLauncherStore, IDocumentNavigationLaunchStatus, IDocumentNavigationLauncherStore */function(e,t,n){"use strict";n.d(t,"a",function(){return d});var o=n(/*! @sway/boot */77),r=n(/*! @sway/boot */17),i=n(/*! inversify */2),a=n(/*! mobx */3),s=n(/*! mobx-safe */7),c=n(/*! office-ui-fabric-react/lib/MessageBar */299),u=n(/*! ../../../Adapters/DocumentNavigationBundleImporter */307),l=n(/*! ../../../Localization/ConsumptionUIStrings */20),d=function(){function e(e,t,n){var r=this;this.documentNavigationBundleImporter=e,this.messageBarStore=t,this.refreshPageMessageBarPropsFactory=n,this.requestedOpen=!1,this.preload=function(){return __awaiter(r,void 0,Promise,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return void 0!==this.result||void 0!==this.pendingBundleLoad?[2]:(this.pendingBundleLoad=this.documentNavigationBundleImporter.import(),e=this.setResult,[4,this.pendingBundleLoad]);case 1:return e.apply(this,[t.sent()]),this.pendingBundleLoad=void 0,[2]}})})},this.requestClose=function(){r.requestedOpen=!1},this.requestOpen=function(){return __awaiter(r,void 0,Promise,function(){return __generator(this,function(e){switch(e.label){case 0:return this.requestedOpen=!0,[4,this.preload()];case 1:return e.sent(),[2]}})})},this.setResult=function(e){if(r.result=e,e.status===o.b.Failed){var t=r.refreshPageMessageBarPropsFactory(l.a.ContentMissingNotice,c.a.warning);r.messageBarStore.addMessageBar("DocumentNavigationBundleLoadFailed",t)}}}return Object.defineProperty(e.prototype,"launchStatus",{get:function(){return{requestedOpen:this.requestedOpen,contents:void 0===this.result||this.result.status===o.b.Failed?void 0:this.result.contents}},enumerable:!0,configurable:!0}),__decorate([a.observable],e.prototype,"requestedOpen",void 0),__decorate([a.observable],e.prototype,"result",void 0),__decorate([a.computed],e.prototype,"launchStatus",null),__decorate([s.action],e.prototype,"preload",void 0),__decorate([s.action],e.prototype,"requestClose",void 0),__decorate([s.action],e.prototype,"requestOpen",void 0),__decorate([s.action],e.prototype,"setResult",void 0),e=__decorate([Object(i.injectable)(),__param(0,Object(i.inject)(u.a)),__param(1,Object(i.inject)(r.a.PageMessageBarStore)),__param(2,Object(i.inject)(r.a.RefreshPageMessageBarPropsFactory))],e)}()},301:
/*!************************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/Animations/AnimationStore.ts ***!
  \************************************************************************************/
/*! exports provided: AnimationStore */
/*! exports used: AnimationStore */function(e,t,n){"use strict";n.d(t,"a",function(){return s});var o=n(/*! mobx */3),r=n(/*! mobx-safe */7),i=n(/*! react */0),a=n(/*! ../../../Utilities/DomRect */78),s=function(){function e(e,t,n,o,r,a,s,c,u,l){var d=this;this.onIntersectionObserverChange=function(e){d._isIntersectionObserverInView=e},this.resolveAnimationRefs=t,this.resolveAnimationSequenceRefs=n,this.styleProvider=o,this.intersectionObserver=r,this.elementType=u,this.target=e,this.animationsEnabledStore=a,this.transitionAnimator=s,this.keyframeAnimator=c,this.viewport=l,this._isIntersectionObserverInView=!1,this._isIntersectingWithViewport=!1,this.animationElementRef=i.createRef(),this.animationElement=null}return Object.defineProperty(e.prototype,"animations",{get:function(){var e=this,t=[];return this.animationSequences.forEach(function(n){n.animations.forEach(function(n){n.element===e.elementType&&t.push(n.animationId)})}),this.resolveAnimationRefs(t)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationSequences",{get:function(){return this.resolveAnimationSequenceRefs(this.target.animationSequenceRefs)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAnimated",{get:function(){return this.animationsEnabledStore.isAnimationsEnabled&&this.animations.length>0},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"keyframeAnimationStyle",{get:function(){return this.isInView?this.keyframeAnimator.animatedStyle(this.animations):this.keyframeAnimator.initialKeyframeStyles(this.animations)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"transitionAnimationStyle",{get:function(){var e=[this.transitionAnimator.getTransitionEffects(this.animations)];return this.isInView&&e.push(this.transitionAnimator.animatedStyle(this.animations)),Object.assign.apply(Object,[{}].concat(e))},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animatedStyles",{get:function(){return __assign({},this.keyframeAnimationStyle,this.transitionAnimationStyle)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isInView",{get:function(){return this._isIntersectionObserverInView||this._isIntersectingWithViewport},enumerable:!0,configurable:!0}),e.prototype.setAnimationElementRef=function(){this.animationElement=this.animationElementRef.current},e.prototype.calculateViewportIntersection=function(){if(null!==this.animationElement){var e=this.animationElement.getBoundingClientRect(),t=Object(a.c)(this.viewport);return t=Object(a.b)(t,0),void(this._isIntersectingWithViewport=Object(a.a)(e,t))}this._isIntersectingWithViewport=!1},__decorate([o.observable],e.prototype,"_isIntersectionObserverInView",void 0),__decorate([o.observable],e.prototype,"_isIntersectingWithViewport",void 0),__decorate([o.observable],e.prototype,"animationElement",void 0),__decorate([o.computed],e.prototype,"animations",null),__decorate([o.computed],e.prototype,"animationSequences",null),__decorate([o.computed],e.prototype,"isAnimated",null),__decorate([r.action],e.prototype,"onIntersectionObserverChange",void 0),__decorate([o.computed],e.prototype,"keyframeAnimationStyle",null),__decorate([o.computed],e.prototype,"transitionAnimationStyle",null),__decorate([o.computed],e.prototype,"animatedStyles",null),__decorate([o.computed],e.prototype,"isInView",null),__decorate([r.action],e.prototype,"setAnimationElementRef",null),__decorate([r.action],e.prototype,"calculateViewportIntersection",null),e}()},303:
/*!*******************************************************************************!*\
  !*** ./src/Consumption/Components/SiteComponents/Header/CogWheelMenuStore.ts ***!
  \*******************************************************************************/
/*! exports provided: CogWheelMenuStore */
/*! exports used: CogWheelMenuStore */function(e,t,n){"use strict";n.d(t,"a",function(){return p});var o=n(/*! @sway/boot */289),r=n(/*! @sway/boot */17),i=n(/*! inversify */2),a=n(/*! mobx */3),s=n(/*! mobx-safe */7),c=n(/*! ../../CalloutStore */304),u=n(/*! ../../Settings/AccessibilityViewSwitcher */262),l=n(/*! ../../Settings/AnimationsEnabledStore */251),d=n(/*! ../../Settings/UserAnimationsEnabledStore */269),p=function(){function e(e,t,n,o,r){var i=this;this.accessibilityViewSwitcher=e,this.animationsEnabledStore=t,this.calloutStore=n,this.clientActionRecorder=o,this.userAnimationsEnabledStore=r,this.accessibilityViewToggleClickHandler=function(e,t){i.recordButtonClickAction("accessibility-view-toggle-button"),i.calloutStore.dismissCallout(),i.accessibilityViewSwitcher.setAccessibilityView(t)},this.animationsToggleClickHandler=function(e,t){i.recordButtonClickAction("animation-toggle-button"),i.userAnimationsEnabledStore.setUserAnimationsEnabled(t)},this.cogWheelMenuClickHandler=function(){i.recordButtonClickAction("cog-wheel-menu-button"),i.calloutStore.toggleCalloutVisibility()}}return Object.defineProperty(e.prototype,"isAccessibilityViewEnabled",{get:function(){return this.accessibilityViewSwitcher.isAccessibilityViewEnabled},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAnimationsEnabled",{get:function(){return this.userAnimationsEnabledStore.userAnimationsEnabled&&this.animationsEnabledStore.userCanEnableAnimations},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isAnimationsToggleDisabled",{get:function(){return!this.animationsEnabledStore.userCanEnableAnimations},enumerable:!0,configurable:!0}),e.prototype.recordButtonClickAction=function(e){this.clientActionRecorder.recordAction(o.a.ButtonClicked,{Target:e})},__decorate([a.computed],e.prototype,"isAccessibilityViewEnabled",null),__decorate([a.computed],e.prototype,"isAnimationsEnabled",null),__decorate([a.computed],e.prototype,"isAnimationsToggleDisabled",null),__decorate([s.action],e.prototype,"accessibilityViewToggleClickHandler",void 0),__decorate([s.action],e.prototype,"animationsToggleClickHandler",void 0),e=__decorate([Object(i.injectable)(),__param(0,Object(i.inject)(u.a)),__param(1,Object(i.inject)(l.a)),__param(2,Object(i.inject)(c.a)),__param(3,Object(i.inject)(r.a.ClientActionRecorder)),__param(4,Object(i.inject)(d.a))],e)}()},304:
/*!*****************************************************!*\
  !*** ./src/Consumption/Components/CalloutStore.tsx ***!
  \*****************************************************/
/*! exports provided: CalloutStore */
/*! exports used: CalloutStore */function(e,t,n){"use strict";n.d(t,"a",function(){return h});var o=n(/*! @sway/boot */19),r=n(/*! aria-roles */58),i=n(/*! inversify */2),a=n(/*! mobx */3),s=n(/*! mobx-safe */7),c=n(/*! office-ui-fabric-react/lib/Callout */90),u=n(/*! office-ui-fabric-react/lib/Callout */500),l=n(/*! office-ui-fabric-react/lib/FocusZone */483),d=n(/*! office-ui-fabric-react/lib/FocusZone */352),p=n(/*! react */0),h=function(){function e(e){var t=this;this.logger=e,this._isCalloutVisible=!1,this.toggleCalloutVisibility=function(){t._isCalloutVisible=!t._isCalloutVisible},this.dismissCallout=function(){t.logger.logTag(595970073,o.b.Info,"Dismissing callout"),t._isCalloutVisible=!1},this.setTarget=function(e){t.targetElement=e},this.renderCallout=function(e,n,o){if(t.isCalloutVisible){var i=o?c.a.bottomLeftEdge:c.a.bottomRightEdge,a=o?"rtl":"ltr";return p.createElement(u.a,{role:r.Roles.AlertDialog,gapSpace:0,directionalHint:i,isBeakVisible:!1,target:t.targetElement,onDismiss:t.dismissCallout,setInitialFocus:!0,id:n,dir:a},p.createElement(l.a,{handleTabKey:d.b.all,isCircularNavigation:!0},e()))}}}return Object.defineProperty(e.prototype,"isCalloutVisible",{get:function(){return this._isCalloutVisible},enumerable:!0,configurable:!0}),__decorate([a.observable],e.prototype,"_isCalloutVisible",void 0),__decorate([a.computed],e.prototype,"isCalloutVisible",null),__decorate([s.action],e.prototype,"toggleCalloutVisibility",void 0),__decorate([s.action],e.prototype,"dismissCallout",void 0),e=__decorate([Object(i.injectable)(),__param(0,Object(i.inject)(o.c))],e)}()},305:
/*!****************************************************************!*\
  !*** ./src/Consumption/Components/Sharing/SharingMenuStore.ts ***!
  \****************************************************************/
/*! exports provided: defaultSharePreloadDelayMs, SharingMenuStore */
/*! exports used: SharingMenuStore, defaultSharePreloadDelayMs */function(e,t,n){"use strict";n.d(t,"b",function(){return d}),n.d(t,"a",function(){return p});var o=n(/*! @sway/boot */289),r=n(/*! @sway/boot */17),i=n(/*! inversify */2),a=n(/*! mobx */3),s=n(/*! react */0),c=n(/*! ../../Injection/ConsumptionInjectionTypes */15),u=n(/*! ../ConsumptionSelectors */243),l=2e3,d=1e4,p=function(){function e(e,t,n,r,i,a){var c=this;this.clientActionRecorder=t,this.styleProvider=n,this.setTimeout=r,this.calloutTargetRef=s.createRef(),this._wasCalloutEverVisible=!1,this._isCalloutVisible=!1,this._shouldRenderTrustTeachingBubble=!1,this.dismissTrustTeachingBubble=function(){c._shouldRenderTrustTeachingBubble=!1},this.onDismiss=function(e){c.isCalloutVisible&&"blur"!==e.type&&c.closeMenu()},this.onButtonClick=function(){c.clientActionRecorder.recordAction(o.a.ButtonClicked,{Target:u.a.ShareButton}),c._isCalloutVisible?c.closeMenu():c.openMenu()},this.closeMenu=function(){c._isCalloutVisible=!1},this.showTrustTeachingBubble=function(){c._shouldRenderTrustTeachingBubble=!0},this.preloadSharingDialogIfNeeded=function(){c._wasCalloutEverVisible=!0},this.sharingFrameStore=e(this.closeMenu),this.setTimeout(this.preloadSharingDialogIfNeeded,a),i.settings.isPublishEntryPoint&&this.setTimeout(this.showTrustTeachingBubble,l)}return Object.defineProperty(e.prototype,"shouldRenderCallout",{get:function(){return this._wasCalloutEverVisible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isCalloutVisible",{get:function(){return this._isCalloutVisible},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"shouldRenderTrustTeachingBubble",{get:function(){return this._shouldRenderTrustTeachingBubble},enumerable:!0,configurable:!0}),e.prototype.openMenu=function(){this._isCalloutVisible=!0,this._wasCalloutEverVisible=!0,this.sharingFrameStore.trySetFocus()},__decorate([a.observable],e.prototype,"_wasCalloutEverVisible",void 0),__decorate([a.observable],e.prototype,"_isCalloutVisible",void 0),__decorate([a.observable],e.prototype,"_shouldRenderTrustTeachingBubble",void 0),__decorate([a.computed],e.prototype,"shouldRenderCallout",null),__decorate([a.computed],e.prototype,"isCalloutVisible",null),__decorate([a.computed],e.prototype,"shouldRenderTrustTeachingBubble",null),__decorate([a.action],e.prototype,"dismissTrustTeachingBubble",void 0),__decorate([a.action],e.prototype,"openMenu",null),__decorate([a.action],e.prototype,"closeMenu",void 0),__decorate([a.action],e.prototype,"showTrustTeachingBubble",void 0),__decorate([a.action],e.prototype,"preloadSharingDialogIfNeeded",void 0),e=__decorate([Object(i.injectable)(),__param(0,Object(i.inject)(c.a.SharingFrameStoreFactory)),__param(1,Object(i.inject)(r.a.ClientActionRecorder)),__param(2,Object(i.inject)(r.a.StyleProvider)),__param(3,Object(i.inject)(r.a.SetTimeout)),__param(4,Object(i.inject)(r.a.SiteSettingsStore)),__param(5,Object(i.inject)(c.a.SharePreloadDelaySec))],e)}()},306:
/*!*****************************************************************************************!*\
  !*** ./src/Consumption/Components/SiteComponents/Header/Buttons/FeedbackButtonStore.ts ***!
  \*****************************************************************************************/
/*! exports provided: FeedbackButtonStore */
/*! exports used: FeedbackButtonStore */function(e,t,n){"use strict";n.d(t,"a",function(){return u});var o=n(/*! inversify */2),r=n(/*! @sway/boot */289),i=n(/*! @sway/boot */17),a=n(/*! mobx */3),s=n(/*! mobx-safe */7),c=n(/*! ../../../ConsumptionSelectors */243),u=function(){function e(e,t){var n=this;this.styleProvider=e,this.clientActionRecorder=t,this._isFeedbackBubbleVisible=!1,this.setTarget=function(e){n.targetElement=e},this.setFeedbackBubbleHidden=function(){n.clientActionRecorder.recordAction(r.a.ButtonClicked,{Target:c.a.InternalFeedback}),n._isFeedbackBubbleVisible=!1},this.toggleFeedbackBubbleVisibility=function(){n.clientActionRecorder.recordAction(r.a.ButtonClicked,{Target:c.a.InternalFeedback}),n._isFeedbackBubbleVisible=!n._isFeedbackBubbleVisible}}return Object.defineProperty(e.prototype,"isFeedbackBubbleVisible",{get:function(){return this._isFeedbackBubbleVisible},enumerable:!0,configurable:!0}),__decorate([a.observable],e.prototype,"_isFeedbackBubbleVisible",void 0),__decorate([a.computed],e.prototype,"isFeedbackBubbleVisible",null),__decorate([s.action],e.prototype,"setFeedbackBubbleHidden",void 0),__decorate([s.action],e.prototype,"toggleFeedbackBubbleVisibility",void 0),e=__decorate([Object(o.injectable)(),__param(0,Object(o.inject)(i.a.StyleProvider)),__param(1,Object(o.inject)(i.a.ClientActionRecorder))],e)}()},307:
/*!**********************************************************************!*\
  !*** ./src/Consumption/Adapters/DocumentNavigationBundleImporter.ts ***!
  \**********************************************************************/
/*! exports provided: DocumentNavigationBundleImporter */
/*! exports used: DocumentNavigationBundleImporter */function(e,t,n){"use strict";n.d(t,"a",function(){return o});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var o=function(){return function(e){var t=this;this.swayBundleImporter=e,this.import=function(){return __awaiter(t,void 0,void 0,function(){var e=this;return __generator(this,function(t){return[2,this.swayBundleImporter.import("@sway/documentnavigation",function(){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return[2,Promise.all(/*! import() | Sway~DocumentNavigation */[n.e(9),n.e(4)]).then(n.bind(null,/*! @sway/documentnavigation */455))]})})})]})})}}}()},308:
/*!**********************************************************!*\
  !*** ./src/Consumption/Models/DocumentModelTraversal.ts ***!
  \**********************************************************/
/*! exports provided: findInLayoutSubtree */
/*! exports used: findInLayoutSubtree */function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(/*! @sway/documentmodel */69),r=function(e,t){if(e.id===t)return e;var n=o.layoutNodeChildChildKeys.get(e.type);if(void 0!==n)for(var i=0,a=n;i<a.length;i++){var s=a[i];if(void 0!==e[s])if(e[s]instanceof Array)for(var c=0,u=e[s];c<u.length;c++){var l,d=u[c];if(void 0!==(l=r(d,t)))return l}else if(void 0!==(l=r(e[s],t)))return l}}},45:
/*!*******************************************************!*\
  !*** ./src/Consumption/Synchronization/Monitoring.ts ***!
  \*******************************************************/
/*! exports provided: routeDetailsPropertyName, lastNotificationPropertyName, pollingForNotificationsPropertyName, observableUpdateType, monitorJoinSession */
/*! exports used: lastNotificationPropertyName, monitorJoinSession, observableUpdateType, pollingForNotificationsPropertyName, routeDetailsPropertyName */function(e,t,n){"use strict";n.d(t,"e",function(){return o}),n.d(t,"a",function(){return r}),n.d(t,"d",function(){return i}),n.d(t,"c",function(){return a}),n.d(t,"b",function(){return s});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var o="routeDetails",r="lastNotification",i="pollingForNotifications",a="update",s=function(e,t,n,o,r){return __awaiter(void 0,void 0,Promise,function(){return __generator(this,function(i){switch(i.label){case 0:return[4,e.untilActive(-1)];case 1:return i.sent(),o()&&(t.joinExpired&&r().catch(n.reportRejectedPromiseAndThrow()),s(e,t,n,o,r).catch(n.reportRejectedPromiseAndThrow())),[2]}})})}},46:
/*!*************************************************************************!*\
  !*** ./src/Consumption/Notification/Messages/MessageBusNotification.ts ***!
  \*************************************************************************/
/*! exports provided: MessageBusNotificationType */
/*! exports used: IAuthorListNotification, IMessageBusNotification, MessageBusNotificationType */function(e,t,n){"use strict";var o;n.d(t,"c",function(){return o}),function(e){e[e.Empty=0]="Empty",e[e.StoryModel=1]="StoryModel",e[e.SuggestedContent=2]="SuggestedContent",e[e.AuthorList=3]="AuthorList",e[e.AuthorPosition=4]="AuthorPosition",e[e.MediaProcessingProgress=5]="MediaProcessingProgress",e[e.MediaTransferProgress=6]="MediaTransferProgress"}(o||(o={}))},47:
/*!*************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/SelectionStore.ts ***!
  \*************************************************************************/
/*! exports provided: SelectionStore */
/*! exports used: ISelectionStore, SelectionStore */function(e,t,n){"use strict";n.d(t,"b",function(){return s});var o=n(/*! @sway/boot */61),r=n(/*! inversify */2),i=n(/*! mobx */3),a=n(/*! mobx-safe */7),s=function(){function e(e){var t=this;this._selectedModelIds=i.observable.array([]),this.clearSelection=function(){t.selectedModelIds.length=0},Object(i.observe)(e.routeDetails,"inAuthoring",this.clearSelection)}return e.prototype.selectElement=function(e){this.clearSelection(),this._selectedModelIds.push(e)},e.prototype.deselectElement=function(e){this._selectedModelIds.splice(this._selectedModelIds.indexOf(e.model.id),1)},e.prototype.isSelected=function(e){return this._selectedModelIds.indexOf(e.model.id)>=0},Object.defineProperty(e.prototype,"selectedModelIds",{get:function(){return this._selectedModelIds},enumerable:!0,configurable:!0}),__decorate([a.action],e.prototype,"clearSelection",void 0),__decorate([a.action],e.prototype,"selectElement",null),__decorate([a.action],e.prototype,"deselectElement",null),__decorate([i.computed],e.prototype,"selectedModelIds",null),e=__decorate([Object(r.injectable)(),__param(0,Object(r.inject)(o.a))],e)}()},489:
/*!*******************************************************!*\
  !*** ./src/Boot/Components/Accessibility/TabIndex.ts ***!
  \*******************************************************/
/*! exports provided: TabIndex */
/*! exports used: TabIndex */function(e,t,n){"use strict";
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var o;n.d(t,"a",function(){return o}),function(e){e[e.IncludeInTabLoop=0]="IncludeInTabLoop",e[e.ExcludeFromTabLoop=-1]="ExcludeFromTabLoop"}(o||(o={}))},490:
/*!*****************************************!*\
  !*** ./src/Boot/Utilities/Iteration.ts ***!
  \*****************************************/
/*! exports provided: mergeArrays, mergeMaps */
/*! exports used: mergeArrays, mergeMaps */function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var o=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=[],o=0,r=e;o<r.length;o++){var i=r[o];void 0!==i&&n.push.apply(n,i)}return n},r=function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];for(var n=new Map,o=0,r=e;o<r.length;o++){var i=r[o];void 0!==i&&i.forEach(function(e,t){n.set(t,e)})}return n}},491:
/*!****************************************!*\
  !*** ./src/Boot/Utilities/DeepCopy.ts ***!
  \****************************************/
/*! exports provided: deepCopy, deepCopyArray */
/*! exports used: deepCopy, deepCopyArray */function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var o=function(e){return JSON.parse(JSON.stringify(e))},r=function(e){return JSON.parse(JSON.stringify(e))}},50:
/*!*****************************************************************!*\
  !*** ./src/Consumption/Synchronization/DocumentSynchronizer.ts ***!
  \*****************************************************************/
/*! exports provided: fullDocumentContinuationToken, createDocumentModelDelta, DocumentSynchronizer */
/*! exports used: DocumentSynchronizer, IDocumentSynchronizer, createDocumentModelDelta, fullDocumentContinuationToken */function(e,t,n){"use strict";n.d(t,"d",function(){return m}),n.d(t,"c",function(){return g}),n.d(t,"a",function(){return b});var o=n(/*! @sway/boot */60),r=n(/*! @sway/boot */19),i=n(/*! @sway/boot */61),a=n(/*! @sway/boot */17),s=n(/*! @sway/boot */343),c=n(/*! inversify */2),u=n(/*! jsondiffpatch */268),l=n(/*! mobx */3),d=n(/*! ../Injection/ConsumptionInjectionTypes */15),p=n(/*! ../Models/DocumentModelStore */18),h=n(/*! ../Notification/Messages/MessageBusNotification */46),f=n(/*! ./Monitoring */45),m="full",g=function(e,t,n){var o;if(void 0!==t&&null!==t)o=(new u.a).diff(Object(l.toJS)(n),JSON.parse(t));else{if(void 0===e||null===e)return;o=JSON.parse(e)}return o},b=function(){function e(e,t,n,o,r,i,a,s,c,u,l){this.routerStore=e,this.logger=t,this.documentModelStore=n,this.messageBusNotificationClient=o,this.documentSyncApi=r,this.documentSettingsStore=i,this.documentModelVersion=a,this.syncStateStore=s,this.segmentFetcherProgress=c,this.activityMonitor=u,this.syncStateReporter=l,this.shouldIncreaseEditVersion=!0}return e.prototype.setupObservers=function(){return __awaiter(this,void 0,Promise,function(){var e,t=this;return __generator(this,function(n){switch(n.label){case 0:return[4,this.segmentFetcherProgress.allSegmentsDownloadedPromise];case 1:return n.sent(),Object(l.observe)(this.routerStore,f.e,function(e){return __awaiter(t,void 0,void 0,function(){return __generator(this,function(t){return[2,this.onRouteChange(e)]})})}),Object(l.observe)(this.messageBusNotificationClient,f.a,this.onNotificationReceived.bind(this)),e={object:this.routerStore.routeDetails,type:f.c,newValue:this.routerStore.routeDetails},[4,this.onRouteChange(e)];case 2:return n.sent(),[2]}})})},e.prototype.joinForConsumption=function(){return __awaiter(this,void 0,Promise,function(){var e,t,n=this;return __generator(this,function(i){switch(i.label){case 0:if(this.syncStateStore.joinedForConsumption)return[2];if(e=this.documentSettingsStore.settings,this.routerStore.routeDetails.pageMode!==o.a.Document)throw new Error("Can not join for consumption when not in document mode");return[4,this.documentSyncApi.joinForConsumption(this.routerStore.routeDetails.lookupId,m,e.accessibilityView)];case 1:return(t=i.sent()).isSuccess?(this.syncStateReporter.report("Listening for content changes",{logLevel:r.b.Info,messageTimeout:3e3}),this.syncStateStore.joinedForConsumption=!0,this.syncStateStore.joinExpired=!1,this.shouldIncreaseEditVersion&&(this.syncStateStore.editVersion=t.result.editVersion),this.syncStateStore.clientId=t.result.clientId,this.syncStateStore.editSessionToken=t.result.sessionToken,this.syncStateStore.subscription=t.result.subscriptionInfo,this.getAndApplyChanges(),Object(f.b)(this.activityMonitor,this.syncStateStore,this.syncStateReporter,function(){return n.syncStateStore.joinedForConsumption&&n.routerStore.routeDetails.pageMode===o.a.Document&&!n.routerStore.routeDetails.inAuthoring},function(){return __awaiter(n,void 0,void 0,function(){var e=this;return __generator(this,function(t){switch(t.label){case 0:return this.shouldIncreaseEditVersion=!1,this.leave(),[4,this.joinForConsumption().then(function(){return e.shouldIncreaseEditVersion=!0}).catch(this.syncStateReporter.reportRejectedPromiseAndThrow())];case 1:return t.sent(),[4,this.getAndApplyChanges({shouldLogWhenNoDelta:!1})];case 2:return t.sent(),[2]}})})}).catch(this.syncStateReporter.reportRejectedPromiseAndThrow()),[2]):(this.logger.logTag(595883797,r.b.Error,"Unable to join for consumption",{status:t.status,error:t.errorResponse,headers:t.headers}),[2])}})})},e.prototype.leave=function(){this.syncStateStore.joinedForConsumption=!1,this.syncStateStore.joinExpired=!1},e.prototype.onRouteChange=function(e){return __awaiter(this,void 0,Promise,function(){var t;return __generator(this,function(n){switch(n.label){case 0:return e.type!==f.c?[2]:(t=e.newValue).pageMode!==o.a.Document?[3,4]:t.inAuthoring?(this.leave(),[3,3]):[3,1];case 1:return[4,this.joinForConsumption()];case 2:n.sent(),n.label=3;case 3:return[3,5];case 4:this.leave(),n.label=5;case 5:return[2]}})})},e.prototype.onNotificationReceived=function(e){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(t){switch(t.label){case 0:return this.syncStateStore.joinedForConsumption?e.type!==f.c?[2]:e.newValue.type!==h.c.StoryModel?[3,2]:[4,this.getAndApplyChanges()]:[2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype.getAndApplyChanges=function(e){return void 0===e&&(e={shouldLogWhenNoDelta:!0}),__awaiter(this,void 0,Promise,function(){var t,n,i,a,s;return __generator(this,function(c){switch(c.label){case 0:if(!this.syncStateStore.joinedForConsumption)return[2];if(this.routerStore.routeDetails.pageMode!==o.a.Document)throw new Error("Can not sync layout changes when not in document mode");if(void 0===this.syncStateStore.editVersion)throw new Error("Can not sync layout; undefined baseline edit version");return t=this.documentSettingsStore.settings,n={accessibilityMode:t.accessibilityView,continuationToken:m,documentModelVersion:this.documentModelVersion,editVersion:this.syncStateStore.editVersion},[4,this.documentSyncApi.getChanges(this.routerStore.routeDetails.lookupId,n)];case 1:if(!(i=c.sent()).isSuccess)throw a="Unable to get the changes for the document",this.logger.logTag(595883798,r.b.Error,a,{status:i.status,error:i.errorResponse,headers:i.headers}),new Error(a);return void 0===(s=g(i.result.delta,i.result.documentModel,Object(l.toJS)(this.documentModelStore.model)))&&e.shouldLogWhenNoDelta?(this.logger.logTag(595935766,r.b.Warning,"No delta returned from get changes request"),[2]):(this.documentModelStore.patchDocumentModel(s),this.syncStateStore.editVersion=i.result.editVersion,[2])}})})},e=__decorate([Object(c.injectable)(),__param(0,Object(c.inject)(i.a)),__param(1,Object(c.inject)(r.c)),__param(2,Object(c.inject)(p.a)),__param(3,Object(c.inject)(d.a.MessageBusNotificationClient)),__param(4,Object(c.inject)(d.a.DocumentSyncApi)),__param(5,Object(c.inject)(d.a.DocumentSettingsStore)),__param(6,Object(c.inject)(a.a.DocumentModelVersion)),__param(7,Object(c.inject)(d.a.SyncStateStore)),__param(8,Object(c.inject)(d.a.DocumentSegmentFetcher)),__param(9,Object(c.inject)(s.a)),__param(10,Object(c.inject)(d.a.SyncStateReporter))],e)}()},51:
/*!************************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/ViewModelContextUtilities.ts ***!
  \************************************************************************************/
/*! exports provided: getContentParent, getContentGrandparent, isInteractableParagraph */
/*! exports used: getContentGrandparent, getContentParent, isInteractableParagraph */function(e,t,n){"use strict";n.d(t,"b",function(){return r}),n.d(t,"a",function(){return i}),n.d(t,"c",function(){return a});var o=n(/*! @sway/documentmodel */69),r=function(e){var t=e.model.contractRef,n=e.refResolvers.resolveContractRef;return n(n(t).parentId)},i=function(e){var t=e.model.contractRef,n=e.refResolvers.resolveContractRef;return n(n(n(t).parentId).parentId)},a=function(e){var t=i(e);return t.type===o.ContentNodeType.DocumentHeading||t.type===o.ContentNodeType.H1||t.type===o.ContentNodeType.H2}},52:
/*!***********************************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/DocumentBlock/LayoutViewModelFactory.ts ***!
  \***********************************************************************************************/
/*! exports provided: LayoutViewModelFactory */
/*! exports used: ILayoutViewModelFactory, LayoutViewModelFactory */function(e,t,n){"use strict";n.d(t,"b",function(){return a});var o=n(/*! @sway/boot */19),r=n(/*! inversify */2),i=n(/*! ../Unknown/UnknownViewModel */257),a=function(){function e(e,t,n){this.componentRegistry=e,this.logger=t,this.container=n}return e.prototype.constructViewModel=function(e,t,n,r){var a=this.componentRegistry.get(e.type);return void 0===a?(this.logger.logTag(595952796,o.b.Error,"Unable to find component for layout node",{id:e.id,type:e.type}),new i.a(e,this.container,t)):new a.viewModelClass(e,void 0,this.container,t,n,r)},e=__decorate([Object(r.injectable)()],e)}()},53:
/*!**********************************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/Paragraph/TextFormatter.ts + 1 modules ***!
  \**********************************************************************************************/
/*! exports provided: CombinedRunAttributes, TextFormatter */
/*! exports used: IResolvedTextRunWithChildren, IResolvedTextRunWithNoChildren, TextFormatter */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@sway/documentmodel/js/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/inversify/lib/inversify.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Logging/Logger.ts */function(e,t,n){"use strict";var o=n(19),r=n(69),i=n(2),a=function(e,t){return e in t?[e]:Object.keys(t).filter(function(e){return!isNaN(Number(e))}).map(Number).filter(function(t){return(e&t)===t})};n.d(t,"c",function(){return u});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var s,c=new Map([[r.RunAttributes.Bold,{fontWeight:"bold"}],[r.RunAttributes.Italic,{fontStyle:"italic"}],[r.RunAttributes.Underlined,{textDecoration:"underline"}],[r.RunAttributes.StrokeOut,{textDecoration:"line-through"}],[r.RunAttributes.Superscript,{verticalAlign:"super",fontSize:"80%"}],[r.RunAttributes.Subscript,{verticalAlign:"sub",fontSize:"80%"}],[r.RunAttributes.Underlined|r.RunAttributes.StrokeOut,{textDecoration:"underline line-through"}]]);!function(e){e[e.UnderlinedAndStrokeOut=r.RunAttributes.Underlined|r.RunAttributes.StrokeOut]="UnderlinedAndStrokeOut"}(s||(s={}));var u=function(){function e(e){this.logger=e}var t;return t=e,e.generateTextStylesMapping=function(e){var t=new Map;return c.forEach(function(n,o){var r=void 0!==e?e.get(o):void 0;t.set(o,void 0!==r?r:n)}),t},e.prototype.resolveTextRuns=function(e,t){if(void 0===t||0===t.length)return[{text:e}];for(var n=[],r=0,i=function(i){var s=void 0!==i.start?i.start:0;r<s&&0!==s&&n.push({text:e.substring(r,s)}),n.push(a.createResolvedTextRun(e,i)),r=s+i.length;var c=t.filter(function(e){var t=void 0!==e.start?e.start:0;return Math.max(s,t)<Math.min(r,t+e.length)}).filter(function(e){return e!==i});c.length>0&&a.logger.logTag(595964061,o.b.Warning,"Overlapping text runs found!",{textRun:i,overlappingTextRuns:c}),i===t[t.length-1]&&r!==e.length&&n.push({text:e.substring(r)})},a=this,s=0,c=t;s<c.length;s++){i(c[s])}return n},e.prototype.createResolvedTextRun=function(e,n){for(var i,a=[],s=0,c=t.resolveAllAttributeFlags(n.attributes);s<c.length;s++){var u=c[s];if(u!==r.RunAttributes.Default&&(a.push(u),u===r.RunAttributes.Link&&void 0!==n.relatedObjectUri&&(i=n.relatedObjectUri)),void 0!==n.children)return this.resolveTextRunWithChildren(e,n)}var l=e.substr(void 0!==n.start?n.start:0,n.length);return(n.attributes&(r.RunAttributes.Superscript|r.RunAttributes.Subscript))==(r.RunAttributes.Superscript|r.RunAttributes.Subscript)&&this.logger.logTag(596128132,o.b.Warning,"both superscript and subscript styles applied",{text:l}),{text:l,attributes:a,href:i}},e.resolveAllAttributeFlags=function(e){return a(e,r.RunAttributes).concat(a(e,s))},e.prototype.resolveTextRunWithChildren=function(e,t){var n=void 0!==t.start?t.start:0,o=e.substr(n,t.length),r=void 0!==t.children?t.children.map(function(e){return __assign({},e,{start:(void 0!==e.start?e.start:0)-n})}):[],i=this.resolveTextRuns(o,r);return{href:t.relatedObjectUri,children:i}},e=t=__decorate([Object(i.injectable)(),__param(0,Object(i.inject)(o.c))],e)}()},74:
/*!****************************************************!*\
  !*** ./src/Consumption/Utilities/TextDirection.ts ***!
  \****************************************************/
/*! exports provided: directionToDirAttribute */
/*! exports used: directionToDirAttribute */function(e,t,n){"use strict";n.d(t,"a",function(){return r});var o=n(/*! @sway/documentmodel */69),r=function(e){return e===o.TextDirection.LeftToRight?"ltr":e===o.TextDirection.RightToLeft?"rtl":void 0}},78:
/*!**********************************************!*\
  !*** ./src/Consumption/Utilities/DomRect.ts ***!
  \**********************************************/
/*! exports provided: viewportToDomRect, growDomRectByMargin, pointInBox, doDomRectsIntersect */
/*! exports used: doDomRectsIntersect, growDomRectByMargin, viewportToDomRect */function(e,t,n){"use strict";n.d(t,"c",function(){return o}),n.d(t,"b",function(){return r}),n.d(t,"a",function(){return a});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var o=function(e){var t=e.getScroll(),n=void 0===e.size?{height:0,width:0}:e.size;return{x:t.left,y:t.top,height:n.height,width:n.width,left:t.left,top:t.top,right:t.left+n.width,bottom:t.top+n.height}},r=function(e,t){var n=e.width*t/100,o=e.height*t/100,r=e.x-n,i=e.y-o,a=e.height+2*o,s=e.width+2*n;return{x:r,y:i,height:a,width:s,left:r,right:r+s,top:i,bottom:i+a}},i=function(e,t,n){return e>=n.left&&e<=n.right&&t>=n.top&&t<=n.bottom},a=function(e,t){return i(e.left,e.top,t)||i(e.right,e.top,t)||i(e.left,e.bottom,t)||i(e.right,e.bottom,t)}},79:
/*!******************************************************************************!*\
  !*** ./src/Consumption/Components/SiteComponents/Header/RightHeaderStore.ts ***!
  \******************************************************************************/
/*! exports provided: RightHeaderStore */
/*! exports used: RightHeaderStore */function(e,t,n){"use strict";n.d(t,"a",function(){return C});var o=n(/*! @sway/boot */60),r=n(/*! @sway/boot */19),i=n(/*! @sway/boot */54),a=n(/*! @sway/boot */289),s=n(/*! @sway/boot */17),c=n(/*! @sway/boot */286),u=n(/*! @sway/boot */61),l=n(/*! @sway/internalapi */5),d=n(/*! inversify */2),p=n(/*! mobx */3),h=n(/*! ../../../Adapters/DevToolsBundleImporter */263),f=n(/*! ../../../Injection/ConsumptionInjectionTypes */15),m=n(/*! ../../../Localization/ConsumptionUIStrings */20),g=n(/*! ../../ConsumptionSelectors */243),b=n(/*! ../../DocumentComponents/SelectionStore */47),y=n(/*! ../../Sharing/SharingMenuStore */305),v=n(/*! ../Navigation/DocumentNavigationLauncherStore */29),_=n(/*! ./Buttons/FeedbackButtonStore */306),S=n(/*! ./CogWheelMenuStore */303),w=n(/*! ./RightHeader */80),C=function(){function e(e,t,n,o,r,i,a,s,c,u,l,d,p,h,f){this.cogWheelMenuStore=e,this.sharingMenuStore=t,this.feedbackButtonStore=n,this.devToolsBundleImporter=o,this.documentSettingsStore=r,this.clientActionRecorder=i,this.featureGates=a,this.documentNavigationLauncherStore=s,this.routerStore=c,this.userSettingsStore=u,this.siteSettingsStore=l,this.openWindow=d,this.selectionStore=p,this.urlHelper=h,this.logger=f}return Object.defineProperty(e.prototype,"menuItems",{get:function(){return[this.buttonEnterExitAuthoring,this.buttonEditInV1,this.buttonNavigation,this.buttonShare,this.buttonOpenDevtools,this.buttonInternalFeedback,this.buttonSettingsCogWheel].filter(function(e){return void 0!==e})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"overflowMenuItems",{get:function(){return[this.buttonMySways,this.buttonReportAViolation,this.buttonSignInOrSignOut].filter(function(e){return void 0!==e})},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonEditInV1",{get:function(){var e=this;if(this.documentSettingsStore.settings.canEdit){var t=this.featureGates.isEnabled(l.FeatureGates.OnCanvasAuthoring);if(!t||this.featureGates.isEnabled(l.FeatureGates.DualEdit)&&this.inAuthoring){var n=t?m.a.EditInStoryline:m.a.Edit,i=t?m.a.EditInStorylineLabel:m.a.EditLabel;return{key:g.a.EditInV1,iconProps:{iconName:m.a.Edit},onClick:function(){if(e.routerStore.routeDetails.pageMode===o.a.Document){var t=e.routerStore.routeDetails.lookupId;e.recordButtonClickAction(g.a.EditInV1),e.logger.logTag(595911778,r.b.Info,"Assigning location to v1 document",{lookupId:t}),e.routerStore.goToUrl(e.urlHelper.v1DocumentUrl(t))}},text:n,ariaLabel:i,title:i}}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonEnterExitAuthoring",{get:function(){var e=this;if(this.documentSettingsStore.settings.canEdit&&this.featureGates.isEnabled(l.FeatureGates.OnCanvasAuthoring)){var t=this.routerStore.routeDetails;return{key:g.a.EnterExitAuthoring,iconProps:{iconName:t.inAuthoring?m.a.Play:m.a.Edit},onClick:function(){e.recordButtonClickAction(g.a.EnterExitAuthoring),e.selectionStore.clearSelection(),e.routerStore.goToRoute(__assign({},t,{inAuthoring:!e.inAuthoring}))},text:t.inAuthoring?m.a.Play:m.a.Edit,ariaLabel:t.inAuthoring?m.a.Play:m.a.EditLabel,title:t.inAuthoring?m.a.Play:m.a.EditLabel}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonNavigation",{get:function(){var e=this;if(this.featureGates.isEnabled(l.FeatureGates.DocumentNavigation))return{key:g.a.NavigationButton,onClick:function(){e.recordButtonClickAction("item-navigation")},render:function(t){return Object(w.e)(t,e.documentNavigationLauncherStore)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonShare",{get:function(){var e=this;if(this.featureGates.isEnabled(l.FeatureGates.ShareMenu)&&!this.documentSettingsStore.settings.blockSharing)return{key:g.a.ShareMenu,onClick:function(){e.recordButtonClickAction("item-share")},render:function(t){return Object(w.f)(t,e.sharingMenuStore)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonOpenDevtools",{get:function(){this.featureGates.isEnabled(l.FeatureGates.DeveloperTools)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonSettingsCogWheel",{get:function(){var e=this;return{key:g.a.CogWheelMenuButton,onClick:function(){e.recordButtonClickAction("item-cogwheel")},render:function(t,n){return Object(w.b)(t,e.cogWheelMenuStore,n)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonInternalFeedback",{get:function(){var e=this;if(this.featureGates.isEnabled(l.FeatureGates.GiveFeedback))return{key:g.a.InternalFeedback,render:function(t){return Object(w.d)(t,e.feedbackButtonStore)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonMySways",{get:function(){var e=this;return{key:"item-mysways",name:i.a.MySways,onClick:function(){return __awaiter(e,void 0,void 0,function(){var e,t;return __generator(this,function(n){switch(n.label){case 0:return this.recordButtonClickAction("item-mysways"),t=(e=this.routerStore).goToMySways,[4,this.urlHelper.mySwaysUrl()];case 1:return t.apply(e,[n.sent()]),[2]}})})}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonSignInOrSignOut",{get:function(){var e=this;return this.userSettingsStore.settings.authentication===l.AuthenticationType.Anonymous?{key:"item-signin",name:i.a.SignInButton,onClick:function(){e.recordButtonClickAction("item-signin"),e.logger.logTag(595911779,r.b.Info,"Assigning location to sign in"),e.routerStore.goToUrl(e.urlHelper.signInUrl())}}:{key:"item-signout",name:i.a.SignOutButton,onClick:function(){e.recordButtonClickAction("item-signout"),e.logger.logTag(595911808,r.b.Info,"Assigning location to sign out"),e.routerStore.goToUrl(e.urlHelper.signOutUrl())}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"buttonReportAViolation",{get:function(){var e=this;return{key:"item-reportviolation",name:m.a.ReportViolationButton,onClick:function(){if(e.recordButtonClickAction("item-reportviolation"),e.routerStore.routeDetails.pageMode!==o.a.Document)throw new Error("Tried to report a violation from a non-Document page");var t=e.routerStore.routeDetails.lookupId,n=e.siteSettingsStore.settings.sessionId;e.openWindow("/s/"+t+"/reportviolation?sessionId="+n)}}},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"inAuthoring",{get:function(){return!!this.routerStore.routeDetails.inAuthoring},enumerable:!0,configurable:!0}),e.prototype.recordButtonClickAction=function(e){this.clientActionRecorder.recordAction(a.a.ButtonClicked,{Target:e})},__decorate([p.computed],e.prototype,"menuItems",null),__decorate([p.computed],e.prototype,"overflowMenuItems",null),__decorate([p.computed],e.prototype,"buttonEditInV1",null),__decorate([p.computed],e.prototype,"buttonEnterExitAuthoring",null),__decorate([p.computed],e.prototype,"buttonNavigation",null),__decorate([p.computed],e.prototype,"buttonSignInOrSignOut",null),__decorate([p.computed],e.prototype,"inAuthoring",null),e=__decorate([Object(d.injectable)(),__param(0,Object(d.inject)(S.a)),__param(1,Object(d.inject)(y.a)),__param(2,Object(d.inject)(_.a)),__param(3,Object(d.inject)(h.a)),__param(4,Object(d.inject)(f.a.DocumentSettingsStore)),__param(5,Object(d.inject)(s.a.ClientActionRecorder)),__param(6,Object(d.inject)(c.a)),__param(7,Object(d.inject)(v.a)),__param(8,Object(d.inject)(u.a)),__param(9,Object(d.inject)(s.a.UserSettingsStore)),__param(10,Object(d.inject)(s.a.SiteSettingsStore)),__param(11,Object(d.inject)(s.a.OpenWindow)),__param(12,Object(d.inject)(b.b)),__param(13,Object(d.inject)(s.a.UrlHelper)),__param(14,Object(d.inject)(r.c))],e)}()},8:
/*!********************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/BaseDocumentViewModel.ts ***!
  \********************************************************************************/
/*! exports provided: AuthoringViewModelType, BaseDocumentViewModel */
/*! exports used: AuthoringViewModelType, BaseDocumentViewModel, IAuthoringViewModel, IAuthoringViewModelClass, IDocumentViewModel, IDocumentViewModelClass, IViewModelProps */function(e,t,n){"use strict";n.d(t,"a",function(){return o}),n.d(t,"b",function(){return h});var o,r=n(/*! @sway/boot */17),i=n(/*! @sway/documentmodel */69),a=n(/*! mobx */3),s=n(/*! mobx-safe */7),c=n(/*! ../../Injection/ConsumptionInjectionTypes */15),u=n(/*! ../Settings/AnimationsEnabledStore */251),l=n(/*! ./Animations/AnimationStore */301),d=n(/*! ./SelectionStore */47),p=n(/*! ./VisibleComponentTracker */254);!function(e){e.MediaEdit="MediaEdit",e.TextEdit="TextEdit",e.HeadingEdit="HeadingEdit",e.ParagraphPlaceholder="ParagraphPlaceholder",e.DocumentHeadingPlaceholder="DocumentHeadingPlaceholder",e.Stub="Stub"}(o||(o={}));var h=function(){function e(e,t,n,o,a,s,h){void 0===h&&(h=i.AnimationElement.Self);var f=this;this.model=e,this.decoratorState=t,this.refResolvers=o,this.viewModelProps=a,this.childViewModelFactory=s,this._inView=!1,this.onViewportIntersectionChange=function(e){f._inView=e,f.visibleComponentsTrackerUpdater.setVisibility(e,f)},this.selectionStore=n.get(d.b),this.styleProvider=n.get(r.a.StyleProvider);var m=n.get(u.a),g=n.get(c.a.TransitionAnimator),b=n.get(c.a.KeyframeAnimator);this.intersectionObserver=n.get(r.a.IntersectionObserver),this.animationStore=new l.a(this,this.refResolvers.resolveAnimationRefs,this.refResolvers.resolveAnimationSequenceRefs,this.styleProvider,this.intersectionObserver,m,g,b,h,n.get(r.a.Viewport)),this.visibleComponentsTrackerUpdater=n.get(p.b)}return Object.defineProperty(e.prototype,"type",{get:function(){return this.model.type},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"key",{get:function(){return void 0===this.decoratorState?this.model.id:this.model.id+">"+this.decoratorState.model.id},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"animationSequenceRefs",{get:function(){return this.model.animSequenceRefs},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"computedStyle",{get:function(){return void 0===this.model.computedStyleRefs?{}:this.refResolvers.resolveComputedStyleRefs(this.model.computedStyleRefs)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"normalSize",{get:function(){return void 0===this.model.normalizedSize?1:this.model.normalizedSize},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"style",{get:function(){return void 0===this.model.styleRefs?{}:this.refResolvers.resolveStyleRefs(this.model.styleRefs)},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"isLoading",{get:function(){return void 0!==this.model.isLoading&&this.model.isLoading},enumerable:!0,configurable:!0}),e.prototype.createChild=function(e,t){if(void 0!==e)return this.childViewModelFactory.create({modelOrLeaf:e,refResolvers:this.refResolvers,viewModelProps:t,decoratorState:this.decoratorState})},e.prototype.createChildren=function(e,t){return this.childViewModelFactory.createMany(e,this.refResolvers,t,this.decoratorState)},Object.defineProperty(e.prototype,"inView",{get:function(){return this._inView},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"content",{get:function(){return this.refResolvers.resolveContractRef(this.model.contractRef)},enumerable:!0,configurable:!0}),__decorate([a.observable],e.prototype,"_inView",void 0),__decorate([a.computed],e.prototype,"type",null),__decorate([a.computed],e.prototype,"key",null),__decorate([a.computed],e.prototype,"animationSequenceRefs",null),__decorate([a.computed],e.prototype,"computedStyle",null),__decorate([a.computed],e.prototype,"normalSize",null),__decorate([a.computed],e.prototype,"style",null),__decorate([a.computed],e.prototype,"isLoading",null),__decorate([a.computed],e.prototype,"inView",null),__decorate([a.computed],e.prototype,"content",null),__decorate([s.action],e.prototype,"onViewportIntersectionChange",void 0),e}()},80:
/*!**************************************************************************************!*\
  !*** ./src/Consumption/Components/SiteComponents/Header/RightHeader.tsx + 8 modules ***!
  \**************************************************************************************/
/*! exports provided: renderCogWheelMenu, renderSharingMenu, renderDevToolsButton, renderNavigationButton, renderInternalFeedbackButton, RightHeader */
/*! exports used: RightHeader, renderCogWheelMenu, renderDevToolsButton, renderInternalFeedbackButton, renderNavigationButton, renderSharingMenu */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/aria-roles/aria-roles.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/mobx-react/index.module.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/common/DirectionalHint.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Button/ActionButton/ActionButton.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Callout/Callout.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/FocusZone/FocusZone.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/FocusZone/FocusZone.types.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/OverflowSet/OverflowSet.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Spinner/Spinner.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Spinner/Spinner.types.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/TeachingBubble/TeachingBubble.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Toggle/Toggle.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/react/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Bundles/SwayUiBundle.tsx */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Localization/BootUiStrings.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Utilities/NamedObserver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/ConsumptionSelectors.ts because of ./src/Consumption/index.tsx */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Localization/ConsumptionUIStrings.ts because of ./src/Consumption/index.tsx */function(e,t,n){"use strict";var o=n(355),r=n(44),i=n(336),a=n(459),s=n(0),c=n(20),u=n(243),l=n(58),d=n(13),p=n(500),h=n(90),f=n(483),m=n(352),g=n(461),b=n(73),y=function(e){return{width:e+"px",display:"block",fontSize:0}},v=function(e,t){return{border:"none",width:"100%",visibility:e?void 0:"hidden",height:e?t+"px":"0px"}},_={alignItems:"center",display:"flex",height:"180px",justifyContent:"center"},S=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.componentDidMount=function(){this.props.store.onMount()},t.prototype.componentWillUnmount=function(){this.props.store.onUnmount()},t.prototype.render=function(){return void 0!==this.props.store.errorMessage?s.createElement("div",{className:this.props.store.styleProvider.css(y)},this.props.store.errorMessage):s.createElement("div",{className:this.props.store.styleProvider.css(y(this.props.store.width))},this.props.store.ready?null:s.createElement("div",{className:this.props.store.styleProvider.css(_)},s.createElement(g.a,{size:b.a.large}),s.createElement("span",{tabIndex:0,"aria-busy":!0,role:l.Roles.Alert,"aria-label":c.a.DialogLoadingAriaLabel,"aria-live":"polite"})),s.createElement("iframe",{src:this.props.store.sharePageUrl,ref:this.props.store.iframeRef,id:u.a.ShareMenuIframe,sandbox:"allow-same-origin allow-scripts allow-popups",className:this.props.store.styleProvider.css(v(this.props.store.ready,this.props.store.height)),"aria-label":c.a.ShareMenuAriaLabel}))},t=__decorate([d.a],t)}(s.Component),w=n(54),C=n(498),j=function(e){return{animationName:e.keyframes("SlideIn10",{from:{transform:"translate3d(0,-10px,0)",opacity:0},to:{transform:"translate3d(0,0,0)",opacity:1}}),animationDuration:"0.367s",animationTimingFunction:"cubic-bezier(.1,.9,.2,1)",animationFillMode:"both","& .ms-TeachingBubble-content":{animationName:"none"}}},M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){return this.props.isVisible&&null!==this.props.target?s.createElement(C.a,{calloutProps:{directionalHint:h.a.bottomAutoEdge,className:this.props.styleProvider.css(j(this.props.styleProvider))},targetElement:this.props.target,onDismiss:this.props.onDismiss,hasCloseIcon:!0,closeButtonAriaLabel:w.a.CloseButtonAriaLabel,hasCondensedHeadline:!0,headline:c.a.ShareTrustBubbleTitle},c.a.ShareTrustBubbleMessage):null},t}(s.Component),R=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.render=function(){var e=null;return this.props.store.shouldRenderCallout&&(e=s.createElement(p.a,{role:l.Roles.AlertDialog,gapSpace:0,directionalHint:h.a.bottomRightEdge,isBeakVisible:!1,target:this.props.store.calloutTargetRef.current,onDismiss:this.props.store.onDismiss,setInitialFocus:!0,className:this.props.store.styleProvider.css(function(e){return e?{}:{visibility:"hidden"}}(this.props.store.isCalloutVisible))},s.createElement(f.a,{handleTabKey:m.b.all,isCircularNavigation:!0},s.createElement(S,{store:this.props.store.sharingFrameStore})))),s.createElement(s.Fragment,null,s.createElement("div",{ref:this.props.store.calloutTargetRef},s.createElement(i.a,{id:u.a.ShareButton,iconProps:{iconName:"Share"},onClick:this.props.store.onButtonClick,text:c.a.ShareButton,ariaLabel:c.a.ShareButtonLabel,title:c.a.ShareButtonLabel,styles:this.props.buttonStyles})),e,s.createElement(M,{isVisible:this.props.store.shouldRenderTrustTeachingBubble,onDismiss:this.props.store.dismissTrustTeachingBubble,target:this.props.store.calloutTargetRef.current,styleProvider:this.props.store.styleProvider}))},t=__decorate([d.a],t)}(s.Component),O="SwayLV2feedback@microsoft.com",T={color:"inherit"},A=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderFeedbackBubble=function(){return t.props.store.isFeedbackBubbleVisible?s.createElement(C.a,{calloutProps:{directionalHint:h.a.bottomAutoEdge,className:t.props.store.styleProvider.css(j(t.props.store.styleProvider))},targetElement:t.props.store.targetElement,hasCondensedHeadline:!0,onDismiss:t.props.store.setFeedbackBubbleHidden,hasCloseIcon:!0,closeButtonAriaLabel:w.a.CloseButtonAriaLabel,headline:c.a.FeedbackBubbleHeadline},c.a.FeedbackBubbleBody,s.createElement("a",{href:"mailto:"+O,className:t.props.store.styleProvider.css(T)},O),"."):null},t}return __extends(t,e),t.prototype.render=function(){return s.createElement("div",{ref:this.props.store.setTarget},s.createElement(i.a,{styles:this.props.buttonStyles,iconProps:{iconName:"Feedback"},title:c.a.GiveUsFeedback,onClick:this.props.store.toggleFeedbackBubbleVisibility,ariaLabel:c.a.FeedbackButtonAriaLabel}),this.renderFeedbackBubble())},t=__decorate([d.a],t)}(s.Component),P=Object(r.a)("DocumentNavigationLauncher",function(e){var t=e.store;return void 0===t.launchStatus.contents?null:t.launchStatus.contents.view}),E=Object(r.a)("NavigationButton",function(e){var t=e.buttonStyles,n=e.store;return s.createElement(s.Fragment,null,s.createElement(i.a,{disabled:void 0===n.launchStatus.contents,className:u.a.NavigationButton,iconProps:{iconName:"GlobalNavButton"},key:u.a.NavigationButton,onClick:n.requestOpen,text:c.a.NavigationButton,title:c.a.NavigationButtonTooltip,ariaLabel:c.a.NavigationButtonAriaLabel,styles:t}),s.createElement(P,{store:n}))}),I=n(506),x=function(e){return{root:{display:"flex",alignItems:"center",width:"250px",paddingTop:"5px",paddingBottom:"5px",paddingLeft:"5px"},container:{},label:{display:"flex",alignItems:"center",padding:"0px 5px",height:"40px",width:"65%"},pill:{background:e?"#242424":"inherit",selectors:{":hover":{borderColor:"#008272",background:e?"#008272":"inherit"}}},thumb:{selectors:{":hover":{background:e?"white":"#008272"}}},text:{}}},V=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return t.renderCalloutContent=function(){return s.createElement(s.Fragment,null,s.createElement(I.a,{checked:t.props.store.isAccessibilityViewEnabled,label:c.a.AccessibilityViewLabel,onText:c.a.On,offText:c.a.Off,onChange:t.props.store.accessibilityViewToggleClickHandler,styles:x(t.props.store.isAccessibilityViewEnabled)}),s.createElement(I.a,{checked:t.props.store.isAnimationsEnabled,disabled:t.props.store.isAnimationsToggleDisabled,label:c.a.AnimationsLabel,onText:c.a.On,offText:c.a.Off,onChange:t.props.store.animationsToggleClickHandler,styles:x(t.props.store.isAnimationsEnabled)}))},t}return __extends(t,e),t.prototype.render=function(){return s.createElement(s.Fragment,null,s.createElement("div",{ref:this.props.store.calloutStore.setTarget},s.createElement(i.a,{styles:this.props.buttonStyles,iconProps:{iconName:"Settings"},id:"cog-wheel-menu-button",onClick:this.props.store.cogWheelMenuClickHandler,ariaLabel:c.a.SettingsMenuButtonLabel,title:c.a.SettingsMenuButtonTitle})),this.props.store.calloutStore.renderCallout(this.renderCalloutContent,u.a.CogWheelMenu,this.props.isRtl))},t=__decorate([d.a],t)}(s.Component);n.d(t,"b",function(){return k}),n.d(t,"f",function(){return D}),n.d(t,"c",function(){return F}),n.d(t,"e",function(){return L}),n.d(t,"d",function(){return N}),n.d(t,"a",function(){return H});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var k=function(e,t,n){return s.createElement(V,{buttonStyles:e,store:t,isRtl:n})},D=function(e,t){return s.createElement(R,{buttonStyles:e,store:t})},F=function(e){return s.createElement(o.a,{content:e})},L=function(e,t){return s.createElement(E,{buttonStyles:e,store:t})},N=function(e,t){return s.createElement(A,{buttonStyles:e,store:t})},B={overflowButton:{selectors:{"& i":{fontSize:"16px",color:"inherit",fontWeight:"inherit"}}}},H=Object(r.a)("RightHeader",function(e){var t=e.buttonStyles,n=e.store,o=e.isRtl;return s.createElement(a.a,{className:u.a.RightHeader,items:n.menuItems,onRenderItem:function(e){return void 0!==e.render?e.render(t,o):s.createElement(i.a,__assign({styles:t,id:e.key},e))},overflowItems:n.overflowMenuItems,onRenderOverflowButton:function(e){return s.createElement(i.a,{id:u.a.OverflowMenuButton,styles:t,menuIconProps:{iconName:"More"},menuProps:{items:e},ariaLabel:c.a.OverflowMenuButtonLabel,title:c.a.OverflowMenuButtonTitle})},doNotContainWithinFocusZone:!0,styles:B})})},87:
/*!*************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/H1/H1ViewModel.ts ***!
  \*************************************************************************/
/*! exports provided: H1ViewModel */
/*! exports used: H1ViewModel */function(e,t,n){"use strict";n.d(t,"a",function(){return a});var o=n(/*! mobx */3),r=n(/*! ../../Referencing/ViewReferenceCache */26),i={ariaLevel:2},a=function(e){function t(t,n,o,i,a,s){var c=e.call(this,t,n,o,i,a,s)||this;return c.viewReferenceCache=o.get(r.c),c}return __extends(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.createChild(this.model.title,i)},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"background",{get:function(){return this.createChild(this.model.background)},enumerable:!0,configurable:!0}),__decorate([o.computed],t.prototype,"title",null),__decorate([o.computed],t.prototype,"background",null),t}(n(/*! ../BaseDocumentViewModel */8).b)},88:
/*!*************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/H2/H2ViewModel.ts ***!
  \*************************************************************************/
/*! exports provided: H2ViewModel */
/*! exports used: H2ViewModel */function(e,t,n){"use strict";n.d(t,"a",function(){return a});var o=n(/*! mobx */3),r=n(/*! ../../Referencing/ViewReferenceCache */26),i={ariaLevel:3},a=function(e){function t(t,n,o,i,a,s){var c=e.call(this,t,n,o,i,a,s)||this;return c.viewReferenceCache=o.get(r.c),c}return __extends(t,e),Object.defineProperty(t.prototype,"title",{get:function(){return this.createChild(this.model.title,i)},enumerable:!0,configurable:!0}),__decorate([o.computed],t.prototype,"title",null),t}(n(/*! ../BaseDocumentViewModel */8).b)},89:
/*!***************************************************************************************!*\
  !*** ./src/Consumption/Components/DocumentComponents/Paragraph/ParagraphViewModel.ts ***!
  \***************************************************************************************/
/*! exports provided: ParagraphViewModel */
/*! exports used: ParagraphViewModel */function(e,t,n){"use strict";n.d(t,"a",function(){return S});var o=n(/*! @sway/boot */347),r=n(/*! @sway/boot */76),i=n(/*! @sway/boot */17),a=n(/*! @sway/boot */61),s=n(/*! @sway/documentmodel */69),c=n(/*! aria-roles */58),u=n(/*! mobx */3),l=n(/*! mobx-safe */7),d=n(/*! ../../../Injection/ConsumptionInjectionTypes */15),p=n(/*! ../../Referencing/ViewReferenceCache */26),h=n(/*! ../../Settings/AnimationsEnabledStore */251),f=n(/*! ../Animations/AnimationStore */301),m=n(/*! ../BaseDocumentViewModel */8),g=n(/*! ../FocusStyleResolver */250),b=n(/*! ../SelectionStyleResolver */249),y=n(/*! ../ViewModelContextUtilities */51),v=n(/*! ./TextFormatter */53),_=n(/*! ./TextRunStore */270),S=function(e){function t(t,n,c,u,l,m){var y=e.call(this,t,n,c,u,l,m,s.AnimationElement.WrapperSpans)||this;return y.defaultStyles={marginTop:0,outline:"none",wordWrap:"break-word"},y.onMouseUp=function(){y.activate()},y.onKeyUp=function(e){e.key!==o.a.Space&&e.key!==o.a.LegacySpace||(e.preventDefault(),y.eventSubmitter.emit(r.a.TextPress),y.activate()),e.key===o.a.Enter&&(y.eventSubmitter.emit(r.a.TextPress),y.activate())},y.styleProvider=c.get(i.a.StyleProvider),y.textFormatter=c.get(v.c),y.viewReferenceCache=c.get(p.c),y._animationsEnabledStore=c.get(h.a),y._transitionAnimator=c.get(d.a.TransitionAnimator),y._keyframeAnimator=c.get(d.a.KeyframeAnimator),y.eventSubmitter=c.get(i.a.EventSubmitter),y.selectionStyleResolver=c.get(b.b),y.focusStyleResolver=c.get(g.a),y._routerStore=c.get(a.a),y._textRunAnimationStore=new f.a(y,y.refResolvers.resolveAnimationRefs,y.refResolvers.resolveAnimationSequenceRefs,y.styleProvider,y.intersectionObserver,y._animationsEnabledStore,y._transitionAnimator,y._keyframeAnimator,s.AnimationElement.TextSpans,c.get(i.a.Viewport)),y.focusHolder=c.get(d.a.FocusHolder),y}return __extends(t,e),t.prototype.isEditableText=function(){return Object(y.a)(this).type===s.ContentNodeType.DocumentHeading},Object.defineProperty(t.prototype,"role",{get:function(){return this._routerStore.routeDetails.inAuthoring&&this.isEditableText()?c.Roles.Textbox:void 0===this.viewModelProps.ariaLevel?void 0:c.Roles.Heading},enumerable:!0,configurable:!0}),t.prototype.activate=function(){this.selectionStore.isSelected(this)?this.selectionStore.deselectElement(this):this.selectionStore.selectElement(this.model.id)},Object.defineProperty(t.prototype,"formatSpanStyles",{get:function(){var e=new Map;return void 0!==this.model.emphasisStyleRefs&&e.set(s.RunAttributes.Bold,this.refResolvers.resolveStyleRefs(this.model.emphasisStyleRefs)),void 0!==this.model.accentStyleRefs&&e.set(s.RunAttributes.Italic,this.refResolvers.resolveStyleRefs(this.model.accentStyleRefs)),e},enumerable:!0,configurable:!0}),Object.defineProperty(t.prototype,"textRuns",{get:function(){var e=this,t=this.textFormatter.resolveTextRuns(this.content.text,this.content.runs),n=v.c.generateTextStylesMapping(this.formatSpanStyles);return t.map(function(t){return new _.a(e.styleProvider,n,t,e._textRunAnimationStore)})},enumerable:!0,configurable:!0}),t.prototype.getParagraphElementRef=function(){var e=this.viewReferenceCache.getPendingRef(this.content.id);return void 0!==e?e.element.get():void 0},Object.defineProperty(t.prototype,"className",{get:function(){return this.styleProvider.css(this.defaultStyles,this.style,this.selectionStyleResolver.getSelectableStyle(this),this.selectionStyleResolver.getSelectionStyle(this),this.focusStyleResolver.getFocusStyle(this))},enumerable:!0,configurable:!0}),__decorate([u.computed],t.prototype,"role",null),__decorate([l.action],t.prototype,"activate",null),__decorate([u.computed],t.prototype,"formatSpanStyles",null),__decorate([u.computed],t.prototype,"textRuns",null),__decorate([u.computed],t.prototype,"className",null),t}(m.b)},9:
/*!*************************************************************!*\
  !*** ./src/Consumption/Components/ConsumptionAttributes.ts ***!
  \*************************************************************/
/*! exports provided: ConsumptionAttributes */
/*! exports used: ConsumptionAttributes */function(e,t,n){"use strict";n.d(t,"a",function(){return o});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var o={Animation:"animation",BackgroundImage:"background-image",BlockText:"blocktext",BorderContainer:"border-container",Ornament:"ornament",OrnamentContainer:"ornament-container",CaptionedContentCaption:"captioned-content-caption",CaptionedContent:"captioned-content",Cell:"cell",Code:"code",Comparison:"comparison",DocumentHeading:"document-heading",FlowBody:"flow-body",FlowDoc:"flow-doc",H1:"h1",H1Container:"h1-container",H2:"h2",Image:"image",ImageWrapper:"image-wrapper",LiquidLayout:"liquid-layout",MediaAndTextContainer:"media-and-text-container",MediaAndTextMedia:"media-and-text-media",Paragraph:"paragraph",Row:"row",Slideshow:"slideshow",Stack:"stack",StyleWrapper:"stylewrapper",Table:"table",Text:"text",TextList:"text-list",TextRun:"text-run",TextWrapperSpan:"text-wrapper-span",UniformGridChild:"uniform-grid-child",UniformGridContainer:"uniform-grid-container",Unknown:"unknown",Unpopulated:"unpopulated",Video:"video"}}}]);
if (typeof performance !== "undefined" && performance.mark) performance.mark("MeasureParseTime::end::Sway~Consumption.chunk.js");//# sourceMappingURL=Sway~Consumption.chunk.js.map