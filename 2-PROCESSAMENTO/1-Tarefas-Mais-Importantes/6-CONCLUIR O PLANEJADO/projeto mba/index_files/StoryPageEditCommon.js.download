var __extends=this&&this.__extends||function(){var e=function(t,o){return(e=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var o in t)t.hasOwnProperty(o)&&(e[o]=t[o])})(t,o)};return function(t,o){function n(){this.constructor=t}e(t,o),t.prototype=null===o?Object.create(o):(n.prototype=o.prototype,new n)}}(),StoryAppEdit;!function(e){!function(e){var t=StoryApp.Model.GraphModel,o=StoryApp.Model.EnumWrapper;!function(e){var n;!function(e){e[e.AffinityModel=0]="AffinityModel",e[e.Container=1]="Container",e[e.ContentNode=2]="ContentNode",e[e.ContentDescriptor=3]="ContentDescriptor",e[e.TextContentNode=4]="TextContentNode",e[e.GraphicsContentNode=5]="GraphicsContentNode",e[e.ImageContentNode=6]="ImageContentNode",e[e.VideoContentNode=7]="VideoContentNode",e[e.StatusUpdateContentNode=8]="StatusUpdateContentNode",e[e.EmbedContentNode=9]="EmbedContentNode",e[e.DocumentContentNode=10]="DocumentContentNode",e[e.ContentPart=11]="ContentPart",e[e.TextContentPart=12]="TextContentPart",e[e.ImageContentPart=13]="ImageContentPart",e[e.AugmentationResult=14]="AugmentationResult",e[e.ImageAnalysisAugmentationResult=15]="ImageAnalysisAugmentationResult",e[e.TraversalModel=16]="TraversalModel",e[e.Unit=17]="Unit",e[e.UnitAttribute=18]="UnitAttribute",e[e.TraversalRoot=19]="TraversalRoot",e[e.SpecifiedGrouping=20]="SpecifiedGrouping",e[e.Hierarchy=21]="Hierarchy",e[e.SpecifiedGroup=22]="SpecifiedGroup",e[e.Table=23]="Table",e[e.TableRow=24]="TableRow",e[e.TableCell=25]="TableCell",e[e.Emphasizable=26]="Emphasizable",e[e.Composite=27]="Composite",e[e.TextGroup=28]="TextGroup",e[e.TextGroupChild=29]="TextGroupChild",e[e.Paragraph=30]="Paragraph",e[e.SpecifiedUnit=31]="SpecifiedUnit",e[e.UnitReference=32]="UnitReference",e[e.SpecifiedGroupChild=33]="SpecifiedGroupChild",e[e.AttributedContent=34]="AttributedContent",e[e.MediaContent=35]="MediaContent",e[e.ImageContent=36]="ImageContent",e[e.VideoContent=37]="VideoContent",e[e.AudioContent=38]="AudioContent",e[e.EmbeddedContent=39]="EmbeddedContent",e[e.StatusUpdateContent=40]="StatusUpdateContent",e[e.DocumentContent=41]="DocumentContent",e[e.ClosedCaptionContent=42]="ClosedCaptionContent",e[e.AgaveContent=43]="AgaveContent",e[e.ImportingOrEmbeddingDocumentContent=44]="ImportingOrEmbeddingDocumentContent",e[e.CodeBlock=45]="CodeBlock",e[e.StyleOverrides=46]="StyleOverrides",e[e.ColorOverrides=47]="ColorOverrides",e[e.SeedColorOverrides=48]="SeedColorOverrides",e[e.SetBase=49]="SetBase",e[e.Set=50]="Set",e[e.ClosedCaptionComposite=51]="ClosedCaptionComposite",e[e.MediaWithTextComposite=52]="MediaWithTextComposite",e[e.TitleComposite=53]="TitleComposite",e[e.RenderModel=54]="RenderModel",e[e.Root=55]="Root"}(n=e.ObjectType||(e.ObjectType={}));!function(e){e[e.GeoCoordinate=0]="GeoCoordinate",e[e.TextBlock=1]="TextBlock",e[e.TextRun=2]="TextRun",e[e.Rect=3]="Rect",e[e.DecompInfo=4]="DecompInfo",e[e.PaletteColorOverride=5]="PaletteColorOverride",e[e.SeedColorOverride=6]="SeedColorOverride",e[e.LayoutColor=7]="LayoutColor",e[e.VisualOverrides=8]="VisualOverrides",e[e.Size=9]="Size",e[e.UploadInfo=10]="UploadInfo",e[e.CopyInfo=11]="CopyInfo",e[e.AutoPlaySettings=12]="AutoPlaySettings"}(e.StructType||(e.StructType={}));var i;!function(e){e[e.SchemaVersion=0]="SchemaVersion",e[e.Name=1]="Name",e[e.SourceUrl=2]="SourceUrl",e[e.AugmentationStatus=3]="AugmentationStatus",e[e.CanAugment=4]="CanAugment",e[e.Author=5]="Author",e[e.Timestamp=6]="Timestamp",e[e.GeoCoordinate=7]="GeoCoordinate",e[e.UploadInfo=8]="UploadInfo",e[e.Provider=9]="Provider",e[e.DecompProperties=10]="DecompProperties",e[e.Version=11]="Version",e[e.Text=12]="Text",e[e.Representation=13]="Representation",e[e.OriginalWidth=14]="OriginalWidth",e[e.OriginalHeight=15]="OriginalHeight",e[e.Duration=16]="Duration",e[e.Sizes=17]="Sizes",e[e.SourceId=18]="SourceId",e[e.Height=19]="Height",e[e.Width=20]="Width",e[e.Type=21]="Type",e[e.Value=22]="Value",e[e.Semantic=23]="Semantic",e[e.CopyInfo=24]="CopyInfo",e[e.Hash=25]="Hash",e[e.SalientRegionLeft=26]="SalientRegionLeft",e[e.SalientRegionTop=27]="SalientRegionTop",e[e.SalientRegionWidth=28]="SalientRegionWidth",e[e.SalientRegionHeight=29]="SalientRegionHeight",e[e.FocusRegions=30]="FocusRegions",e[e.PreventCropping=31]="PreventCropping",e[e.CropState=32]="CropState",e[e.AugmentationData=33]="AugmentationData",e[e.StyleId=34]="StyleId",e[e.ColorOptionId=35]="ColorOptionId",e[e.AllowRemoteDesignObjects=36]="AllowRemoteDesignObjects",e[e.SuggestionsUpdateRequired=37]="SuggestionsUpdateRequired",e[e.WorldId=38]="WorldId",e[e.ColorPalette=39]="ColorPalette",e[e.Culture=40]="Culture",e[e.HideEndOfSway=41]="HideEndOfSway",e[e.RTL=42]="RTL",e[e.AutoPlaySettings=43]="AutoPlaySettings",e[e.CustomColors=44]="CustomColors",e[e.Emphasized=45]="Emphasized",e[e.PartRef=46]="PartRef",e[e.Enabled=47]="Enabled",e[e.Title=48]="Title",e[e.Visualization=49]="Visualization",e[e.HTML=50]="HTML",e[e.TableBorders=51]="TableBorders",e[e.HeightPercentage=52]="HeightPercentage",e[e.TableRowBorders=53]="TableRowBorders",e[e.WidthPercentage=54]="WidthPercentage",e[e.ColumnSpan=55]="ColumnSpan",e[e.RowSpan=56]="RowSpan",e[e.CellType=57]="CellType",e[e.CellVerticalAlignment=58]="CellVerticalAlignment",e[e.TableCellBorders=59]="TableCellBorders",e[e.Emphasis=60]="Emphasis",e[e.ListStyle=61]="ListStyle",e[e.Direction=62]="Direction",e[e.TextHorizontalAlignment=63]="TextHorizontalAlignment",e[e.Content=64]="Content",e[e.ProviderType=65]="ProviderType",e[e.VisualOverrides=66]="VisualOverrides",e[e.ContentSource=67]="ContentSource",e[e.Attribution=68]="Attribution",e[e.AuthorUserName=69]="AuthorUserName",e[e.LicenseName=70]="LicenseName",e[e.LicenseLink=71]="LicenseLink",e[e.Summary=72]="Summary",e[e.DecompInfo=73]="DecompInfo",e[e.Availability=74]="Availability",e[e.IsAugmentationCached=75]="IsAugmentationCached",e[e.VideoPlayerDescriptor=76]="VideoPlayerDescriptor",e[e.Size=77]="Size",e[e.AudioPlayerDescriptor=78]="AudioPlayerDescriptor",e[e.EmbedCode=79]="EmbedCode",e[e.DocumentID=80]="DocumentID",e[e.CardState=81]="CardState",e[e.StrictSizing=82]="StrictSizing",e[e.BodyText=83]="BodyText",e[e.OriginalSource=84]="OriginalSource",e[e.AgaveId=85]="AgaveId",e[e.AgaveSettings=86]="AgaveSettings",e[e.DownloadLink=87]="DownloadLink",e[e.Extension=88]="Extension",e[e.Code=89]="Code",e[e.Language=90]="Language",e[e.FontSetId=91]="FontSetId",e[e.BackgroundSetId=92]="BackgroundSetId",e[e.FilterSetId=93]="FilterSetId",e[e.CoverpageBackgroundsId=94]="CoverpageBackgroundsId",e[e.AnimationAmount=95]="AnimationAmount",e[e.FontScale=96]="FontScale",e[e.Colors=97]="Colors",e[e.FileName=98]="FileName",e[e.Label=99]="Label",e[e.IsDecorative=100]="IsDecorative",e[e.BackgroundPresent=101]="BackgroundPresent"}(i=e.Prop||(e.Prop={}));var r;!function(e){e[e.AffinityModelHasContainer=0]="AffinityModelHasContainer",e[e.ContainerHasContentNode=1]="ContainerHasContentNode",e[e.ContainerHasContainer=2]="ContainerHasContainer",e[e.ContentNodeHasTextContentPart=3]="ContentNodeHasTextContentPart",e[e.ContentNodeHasImageContentPart=4]="ContentNodeHasImageContentPart",e[e.ContentNodeHasContentDescriptor=5]="ContentNodeHasContentDescriptor",e[e.ContentPartHasAugmentationResult=6]="ContentPartHasAugmentationResult",e[e.TraversalModelHasUnit=7]="TraversalModelHasUnit",e[e.TraversalModelHasSpecifiedGrouping=8]="TraversalModelHasSpecifiedGrouping",e[e.TraversalModelHasStyleOverrides=9]="TraversalModelHasStyleOverrides",e[e.UnitPointsToContentNode=10]="UnitPointsToContentNode",e[e.UnitHasUnitAttribute=11]="UnitHasUnitAttribute",e[e.SpecifiedGroupingHasSpecifiedGroup=12]="SpecifiedGroupingHasSpecifiedGroup",e[e.SpecifiedGroupingContainsSpecifiedGroup=13]="SpecifiedGroupingContainsSpecifiedGroup",e[e.SpecifiedGroupHasSpecifiedGroup=14]="SpecifiedGroupHasSpecifiedGroup",e[e.SpecifiedGroupHasSpecifiedUnit=15]="SpecifiedGroupHasSpecifiedUnit",e[e.SpecifiedGroupHasSpecifiedGroupChild=16]="SpecifiedGroupHasSpecifiedGroupChild",e[e.SpecifiedGroupHeadsSpecifiedGroupChild=17]="SpecifiedGroupHeadsSpecifiedGroupChild",e[e.TableHasTableRow=18]="TableHasTableRow",e[e.TableHasMediaWithTextComposite=19]="TableHasMediaWithTextComposite",e[e.TableHasTextGroup=20]="TableHasTextGroup",e[e.TableHasParagraph=21]="TableHasParagraph",e[e.TableRowHasTableCell=22]="TableRowHasTableCell",e[e.TableCellHasSpecifiedGroupChild=23]="TableCellHasSpecifiedGroupChild",e[e.TextGroupHasTextGroupChild=24]="TextGroupHasTextGroupChild",e[e.ParagraphHasParagraph=25]="ParagraphHasParagraph",e[e.UnitReferencePointsToUnit=26]="UnitReferencePointsToUnit",e[e.UnitReferenceHasUnitAttribute=27]="UnitReferenceHasUnitAttribute",e[e.SpecifiedGroupChildContainsParagraph=28]="SpecifiedGroupChildContainsParagraph",e[e.ImageContentHasImageContentPart=29]="ImageContentHasImageContentPart",e[e.VideoContentHasImageContentPart=30]="VideoContentHasImageContentPart",e[e.StatusUpdateContentHasImageContentPart=31]="StatusUpdateContentHasImageContentPart",e[e.StatusUpdateContentContainsImageContentPart=32]="StatusUpdateContentContainsImageContentPart",e[e.StyleOverridesHasColorOverrides=33]="StyleOverridesHasColorOverrides",e[e.StyleOverridesHasSeedColorOverrides=34]="StyleOverridesHasSeedColorOverrides",e[e.SetHasSpecifiedGroupChild=35]="SetHasSpecifiedGroupChild",e[e.ClosedCaptionCompositeHasClosedCaptionContent=36]="ClosedCaptionCompositeHasClosedCaptionContent",e[e.MediaWithTextCompositeHasTextGroup=37]="MediaWithTextCompositeHasTextGroup",e[e.MediaWithTextCompositeHasParagraph=38]="MediaWithTextCompositeHasParagraph",e[e.MediaWithTextCompositeHasMediaContent=39]="MediaWithTextCompositeHasMediaContent",e[e.MediaWithTextCompositeHasClosedCaptionComposite=40]="MediaWithTextCompositeHasClosedCaptionComposite",e[e.TitleCompositeHasParagraph=41]="TitleCompositeHasParagraph",e[e.TitleCompositeHasSubtitleParagraph=42]="TitleCompositeHasSubtitleParagraph",e[e.TitleCompositeHasAuthorParagraph=43]="TitleCompositeHasAuthorParagraph",e[e.TitleCompositeHasLogoSpecifiedGroupChild=44]="TitleCompositeHasLogoSpecifiedGroupChild",e[e.TitleCompositeHasSpecifiedGroupChild=45]="TitleCompositeHasSpecifiedGroupChild",e[e.ModelRoot=46]="ModelRoot",e[e.ExternalData=47]="ExternalData"}(r=e.Meaning||(e.Meaning={}));var a;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.None=0]="None",e[e.Flickr=1]="Flickr",e[e.Twitter=2]="Twitter",e[e.Bing=3]="Bing",e[e.Facebook=4]="Facebook",e[e.YouTube=5]="YouTube",e[e.SkyDrive=6]="SkyDrive",e[e.SuggestedContent=7]="SuggestedContent",e[e.Web=8]="Web",e[e.Azure=9]="Azure",e[e.Embed=10]="Embed",e[e.WebEmbed=11]="WebEmbed",e[e.StockPhotos=12]="StockPhotos",e[e.MyDevice=13]="MyDevice",e[e.PicHit=14]="PicHit",e[e.OneNote=15]="OneNote",e[e.OneDrivePro=16]="OneDrivePro",e[e.Wikipedia=17]="Wikipedia",e[e.Shutterstock=18]="Shutterstock",e[e.BingLocal=19]="BingLocal",e[e.OneDrive=20]="OneDrive",e[e.Giphy=21]="Giphy",e[e.Sway=22]="Sway",e[e.O365Video=23]="O365Video",e[e.TeamSiteLibraries=24]="TeamSiteLibraries",e[e.PullQuoteEnhancement=25]="PullQuoteEnhancement"}(a=e.ContentProvider||(e.ContentProvider={}));!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Title=0]="Title",e[e.Body=1]="Body",e[e.BodyHtml=2]="BodyHtml",e[e.Summary=3]="Summary",e[e.SummaryHtml=4]="SummaryHtml",e[e.Author=5]="Author",e[e.UserName=6]="UserName",e[e.Timestamp=7]="Timestamp",e[e.Attribution=8]="Attribution",e[e.Link=9]="Link",e[e.RssLink=10]="RssLink",e[e.Duration=11]="Duration",e[e.AlbumCount=12]="AlbumCount",e[e.VideoPlayerDescriptor=13]="VideoPlayerDescriptor",e[e.SuggestionId=14]="SuggestionId",e[e.Likes=15]="Likes",e[e.Longitude=16]="Longitude",e[e.Latitude=17]="Latitude",e[e.SCQueryIds=18]="SCQueryIds",e[e.CategoryInfo=19]="CategoryInfo",e[e.LicenseName=20]="LicenseName",e[e.LicenseLink=21]="LicenseLink",e[e.AudioPlayerDescriptor=22]="AudioPlayerDescriptor",e[e.Rating=23]="Rating",e[e.ReviewCount=24]="ReviewCount",e[e.Address=25]="Address",e[e.Phone=26]="Phone",e[e.PriceRange=27]="PriceRange",e[e.Price=28]="Price",e[e.Size=29]="Size",e[e.Extension=30]="Extension",e[e.SourceName=31]="SourceName",e[e.AltText=32]="AltText"}(e.TextCategory||(e.TextCategory={}));var s;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.LeftToRight=0]="LeftToRight",e[e.RightToLeft=1]="RightToLeft",e[e.None=2]="None"}(s=e.TextDirection||(e.TextDirection={}));var l;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Image=0]="Image",e[e.Profile=1]="Profile",e[e.Thumbnail=2]="Thumbnail",e[e.AttributionIcon=3]="AttributionIcon",e[e.GifThumbnail=4]="GifThumbnail"}(l=e.ImageCategory||(e.ImageCategory={}));var c;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Unknown=0]="Unknown",e[e.Other=1]="Other",e[e.Chart=2]="Chart",e[e.SmartArt=3]="SmartArt",e[e.Table=4]="Table",e[e.OtherNonCroppableElement=5]="OtherNonCroppableElement"}(c=e.ImageSemantic||(e.ImageSemantic={}));!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.NotNeeded=0]="NotNeeded",e[e.ReadyToAugment=1]="ReadyToAugment",e[e.Completed=2]="Completed",e[e.Failed=3]="Failed"}(e.AugmentationStatus||(e.AugmentationStatus={}));!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Caption=0]="Caption"}(e.UnitAttributeCategory||(e.UnitAttributeCategory={}));var u;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Auto=0]="Auto",e[e.Less=1]="Less",e[e.None=2]="None",e[e.More=3]="More",e[e.Very=4]="Very"}(u=e.EmphasisLevel||(e.EmphasisLevel={}));var p;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Data=0]="Data",e[e.ColumnHeader=1]="ColumnHeader",e[e.RowHeader=2]="RowHeader"}(p=e.CellType||(e.CellType={}));var d;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Auto=0]="Auto",e[e.Less=1]="Less",e[e.More=2]="More",e[e.Very=3]="Very"}(d=e.AnimationLevel||(e.AnimationLevel={}));!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Light1=0]="Light1",e[e.Light2=1]="Light2",e[e.Dark1=2]="Dark1",e[e.Dark2=3]="Dark2",e[e.Accent1=4]="Accent1",e[e.Accent2=5]="Accent2",e[e.Accent3=6]="Accent3",e[e.Accent4=7]="Accent4",e[e.Accent5=8]="Accent5",e[e.Accent6=9]="Accent6",e[e.Hyperlink=10]="Hyperlink",e[e.FollowedHyperlink=11]="FollowedHyperlink"}(e.PaletteColor||(e.PaletteColor={}));var g;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.None=0]="None",e[e.Flat=1]="Flat",e[e.Bulleted=2]="Bulleted",e[e.Numbered=3]="Numbered"}(g=e.ListStyle||(e.ListStyle={}));var y;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Uploading=0]="Uploading",e[e.Processing=1]="Processing",e[e.Completed=2]="Completed",e[e.Error=3]="Error"}(y=e.UploadStatus||(e.UploadStatus={}));!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Generic=0]="Generic",e[e.TimeOut=1]="TimeOut",e[e.CorruptedFile=2]="CorruptedFile",e[e.InternalProcessingError=3]="InternalProcessingError",e[e.MaximumSwaySizeExceeded=4]="MaximumSwaySizeExceeded",e[e.IngestionDisabled=5]="IngestionDisabled",e[e.FormatDisabled=6]="FormatDisabled",e[e.FeatureDisabled=7]="FeatureDisabled",e[e.UnsupportedFormat=8]="UnsupportedFormat"}(e.UploadCardErrorMessage||(e.UploadCardErrorMessage={}));var h;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Unknown=0]="Unknown",e[e.DocumentIngestion=1]="DocumentIngestion",e[e.ColdStart=2]="ColdStart"}(h=e.ContentCreator||(e.ContentCreator={}));var f;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Auto=0]="Auto",e[e.ShouldCrop=1]="ShouldCrop",e[e.DoNotCrop=2]="DoNotCrop"}(f=e.ImageCropState||(e.ImageCropState={}));var S;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Free=0]="Free",e[e.Trial=1]="Trial",e[e.Bought=2]="Bought",e[e.NoPermission=3]="NoPermission"}(S=e.ContentAvailability||(e.ContentAvailability={}));var m;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Inherit=0]="Inherit",e[e.Left=1]="Left",e[e.Center=2]="Center",e[e.Right=3]="Right",e[e.Justify=4]="Justify"}(m=e.TextHorizontalAlignment||(e.TextHorizontalAlignment={}));var v;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Baseline=0]="Baseline",e[e.Top=1]="Top",e[e.Center=2]="Center",e[e.Bottom=3]="Bottom"}(v=e.CellVerticalAlignment||(e.CellVerticalAlignment={}));var C;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.TopBorder=0]="TopBorder",e[e.RightBorder=1]="RightBorder",e[e.BottomBorder=2]="BottomBorder",e[e.LeftBorder=3]="LeftBorder",e[e.InsideVerticalBorders=4]="InsideVerticalBorders",e[e.InsideHorizontalBorders=5]="InsideHorizontalBorders"}(C=e.Borders||(e.Borders={}));var P;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Auto=0]="Auto",e[e.Map=1]="Map",e[e.Stack=2]="Stack",e[e.Comparison=3]="Comparison",e[e.Gallery=4]="Gallery",e[e.GalleryWithThumbs=5]="GalleryWithThumbs",e[e.GalleryContinuous=6]="GalleryContinuous",e[e.UniformGrid=7]="UniformGrid",e[e.VariableGrid=8]="VariableGrid"}(P=e.Visualization||(e.Visualization={}));var I=function(){function e(){}return e.prototype.serializeProperties=function(e,t){return T.SerializeProperties(e,t)},e.prototype.deserializeProperties=function(e,t){return T.DeserializeProperties(e,t)},e}(),T=function(){function T(e){this._model=new t(e,T.DefaultProps,T.PropNotifierMappings),this._model.isEmpty()&&(this.createObject(n.Root,"ModelRoot"),this.createObject(n.AffinityModel,"AffinityRoot"),this.addRelationship("ModelRoot","AffinityRoot",r.ModelRoot),this.createObject(n.TraversalModel,"TraversalRoot"),this.addRelationship("ModelRoot","TraversalRoot",r.ModelRoot),this.createObject(n.RenderModel,"RenderRoot"),this.addRelationship("ModelRoot","RenderRoot",r.ModelRoot))}return T.prototype.createObject=function(e,t){return this._model.createObject(n[e],t)},T.prototype.containsObject=function(e){return this._model.containsObject(e)},T.prototype.getObjectType=function(e){return n[this._model.getObjectType(e)]},T.prototype.getProperty=function(e,t,o){return this._model.getProperty(e,i[t],o)},T.prototype.setProperty=function(e,t,o,n){void 0===n&&(n=!0),this._model.setProperty(e,i[t],o,n)},T.prototype.updateProperty=function(e,t){this._model.updateProperty(e,i[t])},T.prototype.resetProperty=function(e,t){this._model.resetProperty(e,i[t])},T.prototype.addRelationship=function(e,t,o,n){this._model.addRelationship(e,t,T.HashedMeanings[o],n)},T.prototype.removeRelationship=function(e,t,o){this._model.removeRelationship(e,t,T.HashedMeanings[o])},T.prototype.setRelationships=function(e,t,o){this._model.setRelationships(e,t,T.HashedMeanings[o])},T.prototype.getObjectsRelatedFrom=function(e,t,o){return this._model.getObjectsRelatedFrom(e,T.HashedMeanings[t],o)},T.prototype.getObjectsRelatedTo=function(e,t,o){return this._model.getObjectsRelatedTo(e,T.HashedMeanings[t],o)},T.prototype.isExternalObject=function(e){return this._model.isExternalObject(e)},T.prototype.getExternalDataId=function(e){return this._model.getExternalDataId(e)},T.prototype.registerObjectDisposalCallback=function(e){this._model.registerObjectDisposalCallback(e)},T.SerializeProperties=function(e,o){var n=t.GetObjectTypeFromPropBagType(e);if(n){var i={},r=0;for(var a in o)if(o.hasOwnProperty(a)){var s=T.EnumValues[n][a],l=T.StructValues[n][a],c=T.StructCollectionValues[n][a],u=T.PropertyCollectionValues[n][a],p=T.EnumCollectionValues[n][a];s?s.flags?i[a]=Flags.serialize(s,o[a]):-1===o[a].IntValue?i[a]=o[a].StringValue:i[a]=s.type[o[a].IntValue]:i[a]=l?o[a].serialize():c?o[a].serialize():u?o[a].serialize():p?o[a].serialize(function(e){return T.EnumCollectionValueTypes[n][a].type[e]}):o[a],r++}return r>0?i:void 0}},T.DeserializeProperties=function(n,i){var r=t.GetObjectTypeFromPropBagType(n);if(r){var a=T.DefaultProps[r];if(a){var s=Object.create(a);for(var l in i){var c=T.EnumValues[r][l],u=T.StructValues[r][l],p=T.StructCollectionValues[r][l],d=T.PropertyCollectionValues[r][l],g=T.EnumCollectionValues[r][l];if(c)if(c.flags)s[l]=Flags.deserialize(c.type,i[l]);else{var y=i[l];s[l]=new o(c.type[y]||y)}else if(u)s[l]=u.Deserialize(i[l]);else if(p)s[l]=new e.StructCollection,s[l].deserializeStructCollection(i[l],p.Deserialize);else if(d)s[l]=new e.PropertyCollection,s[l].deserializePropertyCollection(i[l]);else if(g){var h=T.EnumCollectionValueTypes[r][l].type;s[l]=new e.EnumCollection,s[l].deserializeEnumCollection(i[l],h)}else s[l]=i[l]}return s}}},T.getHashedMeanings=function(){var e={};return e[r.AffinityModelHasContainer]="4dTUgH",e[r.ContainerHasContentNode]="CRKE9P",e[r.ContainerHasContainer]="5VkKJt",e[r.ContentNodeHasTextContentPart]="8n1zQA",e[r.ContentNodeHasImageContentPart]="OULqtF",e[r.ContentNodeHasContentDescriptor]="OxFoP4",e[r.ContentPartHasAugmentationResult]="BMWOza",e[r.TraversalModelHasUnit]="ONURWV",e[r.TraversalModelHasSpecifiedGrouping]="EOFwKV",e[r.TraversalModelHasStyleOverrides]="On1wAL",e[r.UnitPointsToContentNode]="M1hNsl",e[r.UnitHasUnitAttribute]="3q7Fj6",e[r.SpecifiedGroupingHasSpecifiedGroup]="7eFNmT",e[r.SpecifiedGroupingContainsSpecifiedGroup]="Dgw7zt",e[r.SpecifiedGroupHasSpecifiedGroup]="PHqbP4",e[r.SpecifiedGroupHasSpecifiedUnit]="DjEDPg",e[r.SpecifiedGroupHasSpecifiedGroupChild]="PoZ9Ol",e[r.SpecifiedGroupHeadsSpecifiedGroupChild]="HKY0PS",e[r.TableHasTableRow]="C0EcQX",e[r.TableHasMediaWithTextComposite]="Khougn",e[r.TableHasTextGroup]="JDwxsQ",e[r.TableHasParagraph]="LNBpze",e[r.TableRowHasTableCell]="9sdAw1",e[r.TableCellHasSpecifiedGroupChild]="TxlYnN",e[r.TextGroupHasTextGroupChild]="2jEbUU",e[r.ParagraphHasParagraph]="8mtmcm",e[r.UnitReferencePointsToUnit]="SI3zsw",e[r.UnitReferenceHasUnitAttribute]="NMkXdT",e[r.SpecifiedGroupChildContainsParagraph]="NuHUlI",e[r.ImageContentHasImageContentPart]="E42s24",e[r.VideoContentHasImageContentPart]="6ekH03",e[r.StatusUpdateContentHasImageContentPart]="7F78SS",e[r.StatusUpdateContentContainsImageContentPart]="4c4n2l",e[r.StyleOverridesHasColorOverrides]="1NYE5A",e[r.StyleOverridesHasSeedColorOverrides]="CRGCyo",e[r.SetHasSpecifiedGroupChild]="OPR2ZO",e[r.ClosedCaptionCompositeHasClosedCaptionContent]="D4dE0l",e[r.MediaWithTextCompositeHasTextGroup]="H7rrly",e[r.MediaWithTextCompositeHasParagraph]="OtJZHX",e[r.MediaWithTextCompositeHasMediaContent]="O8nWM9",e[r.MediaWithTextCompositeHasClosedCaptionComposite]="8PjV2a",e[r.TitleCompositeHasParagraph]="BNCALn",e[r.TitleCompositeHasSubtitleParagraph]="EjYfSJ",e[r.TitleCompositeHasAuthorParagraph]="HAoHxq",e[r.TitleCompositeHasLogoSpecifiedGroupChild]="BbQBtG",e[r.TitleCompositeHasSpecifiedGroupChild]="QwCcmC",e[r.ModelRoot]="2SLmQk",e[r.ExternalData]="9w0IDE",e},T.getDefaultProps=function(){return{AffinityModel:{},ImageContentPart:{Type:new o(l.Image),Semantic:new o(c.Unknown),SourceUrl:"",CopyInfo:null,Width:0,Height:0,FocusRegions:null,CropState:new o(f.Auto)},TraversalModel:{StyleId:"Simplicity",ColorOptionId:"",AllowRemoteDesignObjects:!1,SuggestionsUpdateRequired:!1,WorldId:"Sectional",ColorPalette:null,Culture:"en-US",HideEndOfSway:!1,RTL:!1,AutoPlaySettings:null,CustomColors:null},SpecifiedGrouping:{Enabled:!1},SpecifiedGroup:{Title:"",Visualization:new o(P.Auto),ContentSource:new o(h.Unknown)},Table:{HTML:"",TableBorders:null,ContentSource:new o(h.Unknown),Emphasis:new o(u.Auto)},TableRow:{HeightPercentage:0,TableRowBorders:null},TableCell:{WidthPercentage:0,ColumnSpan:0,RowSpan:0,CellType:new o(p.Data),CellVerticalAlignment:new o(v.Baseline),TableCellBorders:null},TextGroup:{ListStyle:new o(g.None),Direction:new o(s.LeftToRight),Visualization:new o(P.Auto),ContentSource:new o(h.Unknown),Emphasis:new o(u.Auto),TextHorizontalAlignment:new o(m.Inherit)},TextGroupChild:{TextHorizontalAlignment:new o(m.Inherit),ContentSource:new o(h.Unknown),Emphasis:new o(u.Auto)},Paragraph:{Content:null,ListStyle:new o(g.None),Direction:new o(s.LeftToRight),ProviderType:new o(a.None),TextHorizontalAlignment:new o(m.Inherit),ContentSource:new o(h.Unknown),Emphasis:new o(u.Auto)},ImageContent:{OriginalWidth:0,OriginalHeight:0,IsAugmentationCached:!1,SourceUrl:"",Summary:"",Title:"",DecompInfo:null,UploadInfo:null,VisualOverrides:null,Availability:new o(S.Free),ContentSource:new o(h.Unknown),Author:"",Timestamp:"",Attribution:"",GeoCoordinate:null,AuthorUserName:"",LicenseName:"",LicenseLink:"",Emphasis:new o(u.Auto)},VideoContent:{VideoPlayerDescriptor:"",Duration:"",Size:"",SourceUrl:"",Summary:"",Title:"",DecompInfo:null,UploadInfo:null,VisualOverrides:null,Availability:new o(S.Free),ContentSource:new o(h.Unknown),Author:"",Timestamp:"",Attribution:"",GeoCoordinate:null,AuthorUserName:"",LicenseName:"",LicenseLink:"",Emphasis:new o(u.Auto)},AudioContent:{AudioPlayerDescriptor:"",Duration:"",Size:"",CopyInfo:null,SourceUrl:"",Summary:"",Title:"",DecompInfo:null,UploadInfo:null,VisualOverrides:null,Availability:new o(S.Free),ContentSource:new o(h.Unknown),Author:"",Timestamp:"",Attribution:"",GeoCoordinate:null,AuthorUserName:"",LicenseName:"",LicenseLink:"",Emphasis:new o(u.Auto)},EmbeddedContent:{EmbedCode:"",Height:"",Width:"",ProviderType:new o(a.None),DocumentID:"",CardState:new o(y.Uploading),StrictSizing:!1,SourceUrl:"",Summary:"",Title:"",DecompInfo:null,UploadInfo:null,VisualOverrides:null,Availability:new o(S.Free),ContentSource:new o(h.Unknown),Author:"",Timestamp:"",Attribution:"",GeoCoordinate:null,AuthorUserName:"",LicenseName:"",LicenseLink:"",Emphasis:new o(u.Auto)},StatusUpdateContent:{BodyText:null,Sizes:null,SourceId:"",OriginalSource:"",SourceUrl:"",Summary:"",Title:"",DecompInfo:null,UploadInfo:null,VisualOverrides:null,Availability:new o(S.Free),ContentSource:new o(h.Unknown),Author:"",Timestamp:"",Attribution:"",GeoCoordinate:null,AuthorUserName:"",LicenseName:"",LicenseLink:"",Emphasis:new o(u.Auto)},DocumentContent:{SourceUrl:"",Summary:"",Title:"",DecompInfo:null,UploadInfo:null,VisualOverrides:null,Availability:new o(S.Free),ContentSource:new o(h.Unknown),Author:"",Timestamp:"",Attribution:"",GeoCoordinate:null,AuthorUserName:"",LicenseName:"",LicenseLink:"",Emphasis:new o(u.Auto)},ClosedCaptionContent:{SourceUrl:"",Summary:"",Title:"",DecompInfo:null,UploadInfo:null,VisualOverrides:null,Availability:new o(S.Free),ContentSource:new o(h.Unknown),Author:"",Timestamp:"",Attribution:"",GeoCoordinate:null,AuthorUserName:"",LicenseName:"",LicenseLink:"",Emphasis:new o(u.Auto)},AgaveContent:{AgaveId:"",AgaveSettings:"",ContentSource:new o(h.Unknown),Emphasis:new o(u.Auto)},ImportingOrEmbeddingDocumentContent:{DownloadLink:"",Extension:"",Size:0,ProviderType:new o(a.None),DocumentID:"",CardState:new o(y.Uploading),SourceUrl:"",Summary:"",Title:"",DecompInfo:null,UploadInfo:null,VisualOverrides:null,Availability:new o(S.Free),ContentSource:new o(h.Unknown),Author:"",Timestamp:"",Attribution:"",GeoCoordinate:null,AuthorUserName:"",LicenseName:"",LicenseLink:"",Emphasis:new o(u.Auto)},CodeBlock:{Code:"",Language:"",SourceUrl:"",Summary:"",Title:"",DecompInfo:null,UploadInfo:null,VisualOverrides:null,Availability:new o(S.Free),ContentSource:new o(h.Unknown),Author:"",Timestamp:"",Attribution:"",GeoCoordinate:null,AuthorUserName:"",LicenseName:"",LicenseLink:"",Emphasis:new o(u.Auto)},StyleOverrides:{FontSetId:"",BackgroundSetId:"",FilterSetId:"",CoverpageBackgroundsId:"",AnimationAmount:new o(d.Auto),FontScale:1},SeedColorOverrides:{Colors:null},Set:{Visualization:new o(P.Auto),ContentSource:new o(h.Unknown),Emphasis:new o(u.Auto)},ClosedCaptionComposite:{Language:"",FileName:"",Label:"",ContentSource:new o(h.Unknown),Emphasis:new o(u.Auto)},MediaWithTextComposite:{IsDecorative:!1,ContentSource:new o(h.Unknown),Emphasis:new o(u.Auto)},TitleComposite:{BackgroundPresent:!1,ContentSource:new o(h.Unknown),Emphasis:new o(u.Auto)},RenderModel:{},Root:{SchemaVersion:0}}},T.getPropNotifierMappings=function(){return{AffinityModel:{},ImageContentPart:{Type:"Main",Semantic:"Main",SourceUrl:"Main",CopyInfo:"Main",Width:"Main",Height:"Main",FocusRegions:"Main",CropState:"Main"},TraversalModel:{StyleId:"StyleIdChanged",ColorOptionId:"Main",AllowRemoteDesignObjects:"Main",SuggestionsUpdateRequired:"Main",WorldId:"WorldIdChanged",ColorPalette:"Main",Culture:"CultureChanged",HideEndOfSway:"Main",RTL:"Main",AutoPlaySettings:"Main",CustomColors:"CustomColorsChanged"},SpecifiedGrouping:{Enabled:"Main"},SpecifiedGroup:{Title:"Main",Visualization:"Main",ContentSource:"Main"},Table:{HTML:"Main",TableBorders:"Main",ContentSource:"Main",Emphasis:"Main"},TableRow:{HeightPercentage:"Main",TableRowBorders:"Main"},TableCell:{WidthPercentage:"Main",ColumnSpan:"Main",RowSpan:"Main",CellType:"Main",CellVerticalAlignment:"Main",TableCellBorders:"Main"},TextGroup:{ListStyle:"Main",Direction:"Main",Visualization:"Main",ContentSource:"Main",Emphasis:"Main",TextHorizontalAlignment:"Main"},TextGroupChild:{TextHorizontalAlignment:"Main",ContentSource:"Main",Emphasis:"Main"},Paragraph:{Content:"Main",ListStyle:"Main",Direction:"Main",ProviderType:"Main",TextHorizontalAlignment:"Main",ContentSource:"Main",Emphasis:"Main"},ImageContent:{OriginalWidth:"Main",OriginalHeight:"Main",IsAugmentationCached:"Main",SourceUrl:"Main",Summary:"Main",Title:"Main",DecompInfo:"Main",UploadInfo:"Main",VisualOverrides:"Main",Availability:"Main",ContentSource:"Main",Author:"Main",Timestamp:"Main",Attribution:"Main",GeoCoordinate:"Main",AuthorUserName:"Main",LicenseName:"Main",LicenseLink:"Main",Emphasis:"Main"},VideoContent:{VideoPlayerDescriptor:"Main",Duration:"Main",Size:"Main",SourceUrl:"Main",Summary:"Main",Title:"Main",DecompInfo:"Main",UploadInfo:"Main",VisualOverrides:"Main",Availability:"Main",ContentSource:"Main",Author:"Main",Timestamp:"Main",Attribution:"Main",GeoCoordinate:"Main",AuthorUserName:"Main",LicenseName:"Main",LicenseLink:"Main",Emphasis:"Main"},AudioContent:{AudioPlayerDescriptor:"Main",Duration:"Main",Size:"Main",CopyInfo:"Main",SourceUrl:"Main",Summary:"Main",Title:"Main",DecompInfo:"Main",UploadInfo:"Main",VisualOverrides:"Main",Availability:"Main",ContentSource:"Main",Author:"Main",Timestamp:"Main",Attribution:"Main",GeoCoordinate:"Main",AuthorUserName:"Main",LicenseName:"Main",LicenseLink:"Main",Emphasis:"Main"},EmbeddedContent:{EmbedCode:"Main",Height:"Main",Width:"Main",ProviderType:"Main",DocumentID:"Main",CardState:"Main",StrictSizing:"Main",SourceUrl:"Main",Summary:"Main",Title:"Main",DecompInfo:"Main",UploadInfo:"Main",VisualOverrides:"Main",Availability:"Main",ContentSource:"Main",Author:"Main",Timestamp:"Main",Attribution:"Main",GeoCoordinate:"Main",AuthorUserName:"Main",LicenseName:"Main",LicenseLink:"Main",Emphasis:"Main"},StatusUpdateContent:{BodyText:"Main",Sizes:"Main",SourceId:"Main",OriginalSource:"Main",SourceUrl:"Main",Summary:"Main",Title:"Main",DecompInfo:"Main",UploadInfo:"Main",VisualOverrides:"Main",Availability:"Main",ContentSource:"Main",Author:"Main",Timestamp:"Main",Attribution:"Main",GeoCoordinate:"Main",AuthorUserName:"Main",LicenseName:"Main",LicenseLink:"Main",Emphasis:"Main"},DocumentContent:{SourceUrl:"Main",Summary:"Main",Title:"Main",DecompInfo:"Main",UploadInfo:"Main",VisualOverrides:"Main",Availability:"Main",ContentSource:"Main",Author:"Main",Timestamp:"Main",Attribution:"Main",GeoCoordinate:"Main",AuthorUserName:"Main",LicenseName:"Main",LicenseLink:"Main",Emphasis:"Main"},ClosedCaptionContent:{SourceUrl:"Main",Summary:"Main",Title:"Main",DecompInfo:"Main",UploadInfo:"Main",VisualOverrides:"Main",Availability:"Main",ContentSource:"Main",Author:"Main",Timestamp:"Main",Attribution:"Main",GeoCoordinate:"Main",AuthorUserName:"Main",LicenseName:"Main",LicenseLink:"Main",Emphasis:"Main"},AgaveContent:{AgaveId:"Main",AgaveSettings:"Main",ContentSource:"Main",Emphasis:"Main"},ImportingOrEmbeddingDocumentContent:{DownloadLink:"Main",Extension:"Main",Size:"Main",ProviderType:"Main",DocumentID:"Main",CardState:"Main",SourceUrl:"Main",Summary:"Main",Title:"Main",DecompInfo:"Main",UploadInfo:"Main",VisualOverrides:"Main",Availability:"Main",ContentSource:"Main",Author:"Main",Timestamp:"Main",Attribution:"Main",GeoCoordinate:"Main",AuthorUserName:"Main",LicenseName:"Main",LicenseLink:"Main",Emphasis:"Main"},CodeBlock:{Code:"Main",Language:"Main",SourceUrl:"Main",Summary:"Main",Title:"Main",DecompInfo:"Main",UploadInfo:"Main",VisualOverrides:"Main",Availability:"Main",ContentSource:"Main",Author:"Main",Timestamp:"Main",Attribution:"Main",GeoCoordinate:"Main",AuthorUserName:"Main",LicenseName:"Main",LicenseLink:"Main",Emphasis:"Main"},StyleOverrides:{FontSetId:"Main",BackgroundSetId:"Main",FilterSetId:"Main",CoverpageBackgroundsId:"Main",AnimationAmount:"Main",FontScale:"Main"},SeedColorOverrides:{Colors:"Main"},Set:{Visualization:"Main",ContentSource:"Main",Emphasis:"Main"},ClosedCaptionComposite:{Language:"Main",FileName:"Main",Label:"Main",ContentSource:"Main",Emphasis:"Main"},MediaWithTextComposite:{IsDecorative:"Main",ContentSource:"Main",Emphasis:"Main"},TitleComposite:{BackgroundPresent:"Main",ContentSource:"Main",Emphasis:"Main"},RenderModel:{},Root:{SchemaVersion:"Main"}}},T.getEnumValues=function(){return{AffinityModel:{},ImageContentPart:{Type:{flags:!1,type:l},Semantic:{flags:!1,type:c},CropState:{flags:!1,type:f}},TraversalModel:{},SpecifiedGrouping:{},SpecifiedGroup:{Visualization:{flags:!1,type:P},ContentSource:{flags:!1,type:h}},Table:{ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},TableRow:{},TableCell:{CellType:{flags:!1,type:p},CellVerticalAlignment:{flags:!1,type:v}},TextGroup:{ListStyle:{flags:!1,type:g},Direction:{flags:!1,type:s},Visualization:{flags:!1,type:P},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u},TextHorizontalAlignment:{flags:!1,type:m}},TextGroupChild:{TextHorizontalAlignment:{flags:!1,type:m},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},Paragraph:{ListStyle:{flags:!1,type:g},Direction:{flags:!1,type:s},ProviderType:{flags:!1,type:a},TextHorizontalAlignment:{flags:!1,type:m},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},ImageContent:{Availability:{flags:!1,type:S},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},VideoContent:{Availability:{flags:!1,type:S},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},AudioContent:{Availability:{flags:!1,type:S},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},EmbeddedContent:{ProviderType:{flags:!1,type:a},CardState:{flags:!1,type:y},Availability:{flags:!1,type:S},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},StatusUpdateContent:{Availability:{flags:!1,type:S},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},DocumentContent:{Availability:{flags:!1,type:S},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},ClosedCaptionContent:{Availability:{flags:!1,type:S},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},AgaveContent:{ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},ImportingOrEmbeddingDocumentContent:{ProviderType:{flags:!1,type:a},CardState:{flags:!1,type:y},Availability:{flags:!1,type:S},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},CodeBlock:{Availability:{flags:!1,type:S},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},StyleOverrides:{AnimationAmount:{flags:!1,type:d}},SeedColorOverrides:{},Set:{Visualization:{flags:!1,type:P},ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},ClosedCaptionComposite:{ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},MediaWithTextComposite:{ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},TitleComposite:{ContentSource:{flags:!1,type:h},Emphasis:{flags:!1,type:u}},RenderModel:{},Root:{}}},T.getEnumCollectionValues=function(){return{AffinityModel:{},ImageContentPart:{},TraversalModel:{},SpecifiedGrouping:{},SpecifiedGroup:{},Table:{TableBorders:{flags:!1,type:C}},TableRow:{TableRowBorders:{flags:!1,type:C}},TableCell:{TableCellBorders:{flags:!1,type:C}},TextGroup:{},TextGroupChild:{},Paragraph:{},ImageContent:{},VideoContent:{},AudioContent:{},EmbeddedContent:{},StatusUpdateContent:{},DocumentContent:{},ClosedCaptionContent:{},AgaveContent:{},ImportingOrEmbeddingDocumentContent:{},CodeBlock:{},StyleOverrides:{},SeedColorOverrides:{},Set:{},ClosedCaptionComposite:{},MediaWithTextComposite:{},TitleComposite:{},RenderModel:{},Root:{}}},T.SetStructValues=function(){T.StructValues={AffinityModel:{},ImageContentPart:{CopyInfo:e.CopyInfo},TraversalModel:{AutoPlaySettings:e.AutoPlaySettings},SpecifiedGrouping:{},SpecifiedGroup:{},Table:{},TableRow:{},TableCell:{},TextGroup:{},TextGroupChild:{},Paragraph:{Content:e.TextBlock},ImageContent:{DecompInfo:e.DecompInfo,UploadInfo:e.UploadInfo,VisualOverrides:e.VisualOverrides,GeoCoordinate:e.GeoCoordinate},VideoContent:{DecompInfo:e.DecompInfo,UploadInfo:e.UploadInfo,VisualOverrides:e.VisualOverrides,GeoCoordinate:e.GeoCoordinate},AudioContent:{CopyInfo:e.CopyInfo,DecompInfo:e.DecompInfo,UploadInfo:e.UploadInfo,VisualOverrides:e.VisualOverrides,GeoCoordinate:e.GeoCoordinate},EmbeddedContent:{DecompInfo:e.DecompInfo,UploadInfo:e.UploadInfo,VisualOverrides:e.VisualOverrides,GeoCoordinate:e.GeoCoordinate},StatusUpdateContent:{BodyText:e.TextBlock,DecompInfo:e.DecompInfo,UploadInfo:e.UploadInfo,VisualOverrides:e.VisualOverrides,GeoCoordinate:e.GeoCoordinate},DocumentContent:{DecompInfo:e.DecompInfo,UploadInfo:e.UploadInfo,VisualOverrides:e.VisualOverrides,GeoCoordinate:e.GeoCoordinate},ClosedCaptionContent:{DecompInfo:e.DecompInfo,UploadInfo:e.UploadInfo,VisualOverrides:e.VisualOverrides,GeoCoordinate:e.GeoCoordinate},AgaveContent:{},ImportingOrEmbeddingDocumentContent:{DecompInfo:e.DecompInfo,UploadInfo:e.UploadInfo,VisualOverrides:e.VisualOverrides,GeoCoordinate:e.GeoCoordinate},CodeBlock:{DecompInfo:e.DecompInfo,UploadInfo:e.UploadInfo,VisualOverrides:e.VisualOverrides,GeoCoordinate:e.GeoCoordinate},StyleOverrides:{},SeedColorOverrides:{},Set:{},ClosedCaptionComposite:{},MediaWithTextComposite:{},TitleComposite:{},RenderModel:{},Root:{}}},T.SetStructCollectionValues=function(){T.StructCollectionValues={AffinityModel:{},ImageContentPart:{FocusRegions:e.Rect},TraversalModel:{ColorPalette:e.LayoutColor},SpecifiedGrouping:{},SpecifiedGroup:{},Table:{},TableRow:{},TableCell:{},TextGroup:{},TextGroupChild:{},Paragraph:{},ImageContent:{},VideoContent:{},AudioContent:{},EmbeddedContent:{},StatusUpdateContent:{Sizes:e.Size},DocumentContent:{},ClosedCaptionContent:{},AgaveContent:{},ImportingOrEmbeddingDocumentContent:{},CodeBlock:{},StyleOverrides:{},SeedColorOverrides:{Colors:e.SeedColorOverride},Set:{},ClosedCaptionComposite:{},MediaWithTextComposite:{},TitleComposite:{},RenderModel:{},Root:{}}},T.SetPropertyCollectionValues=function(){T.PropertyCollectionValues={AffinityModel:{},ImageContentPart:{},TraversalModel:{CustomColors:!0},SpecifiedGrouping:{},SpecifiedGroup:{},Table:{},TableRow:{},TableCell:{},TextGroup:{},TextGroupChild:{},Paragraph:{},ImageContent:{},VideoContent:{},AudioContent:{},EmbeddedContent:{},StatusUpdateContent:{},DocumentContent:{},ClosedCaptionContent:{},AgaveContent:{},ImportingOrEmbeddingDocumentContent:{},CodeBlock:{},StyleOverrides:{},SeedColorOverrides:{},Set:{},ClosedCaptionComposite:{},MediaWithTextComposite:{},TitleComposite:{},RenderModel:{},Root:{}}},T.SetEnumCollectionValues=function(){T.EnumCollectionValues={AffinityModel:{},ImageContentPart:{},TraversalModel:{},SpecifiedGrouping:{},SpecifiedGroup:{},Table:{TableBorders:!0},TableRow:{TableRowBorders:!0},TableCell:{TableCellBorders:!0},TextGroup:{},TextGroupChild:{},Paragraph:{},ImageContent:{},VideoContent:{},AudioContent:{},EmbeddedContent:{},StatusUpdateContent:{},DocumentContent:{},ClosedCaptionContent:{},AgaveContent:{},ImportingOrEmbeddingDocumentContent:{},CodeBlock:{},StyleOverrides:{},SeedColorOverrides:{},Set:{},ClosedCaptionComposite:{},MediaWithTextComposite:{},TitleComposite:{},RenderModel:{},Root:{}}},T.PropSerializer=new I,T.DefaultProps=T.getDefaultProps(),T.PropNotifierMappings=T.getPropNotifierMappings(),T.EnumValues=T.getEnumValues(),T.EnumCollectionValueTypes=T.getEnumCollectionValues(),T.HashedMeanings=T.getHashedMeanings(),T.RootId="ModelRoot",T}();e.StoryGraph=T}(e.SM||(e.SM={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){var t=StoryApp.Model.GraphModel,o=StoryApp.Model.EnumWrapper;!function(e){function n(e,t){var o=e.prototype;for(var n in t)o[n]=t[n]}var i={},r={},a={getType:function(t){return this.getProperty(e.Prop.Type,t).IntValue},setType:function(t){this.setProperty(e.Prop.Type,new o(t))},setTypeInternal:function(t){this.setProperty(e.Prop.Type,t)},getSemantic:function(t){return this.getProperty(e.Prop.Semantic,t).IntValue},setSemantic:function(t){this.setProperty(e.Prop.Semantic,new o(t))},setSemanticInternal:function(t){this.setProperty(e.Prop.Semantic,t)},getSourceUrl:function(t){return this.getProperty(e.Prop.SourceUrl,t)},setSourceUrl:function(t){this.setProperty(e.Prop.SourceUrl,t)},getCopyInfo:function(t){var o=this.getProperty(e.Prop.CopyInfo,t);return null!=o&&o.setObjectProperty(this,e.Prop.CopyInfo),o},setCopyInfo:function(t){null!=t&&t.setObjectProperty(this,e.Prop.CopyInfo),this.setProperty(e.Prop.CopyInfo,t)},getWidth:function(t){return this.getProperty(e.Prop.Width,t)},setWidth:function(t){this.setProperty(e.Prop.Width,t)},getHeight:function(t){return this.getProperty(e.Prop.Height,t)},setHeight:function(t){this.setProperty(e.Prop.Height,t)},getFocusRegions:function(t){var o=this.getProperty(e.Prop.FocusRegions,t);return null==o&&(o=new Ie,this.setProperty(e.Prop.FocusRegions,o,!1)),o.setObjectProperty(this,e.Prop.FocusRegions),o},getCropState:function(t){return this.getProperty(e.Prop.CropState,t).IntValue},setCropState:function(t){this.setProperty(e.Prop.CropState,new o(t))},setCropStateInternal:function(t){this.setProperty(e.Prop.CropState,t)}},s={getStyleId:function(t){return this.getProperty(e.Prop.StyleId,t)},setStyleId:function(t){this.setProperty(e.Prop.StyleId,t)},getColorOptionId:function(t){return this.getProperty(e.Prop.ColorOptionId,t)},setColorOptionId:function(t){this.setProperty(e.Prop.ColorOptionId,t)},getAllowRemoteDesignObjects:function(t){return this.getProperty(e.Prop.AllowRemoteDesignObjects,t)},setAllowRemoteDesignObjects:function(t){this.setProperty(e.Prop.AllowRemoteDesignObjects,t)},getSuggestionsUpdateRequired:function(t){return this.getProperty(e.Prop.SuggestionsUpdateRequired,t)},setSuggestionsUpdateRequired:function(t){this.setProperty(e.Prop.SuggestionsUpdateRequired,t)},getWorldId:function(t){return this.getProperty(e.Prop.WorldId,t)},setWorldId:function(t){this.setProperty(e.Prop.WorldId,t)},getColorPalette:function(t){var o=this.getProperty(e.Prop.ColorPalette,t);return null==o&&(o=new Ie,this.setProperty(e.Prop.ColorPalette,o,!1)),o.setObjectProperty(this,e.Prop.ColorPalette),o},getCulture:function(t){return this.getProperty(e.Prop.Culture,t)},setCulture:function(t){this.setProperty(e.Prop.Culture,t)},getHideEndOfSway:function(t){return this.getProperty(e.Prop.HideEndOfSway,t)},setHideEndOfSway:function(t){this.setProperty(e.Prop.HideEndOfSway,t)},getRTL:function(t){return this.getProperty(e.Prop.RTL,t)},setRTL:function(t){this.setProperty(e.Prop.RTL,t)},getAutoPlaySettings:function(t){var o=this.getProperty(e.Prop.AutoPlaySettings,t);return null!=o&&o.setObjectProperty(this,e.Prop.AutoPlaySettings),o},setAutoPlaySettings:function(t){null!=t&&t.setObjectProperty(this,e.Prop.AutoPlaySettings),this.setProperty(e.Prop.AutoPlaySettings,t)},getCustomColors:function(t){var o=this.getProperty(e.Prop.CustomColors,t);return null==o&&(o=new Pe,this.setProperty(e.Prop.CustomColors,o,!1)),o.setObjectProperty(this,e.Prop.CustomColors),o},getSpecifiedGrouping:function(t){return this.getRelationshipFrom(e.Meaning.TraversalModelHasSpecifiedGrouping,t)},setSpecifiedGrouping:function(t){this.setRelationships(t?[t]:[],e.Meaning.TraversalModelHasSpecifiedGrouping)},getStyleOverrides:function(t){return this.getRelationshipFrom(e.Meaning.TraversalModelHasStyleOverrides,t)},setStyleOverrides:function(t){this.setRelationships(t?[t]:[],e.Meaning.TraversalModelHasStyleOverrides)}},l={getEnabled:function(t){return this.getProperty(e.Prop.Enabled,t)},setEnabled:function(t){this.setProperty(e.Prop.Enabled,t)}},c={getRootGroup:function(t){return this.getRelationshipFrom(e.Meaning.SpecifiedGroupingContainsSpecifiedGroup,t)},setRootGroup:function(t){this.setRelationships(t?[t]:[],e.Meaning.SpecifiedGroupingContainsSpecifiedGroup)}},u={},p={getTitle:function(t){return this.getProperty(e.Prop.Title,t)},setTitle:function(t){this.setProperty(e.Prop.Title,t)},getVisualization:function(t){return this.getProperty(e.Prop.Visualization,t).IntValue},setVisualization:function(t){this.setProperty(e.Prop.Visualization,new o(t))},setVisualizationInternal:function(t){this.setProperty(e.Prop.Visualization,t)},getHeading:function(t){return this.getRelationshipFrom(e.Meaning.SpecifiedGroupHeadsSpecifiedGroupChild,t)},setHeading:function(t){this.setRelationships(t?[t]:[],e.Meaning.SpecifiedGroupHeadsSpecifiedGroupChild)}},d={getHTML:function(t){return this.getProperty(e.Prop.HTML,t)},setHTML:function(t){this.setProperty(e.Prop.HTML,t)},getTableBorders:function(t){var o=this.getProperty(e.Prop.TableBorders,t);return null==o&&(o=new Te,this.setProperty(e.Prop.TableBorders,o,!1)),o.setObjectProperty(this,e.Prop.TableBorders),o},getImageRepresentation:function(t){return this.getRelationshipFrom(e.Meaning.TableHasMediaWithTextComposite,t)},setImageRepresentation:function(t){this.setRelationships(t?[t]:[],e.Meaning.TableHasMediaWithTextComposite)},getCaption:function(t){return this.getRelationshipFrom(e.Meaning.TableHasTextGroup,t)},setCaption:function(t){this.setRelationships(t?[t]:[],e.Meaning.TableHasTextGroup)},getDescription:function(t){return this.getRelationshipFrom(e.Meaning.TableHasParagraph,t)},setDescription:function(t){this.setRelationships(t?[t]:[],e.Meaning.TableHasParagraph)}},g={getHeightPercentage:function(t){return this.getProperty(e.Prop.HeightPercentage,t)},setHeightPercentage:function(t){this.setProperty(e.Prop.HeightPercentage,t)},getTableRowBorders:function(t){var o=this.getProperty(e.Prop.TableRowBorders,t);return null==o&&(o=new Te,this.setProperty(e.Prop.TableRowBorders,o,!1)),o.setObjectProperty(this,e.Prop.TableRowBorders),o}},y={getWidthPercentage:function(t){return this.getProperty(e.Prop.WidthPercentage,t)},setWidthPercentage:function(t){this.setProperty(e.Prop.WidthPercentage,t)},getColumnSpan:function(t){return this.getProperty(e.Prop.ColumnSpan,t)},setColumnSpan:function(t){this.setProperty(e.Prop.ColumnSpan,t)},getRowSpan:function(t){return this.getProperty(e.Prop.RowSpan,t)},setRowSpan:function(t){this.setProperty(e.Prop.RowSpan,t)},getCellType:function(t){return this.getProperty(e.Prop.CellType,t).IntValue},setCellType:function(t){this.setProperty(e.Prop.CellType,new o(t))},setCellTypeInternal:function(t){this.setProperty(e.Prop.CellType,t)},getCellVerticalAlignment:function(t){return this.getProperty(e.Prop.CellVerticalAlignment,t).IntValue},setCellVerticalAlignment:function(t){this.setProperty(e.Prop.CellVerticalAlignment,new o(t))},setCellVerticalAlignmentInternal:function(t){this.setProperty(e.Prop.CellVerticalAlignment,t)},getTableCellBorders:function(t){var o=this.getProperty(e.Prop.TableCellBorders,t);return null==o&&(o=new Te,this.setProperty(e.Prop.TableCellBorders,o,!1)),o.setObjectProperty(this,e.Prop.TableCellBorders),o}},h={getEmphasis:function(t){return this.getProperty(e.Prop.Emphasis,t).IntValue},setEmphasis:function(t){this.setProperty(e.Prop.Emphasis,new o(t))},setEmphasisInternal:function(t){this.setProperty(e.Prop.Emphasis,t)}},f={},S={getListStyle:function(t){return this.getProperty(e.Prop.ListStyle,t).IntValue},setListStyle:function(t){this.setProperty(e.Prop.ListStyle,new o(t))},setListStyleInternal:function(t){this.setProperty(e.Prop.ListStyle,t)},getDirection:function(t){return this.getProperty(e.Prop.Direction,t).IntValue},setDirection:function(t){this.setProperty(e.Prop.Direction,new o(t))},setDirectionInternal:function(t){this.setProperty(e.Prop.Direction,t)}},m={getTextHorizontalAlignment:function(t){return this.getProperty(e.Prop.TextHorizontalAlignment,t).IntValue},setTextHorizontalAlignment:function(t){this.setProperty(e.Prop.TextHorizontalAlignment,new o(t))},setTextHorizontalAlignmentInternal:function(t){this.setProperty(e.Prop.TextHorizontalAlignment,t)}},v={getContent:function(t){var o=this.getProperty(e.Prop.Content,t);return null!=o&&o.setObjectProperty(this,e.Prop.Content),o},setContent:function(t){null!=t&&t.setObjectProperty(this,e.Prop.Content),this.setProperty(e.Prop.Content,t)},getListStyle:function(t){return this.getProperty(e.Prop.ListStyle,t).IntValue},setListStyle:function(t){this.setProperty(e.Prop.ListStyle,new o(t))},setListStyleInternal:function(t){this.setProperty(e.Prop.ListStyle,t)},getDirection:function(t){return this.getProperty(e.Prop.Direction,t).IntValue},setDirection:function(t){this.setProperty(e.Prop.Direction,new o(t))},setDirectionInternal:function(t){this.setProperty(e.Prop.Direction,t)},getProviderType:function(t){return this.getProperty(e.Prop.ProviderType,t).IntValue},setProviderType:function(t){this.setProperty(e.Prop.ProviderType,new o(t))},setProviderTypeInternal:function(t){this.setProperty(e.Prop.ProviderType,t)}},C={getContentSource:function(t){return this.getProperty(e.Prop.ContentSource,t).IntValue},setContentSource:function(t){this.setProperty(e.Prop.ContentSource,new o(t))},setContentSourceInternal:function(t){this.setProperty(e.Prop.ContentSource,t)},getAuthoringHint:function(t){return this.getRelationshipFrom(e.Meaning.SpecifiedGroupChildContainsParagraph,t)},setAuthoringHint:function(t){this.setRelationships(t?[t]:[],e.Meaning.SpecifiedGroupChildContainsParagraph)}},P={getAuthor:function(t){return this.getProperty(e.Prop.Author,t)},setAuthor:function(t){this.setProperty(e.Prop.Author,t)},getTimestamp:function(t){return this.getProperty(e.Prop.Timestamp,t)},setTimestamp:function(t){this.setProperty(e.Prop.Timestamp,t)},getAttribution:function(t){return this.getProperty(e.Prop.Attribution,t)},setAttribution:function(t){this.setProperty(e.Prop.Attribution,t)},getGeoCoordinate:function(t){var o=this.getProperty(e.Prop.GeoCoordinate,t);return null!=o&&o.setObjectProperty(this,e.Prop.GeoCoordinate),o},setGeoCoordinate:function(t){null!=t&&t.setObjectProperty(this,e.Prop.GeoCoordinate),this.setProperty(e.Prop.GeoCoordinate,t)},getAuthorUserName:function(t){return this.getProperty(e.Prop.AuthorUserName,t)},setAuthorUserName:function(t){this.setProperty(e.Prop.AuthorUserName,t)},getLicenseName:function(t){return this.getProperty(e.Prop.LicenseName,t)},setLicenseName:function(t){this.setProperty(e.Prop.LicenseName,t)},getLicenseLink:function(t){return this.getProperty(e.Prop.LicenseLink,t)},setLicenseLink:function(t){this.setProperty(e.Prop.LicenseLink,t)}},I={getSourceUrl:function(t){return this.getProperty(e.Prop.SourceUrl,t)},setSourceUrl:function(t){this.setProperty(e.Prop.SourceUrl,t)},getSummary:function(t){return this.getProperty(e.Prop.Summary,t)},setSummary:function(t){this.setProperty(e.Prop.Summary,t)},getTitle:function(t){return this.getProperty(e.Prop.Title,t)},setTitle:function(t){this.setProperty(e.Prop.Title,t)},getDecompInfo:function(t){var o=this.getProperty(e.Prop.DecompInfo,t);return null!=o&&o.setObjectProperty(this,e.Prop.DecompInfo),o},setDecompInfo:function(t){null!=t&&t.setObjectProperty(this,e.Prop.DecompInfo),this.setProperty(e.Prop.DecompInfo,t)},getUploadInfo:function(t){var o=this.getProperty(e.Prop.UploadInfo,t);return null!=o&&o.setObjectProperty(this,e.Prop.UploadInfo),o},setUploadInfo:function(t){null!=t&&t.setObjectProperty(this,e.Prop.UploadInfo),this.setProperty(e.Prop.UploadInfo,t)},getVisualOverrides:function(t){var o=this.getProperty(e.Prop.VisualOverrides,t);return null!=o&&o.setObjectProperty(this,e.Prop.VisualOverrides),o},setVisualOverrides:function(t){null!=t&&t.setObjectProperty(this,e.Prop.VisualOverrides),this.setProperty(e.Prop.VisualOverrides,t)},getAvailability:function(t){return this.getProperty(e.Prop.Availability,t).IntValue},setAvailability:function(t){this.setProperty(e.Prop.Availability,new o(t))},setAvailabilityInternal:function(t){this.setProperty(e.Prop.Availability,t)}},T={getOriginalWidth:function(t){return this.getProperty(e.Prop.OriginalWidth,t)},setOriginalWidth:function(t){this.setProperty(e.Prop.OriginalWidth,t)},getOriginalHeight:function(t){return this.getProperty(e.Prop.OriginalHeight,t)},setOriginalHeight:function(t){this.setProperty(e.Prop.OriginalHeight,t)},getIsAugmentationCached:function(t){return this.getProperty(e.Prop.IsAugmentationCached,t)},setIsAugmentationCached:function(t){this.setProperty(e.Prop.IsAugmentationCached,t)}},M={getVideoPlayerDescriptor:function(t){return this.getProperty(e.Prop.VideoPlayerDescriptor,t)},setVideoPlayerDescriptor:function(t){this.setProperty(e.Prop.VideoPlayerDescriptor,t)},getDuration:function(t){return this.getProperty(e.Prop.Duration,t)},setDuration:function(t){this.setProperty(e.Prop.Duration,t)},getSize:function(t){return this.getProperty(e.Prop.Size,t)},setSize:function(t){this.setProperty(e.Prop.Size,t)},getThumbnail:function(t){return this.getRelationshipFrom(e.Meaning.VideoContentHasImageContentPart,t)},setThumbnail:function(t){this.setRelationships(t?[t]:[],e.Meaning.VideoContentHasImageContentPart)}},b={getAudioPlayerDescriptor:function(t){return this.getProperty(e.Prop.AudioPlayerDescriptor,t)},setAudioPlayerDescriptor:function(t){this.setProperty(e.Prop.AudioPlayerDescriptor,t)},getDuration:function(t){return this.getProperty(e.Prop.Duration,t)},setDuration:function(t){this.setProperty(e.Prop.Duration,t)},getSize:function(t){return this.getProperty(e.Prop.Size,t)},setSize:function(t){this.setProperty(e.Prop.Size,t)},getCopyInfo:function(t){var o=this.getProperty(e.Prop.CopyInfo,t);return null!=o&&o.setObjectProperty(this,e.Prop.CopyInfo),o},setCopyInfo:function(t){null!=t&&t.setObjectProperty(this,e.Prop.CopyInfo),this.setProperty(e.Prop.CopyInfo,t)}},A={getEmbedCode:function(t){return this.getProperty(e.Prop.EmbedCode,t)},setEmbedCode:function(t){this.setProperty(e.Prop.EmbedCode,t)},getHeight:function(t){return this.getProperty(e.Prop.Height,t)},setHeight:function(t){this.setProperty(e.Prop.Height,t)},getWidth:function(t){return this.getProperty(e.Prop.Width,t)},setWidth:function(t){this.setProperty(e.Prop.Width,t)},getProviderType:function(t){return this.getProperty(e.Prop.ProviderType,t).IntValue},setProviderType:function(t){this.setProperty(e.Prop.ProviderType,new o(t))},setProviderTypeInternal:function(t){this.setProperty(e.Prop.ProviderType,t)},getDocumentID:function(t){return this.getProperty(e.Prop.DocumentID,t)},setDocumentID:function(t){this.setProperty(e.Prop.DocumentID,t)},getCardState:function(t){return this.getProperty(e.Prop.CardState,t).IntValue},setCardState:function(t){this.setProperty(e.Prop.CardState,new o(t))},setCardStateInternal:function(t){this.setProperty(e.Prop.CardState,t)},getStrictSizing:function(t){return this.getProperty(e.Prop.StrictSizing,t)},setStrictSizing:function(t){this.setProperty(e.Prop.StrictSizing,t)}},w={getBodyText:function(t){var o=this.getProperty(e.Prop.BodyText,t);return null!=o&&o.setObjectProperty(this,e.Prop.BodyText),o},setBodyText:function(t){null!=t&&t.setObjectProperty(this,e.Prop.BodyText),this.setProperty(e.Prop.BodyText,t)},getSizes:function(t){var o=this.getProperty(e.Prop.Sizes,t);return null==o&&(o=new Ie,this.setProperty(e.Prop.Sizes,o,!1)),o.setObjectProperty(this,e.Prop.Sizes),o},getSourceId:function(t){return this.getProperty(e.Prop.SourceId,t)},setSourceId:function(t){this.setProperty(e.Prop.SourceId,t)},getOriginalSource:function(t){return this.getProperty(e.Prop.OriginalSource,t)},setOriginalSource:function(t){this.setProperty(e.Prop.OriginalSource,t)},getBodyImage:function(t){return this.getRelationshipFrom(e.Meaning.StatusUpdateContentHasImageContentPart,t)},setBodyImage:function(t){this.setRelationships(t?[t]:[],e.Meaning.StatusUpdateContentHasImageContentPart)},getProfileImage:function(t){return this.getRelationshipFrom(e.Meaning.StatusUpdateContentContainsImageContentPart,t)},setProfileImage:function(t){this.setRelationships(t?[t]:[],e.Meaning.StatusUpdateContentContainsImageContentPart)}},_={},O={},D={getAgaveId:function(t){return this.getProperty(e.Prop.AgaveId,t)},setAgaveId:function(t){this.setProperty(e.Prop.AgaveId,t)},getAgaveSettings:function(t){return this.getProperty(e.Prop.AgaveSettings,t)},setAgaveSettings:function(t){this.setProperty(e.Prop.AgaveSettings,t)}},E={getDownloadLink:function(t){return this.getProperty(e.Prop.DownloadLink,t)},setDownloadLink:function(t){this.setProperty(e.Prop.DownloadLink,t)},getExtension:function(t){return this.getProperty(e.Prop.Extension,t)},setExtension:function(t){this.setProperty(e.Prop.Extension,t)},getSize:function(t){return this.getProperty(e.Prop.Size,t)},setSize:function(t){this.setProperty(e.Prop.Size,t)},getProviderType:function(t){return this.getProperty(e.Prop.ProviderType,t).IntValue},setProviderType:function(t){this.setProperty(e.Prop.ProviderType,new o(t))},setProviderTypeInternal:function(t){this.setProperty(e.Prop.ProviderType,t)},getDocumentID:function(t){return this.getProperty(e.Prop.DocumentID,t)},setDocumentID:function(t){this.setProperty(e.Prop.DocumentID,t)},getCardState:function(t){return this.getProperty(e.Prop.CardState,t).IntValue},setCardState:function(t){this.setProperty(e.Prop.CardState,new o(t))},setCardStateInternal:function(t){this.setProperty(e.Prop.CardState,t)}},U={getCode:function(t){return this.getProperty(e.Prop.Code,t)},setCode:function(t){this.setProperty(e.Prop.Code,t)},getLanguage:function(t){return this.getProperty(e.Prop.Language,t)},setLanguage:function(t){this.setProperty(e.Prop.Language,t)}},L={getFontSetId:function(t){return this.getProperty(e.Prop.FontSetId,t)},setFontSetId:function(t){this.setProperty(e.Prop.FontSetId,t)},getBackgroundSetId:function(t){return this.getProperty(e.Prop.BackgroundSetId,t)},setBackgroundSetId:function(t){this.setProperty(e.Prop.BackgroundSetId,t)},getFilterSetId:function(t){return this.getProperty(e.Prop.FilterSetId,t)},setFilterSetId:function(t){this.setProperty(e.Prop.FilterSetId,t)},getCoverpageBackgroundsId:function(t){return this.getProperty(e.Prop.CoverpageBackgroundsId,t)},setCoverpageBackgroundsId:function(t){this.setProperty(e.Prop.CoverpageBackgroundsId,t)},getAnimationAmount:function(t){return this.getProperty(e.Prop.AnimationAmount,t).IntValue},setAnimationAmount:function(t){this.setProperty(e.Prop.AnimationAmount,new o(t))},setAnimationAmountInternal:function(t){this.setProperty(e.Prop.AnimationAmount,t)},getFontScale:function(t){return this.getProperty(e.Prop.FontScale,t)},setFontScale:function(t){this.setProperty(e.Prop.FontScale,t)},getSeedColorOverrides:function(t){return this.getRelationshipFrom(e.Meaning.StyleOverridesHasSeedColorOverrides,t)},setSeedColorOverrides:function(t){this.setRelationships(t?[t]:[],e.Meaning.StyleOverridesHasSeedColorOverrides)}},V={getColors:function(t){var o=this.getProperty(e.Prop.Colors,t);return null==o&&(o=new Ie,this.setProperty(e.Prop.Colors,o,!1)),o.setObjectProperty(this,e.Prop.Colors),o}},R={getVisualization:function(t){return this.getProperty(e.Prop.Visualization,t).IntValue},setVisualization:function(t){this.setProperty(e.Prop.Visualization,new o(t))},setVisualizationInternal:function(t){this.setProperty(e.Prop.Visualization,t)}},k={},j={getLanguage:function(t){return this.getProperty(e.Prop.Language,t)},setLanguage:function(t){this.setProperty(e.Prop.Language,t)},getFileName:function(t){return this.getProperty(e.Prop.FileName,t)},setFileName:function(t){this.setProperty(e.Prop.FileName,t)},getLabel:function(t){return this.getProperty(e.Prop.Label,t)},setLabel:function(t){this.setProperty(e.Prop.Label,t)},getContent:function(t){return this.getRelationshipFrom(e.Meaning.ClosedCaptionCompositeHasClosedCaptionContent,t)},setContent:function(t){this.setRelationships(t?[t]:[],e.Meaning.ClosedCaptionCompositeHasClosedCaptionContent)}},z={getIsDecorative:function(t){return this.getProperty(e.Prop.IsDecorative,t)},setIsDecorative:function(t){this.setProperty(e.Prop.IsDecorative,t)},getText:function(t){return this.getRelationshipFrom(e.Meaning.MediaWithTextCompositeHasTextGroup,t)},setText:function(t){this.setRelationships(t?[t]:[],e.Meaning.MediaWithTextCompositeHasTextGroup)},getDescription:function(t){return this.getRelationshipFrom(e.Meaning.MediaWithTextCompositeHasParagraph,t)},setDescription:function(t){this.setRelationships(t?[t]:[],e.Meaning.MediaWithTextCompositeHasParagraph)},getMedia:function(t){return this.getRelationshipFrom(e.Meaning.MediaWithTextCompositeHasMediaContent,t)},setMedia:function(t){this.setRelationships(t?[t]:[],e.Meaning.MediaWithTextCompositeHasMediaContent)}},x={getBackgroundPresent:function(t){return this.getProperty(e.Prop.BackgroundPresent,t)},setBackgroundPresent:function(t){this.setProperty(e.Prop.BackgroundPresent,t)},getTitle:function(t){return this.getRelationshipFrom(e.Meaning.TitleCompositeHasParagraph,t)},setTitle:function(t){this.setRelationships(t?[t]:[],e.Meaning.TitleCompositeHasParagraph)},getSubtitle:function(t){return this.getRelationshipFrom(e.Meaning.TitleCompositeHasSubtitleParagraph,t)},setSubtitle:function(t){this.setRelationships(t?[t]:[],e.Meaning.TitleCompositeHasSubtitleParagraph)},getAuthor:function(t){return this.getRelationshipFrom(e.Meaning.TitleCompositeHasAuthorParagraph,t)},setAuthor:function(t){this.setRelationships(t?[t]:[],e.Meaning.TitleCompositeHasAuthorParagraph)},getLogo:function(t){return this.getRelationshipFrom(e.Meaning.TitleCompositeHasLogoSpecifiedGroupChild,t)},setLogo:function(t){this.setRelationships(t?[t]:[],e.Meaning.TitleCompositeHasLogoSpecifiedGroupChild)},getBackground:function(t){return this.getRelationshipFrom(e.Meaning.TitleCompositeHasSpecifiedGroupChild,t)},setBackground:function(t){this.setRelationships(t?[t]:[],e.Meaning.TitleCompositeHasSpecifiedGroupChild)}},H={},N=function(t){function o(e,o,n){var i=t.call(this,null)||this;if(!o.graph.containsObject(e))throw new Error("Object does not exist.");return i.id=e,i.storyModel=o,i.objectType=n,i}return __extends(o,t),o.prototype.getProperty=function(e,t){var o=this;return o.storyModel.graph.getProperty(o.id,e,t)},o.prototype.setProperty=function(e,t,o){void 0===o&&(o=!0);var n=this;n.storyModel.graph.setProperty(n.id,e,t,o)},o.prototype.updateProperty=function(e){var t=this;t.storyModel.graph.updateProperty(t.id,e)},o.prototype.getRelationshipsFrom=function(e,t){var o=this,n=o.storyModel.graph.getObjectsRelatedFrom(o.id,e,t);if(!n)return[];for(var i=n.length,r=[],a=o.storyModel,s=0;s<i;s++)r.push(a.getModelObject(n[s]));return r},o.prototype.getRelationshipsTo=function(e,t){var o=this,n=o.storyModel.graph.getObjectsRelatedTo(o.id,e,t);if(!n)return[];for(var i=n.length,r=[],a=o.storyModel,s=0;s<i;s++)r.push(a.getModelObject(n[s]));return r},o.prototype.getRelationshipFrom=function(e,t){var o=this,n=o.storyModel.graph.getObjectsRelatedFrom(o.id,e,t);if(n&&0!=n.length)return o.storyModel.getModelObject(n[0])},o.prototype.getRelationshipTo=function(e,t){var o=this,n=o.storyModel.graph.getObjectsRelatedTo(o.id,e,t);if(n&&0!=n.length)return o.storyModel.getModelObject(n[0])},o.prototype.addRelationship=function(e,t,o){var n=this;n.storyModel.graph.addRelationship(n.id,e.id,t,o)},o.prototype.removeRelationship=function(e,t){var o=this;o.storyModel.graph.removeRelationship(o.id,e.id,t)},o.prototype.setRelationships=function(e,t){for(var o=this,n=e.length,i=[],r=0;r<n;r++)i.push(e[r].id);o.storyModel.graph.setRelationships(o.id,i,t)},o.prototype.getExternalDataId=function(t){var o=this,n=o.storyModel.graph,i=n.getObjectsRelatedFrom(o.id,e.Meaning.ExternalData,t);return i&&i.length>0?n.getExternalDataId(i[0]):void 0},o}(DisposableObjectOM);e.ModelObject=N;var F=function(o){function n(t,n){var i=o.call(this,t,n,e.ObjectType.AffinityModel)||this;return i.model=n.affinityModel,i}return __extends(n,o),n.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.AffinityModel,o);return t.getModelObject(n)},n.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};return n.id=o.id,void 0!==t[o.id]?(n.ref=!0,n):(n.objType=e.ObjectType[e.ObjectType.AffinityModel],t[o.id]=!0,n)},n.Deserialize=function(e,o,n){var i=o.id;if(n&&(n[o.id]||(n[o.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),i=n[o.id]),o.ref)return e.getModelObject(i);return e.getModelObject("AffinityRoot")},n}(N);e.AffinityModel=F,n(F,i);var B=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.ImageContentPart)||this;return i.model=o.affinityModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.ImageContentPart,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.ImageContentPart],t[o.id]=!0;var i=o.getProperty(e.Prop.Type);-1===i.IntValue?n.type=i.StringValue:n.type=e.ImageCategory[i.IntValue];var r=o.getProperty(e.Prop.Semantic);-1===r.IntValue?n.semantic=r.StringValue:n.semantic=e.ImageSemantic[r.IntValue],n.sourceUrl=o.getSourceUrl(),null!=o.getCopyInfo()&&(n.copyInfo=o.getCopyInfo().serialize()),n.width=o.getWidth(),n.height=o.getHeight(),null!=o.getFocusRegions()&&(n.focusRegions=o.getFocusRegions().serialize());var a=o.getProperty(e.Prop.CropState);return-1===a.IntValue?n.cropState=a.StringValue:n.cropState=e.ImageCropState[a.IntValue],n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.ImageContentPart,a),l=n.getModelObject(s);if(void 0!==i.type&&(void 0!==(c=e.ImageCategory[i.type])?l.setTypeInternal(new o(c)):l.setTypeInternal(new o(i.type))),void 0!==i.semantic&&(void 0!==(c=e.ImageSemantic[i.semantic])?l.setSemanticInternal(new o(c)):l.setSemanticInternal(new o(i.semantic))),void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.copyInfo&&l.setCopyInfo(Qe.Deserialize(i.copyInfo)),void 0!==i.width&&l.setWidth(i.width),void 0!==i.height&&l.setHeight(i.height),void 0!==i.focusRegions&&l.getFocusRegions().deserializeStructCollection(i.focusRegions,He.Deserialize),void 0!==i.cropState){var c=e.ImageCropState[i.cropState];void 0!==c?l.setCropStateInternal(new o(c)):l.setCropStateInternal(new o(i.cropState))}return l},i}(N);e.ImageContentPart=B,n(B,r),n(B,a);var G=function(o){function n(t,n){var i=o.call(this,t,n,e.ObjectType.TraversalModel)||this;return i.model=n.traversalModel,i}return __extends(n,o),n.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.TraversalModel,o);return t.getModelObject(n)},n.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};return n.id=o.id,void 0!==t[o.id]?(n.ref=!0,n):(n.objType=e.ObjectType[e.ObjectType.TraversalModel],t[o.id]=!0,n.styleId=o.getStyleId(),n.colorOptionId=o.getColorOptionId(),n.allowRemoteDesignObjects=o.getAllowRemoteDesignObjects(),n.suggestionsUpdateRequired=o.getSuggestionsUpdateRequired(),n.worldId=o.getWorldId(),null!=o.getColorPalette()&&(n.colorPalette=o.getColorPalette().serialize()),n.culture=o.getCulture(),n.hideEndOfSway=o.getHideEndOfSway(),n.rTL=o.getRTL(),null!=o.getAutoPlaySettings()&&(n.autoPlaySettings=o.getAutoPlaySettings().serialize()),null!=o.getCustomColors()&&(n.customColors=o.getCustomColors().serialize()),void 0!==o.getSpecifiedGrouping()&&(n.specifiedGrouping=o.getSpecifiedGrouping().serialize(t)),void 0!==o.getStyleOverrides()&&(n.styleOverrides=o.getStyleOverrides().serialize(t)),n)},n.Deserialize=function(e,o,n){var i=o.id;if(n&&(n[o.id]||(n[o.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),i=n[o.id]),o.ref)return e.getModelObject(i);var r=e.getModelObject("TraversalRoot");return void 0!==o.styleId&&r.setStyleId(o.styleId),void 0!==o.colorOptionId&&r.setColorOptionId(o.colorOptionId),void 0!==o.allowRemoteDesignObjects&&r.setAllowRemoteDesignObjects(o.allowRemoteDesignObjects),void 0!==o.suggestionsUpdateRequired&&r.setSuggestionsUpdateRequired(o.suggestionsUpdateRequired),void 0!==o.worldId&&r.setWorldId(o.worldId),void 0!==o.colorPalette&&r.getColorPalette().deserializeStructCollection(o.colorPalette,Be.Deserialize),void 0!==o.culture&&r.setCulture(o.culture),void 0!==o.hideEndOfSway&&r.setHideEndOfSway(o.hideEndOfSway),void 0!==o.rTL&&r.setRTL(o.rTL),void 0!==o.autoPlaySettings&&r.setAutoPlaySettings($e.Deserialize(o.autoPlaySettings)),void 0!==o.customColors&&r.getCustomColors().deserializePropertyCollection(o.customColors),void 0!==o.specifiedGrouping&&r.setSpecifiedGrouping(e.deserialize(o.specifiedGrouping,n)),void 0!==o.styleOverrides&&r.setStyleOverrides(e.deserialize(o.styleOverrides,n)),r},n}(N);e.TraversalModel=G,n(G,s);var W=function(o){function n(t,n){var i=o.call(this,t,n,e.ObjectType.SpecifiedGrouping)||this;return i.model=n.traversalModel,i}return __extends(n,o),n.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.SpecifiedGrouping,o);return t.getModelObject(n)},n.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};return n.id=o.id,void 0!==t[o.id]?(n.ref=!0,n):(n.objType=e.ObjectType[e.ObjectType.SpecifiedGrouping],t[o.id]=!0,n.enabled=o.getEnabled(),void 0!==o.getRootGroup()&&(n.rootGroup=o.getRootGroup().serialize(t)),n)},n.Deserialize=function(o,n,i){var r=n.id;if(i&&(i[n.id]||(i[n.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),r=i[n.id]),n.ref)return o.getModelObject(r);var a=o.graph.createObject(e.ObjectType.SpecifiedGrouping,r),s=o.getModelObject(a);return void 0!==n.enabled&&s.setEnabled(n.enabled),void 0!==n.rootGroup&&s.setRootGroup(o.deserialize(n.rootGroup,i)),s},n}(N);e.SpecifiedGrouping=W,n(W,l),n(W,c);var q=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.SpecifiedGroup)||this;return i.model=o.traversalModel,i.children=new Ce(i,e.Meaning.SpecifiedGroupHasSpecifiedGroupChild),i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.SpecifiedGroup,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.SpecifiedGroup],t[o.id]=!0,n.title=o.getTitle();var i=o.getProperty(e.Prop.Visualization);-1===i.IntValue?n.visualization=i.StringValue:n.visualization=e.Visualization[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);return-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue],n.children=o.children.serialize(t),void 0!==o.getHeading()&&(n.heading=o.getHeading().serialize(t)),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.SpecifiedGroup,a),l=n.getModelObject(s);if(void 0!==i.title&&l.setTitle(i.title),void 0!==i.visualization&&(void 0!==(c=e.Visualization[i.visualization])?l.setVisualizationInternal(new o(c)):l.setVisualizationInternal(new o(i.visualization))),void 0!==i.contentSource){var c=e.ContentCreator[i.contentSource];void 0!==c?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))}return void 0!==i.children&&l.children.deserialize(i.children,r),void 0!==i.heading&&l.setHeading(n.deserialize(i.heading,r)),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.SpecifiedGroup=q,n(q,u),n(q,C),n(q,p);var Q=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.Table)||this;return i.model=o.traversalModel,i.rows=new Ce(i,e.Meaning.TableHasTableRow),i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.Table,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.Table],t[o.id]=!0,n.hTML=o.getHTML(),null!=o.getTableBorders()&&(n.tableBorders=o.getTableBorders().serialize());var i=o.getProperty(e.Prop.ContentSource);-1===i.IntValue?n.contentSource=i.StringValue:n.contentSource=e.ContentCreator[i.IntValue];var r=o.getProperty(e.Prop.Emphasis);return-1===r.IntValue?n.emphasis=r.StringValue:n.emphasis=e.EmphasisLevel[r.IntValue],n.rows=o.rows.serialize(t),void 0!==o.getImageRepresentation()&&(n.imageRepresentation=o.getImageRepresentation().serialize(t)),void 0!==o.getCaption()&&(n.caption=o.getCaption().serialize(t)),void 0!==o.getDescription()&&(n.description=o.getDescription().serialize(t)),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.Table,a),l=n.getModelObject(s);if(void 0!==i.hTML&&l.setHTML(i.hTML),void 0!==i.tableBorders&&l.getTableBorders().deserializePropertyCollection(i.tableBorders),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.rows&&l.rows.deserialize(i.rows,r),void 0!==i.imageRepresentation&&l.setImageRepresentation(n.deserialize(i.imageRepresentation,r)),void 0!==i.caption&&l.setCaption(n.deserialize(i.caption,r)),void 0!==i.description&&l.setDescription(n.deserialize(i.description,r)),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.Table=Q,n(Q,C),n(Q,h),n(Q,d);var $=function(o){function n(t,n){var i=o.call(this,t,n,e.ObjectType.TableRow)||this;return i.model=n.traversalModel,i.cells=new Ce(i,e.Meaning.TableRowHasTableCell),i}return __extends(n,o),n.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.TableRow,o);return t.getModelObject(n)},n.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};return n.id=o.id,void 0!==t[o.id]?(n.ref=!0,n):(n.objType=e.ObjectType[e.ObjectType.TableRow],t[o.id]=!0,n.heightPercentage=o.getHeightPercentage(),null!=o.getTableRowBorders()&&(n.tableRowBorders=o.getTableRowBorders().serialize()),n.cells=o.cells.serialize(t),n)},n.Deserialize=function(o,n,i){var r=n.id;if(i&&(i[n.id]||(i[n.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),r=i[n.id]),n.ref)return o.getModelObject(r);var a=o.graph.createObject(e.ObjectType.TableRow,r),s=o.getModelObject(a);return void 0!==n.heightPercentage&&s.setHeightPercentage(n.heightPercentage),void 0!==n.tableRowBorders&&s.getTableRowBorders().deserializePropertyCollection(n.tableRowBorders),void 0!==n.cells&&s.cells.deserialize(n.cells,i),s},n}(N);e.TableRow=$,n($,g);var J=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.TableCell)||this;return i.model=o.traversalModel,i.children=new Ce(i,e.Meaning.TableCellHasSpecifiedGroupChild),i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.TableCell,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.TableCell],t[o.id]=!0,n.widthPercentage=o.getWidthPercentage(),n.columnSpan=o.getColumnSpan(),n.rowSpan=o.getRowSpan();var i=o.getProperty(e.Prop.CellType);-1===i.IntValue?n.cellType=i.StringValue:n.cellType=e.CellType[i.IntValue];var r=o.getProperty(e.Prop.CellVerticalAlignment);return-1===r.IntValue?n.cellVerticalAlignment=r.StringValue:n.cellVerticalAlignment=e.CellVerticalAlignment[r.IntValue],null!=o.getTableCellBorders()&&(n.tableCellBorders=o.getTableCellBorders().serialize()),n.children=o.children.serialize(t),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.TableCell,a),l=n.getModelObject(s);if(void 0!==i.widthPercentage&&l.setWidthPercentage(i.widthPercentage),void 0!==i.columnSpan&&l.setColumnSpan(i.columnSpan),void 0!==i.rowSpan&&l.setRowSpan(i.rowSpan),void 0!==i.cellType&&(void 0!==(c=e.CellType[i.cellType])?l.setCellTypeInternal(new o(c)):l.setCellTypeInternal(new o(i.cellType))),void 0!==i.cellVerticalAlignment){var c=e.CellVerticalAlignment[i.cellVerticalAlignment];void 0!==c?l.setCellVerticalAlignmentInternal(new o(c)):l.setCellVerticalAlignmentInternal(new o(i.cellVerticalAlignment))}return void 0!==i.tableCellBorders&&l.getTableCellBorders().deserializePropertyCollection(i.tableCellBorders),void 0!==i.children&&l.children.deserialize(i.children,r),l},i}(N);e.TableCell=J,n(J,y);var K=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.TextGroup)||this;return i.model=o.traversalModel,i.children=new Ce(i,e.Meaning.TextGroupHasTextGroupChild),i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.TextGroup,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.TextGroup],t[o.id]=!0;var i=o.getProperty(e.Prop.ListStyle);-1===i.IntValue?n.listStyle=i.StringValue:n.listStyle=e.ListStyle[i.IntValue];var r=o.getProperty(e.Prop.Direction);-1===r.IntValue?n.direction=r.StringValue:n.direction=e.TextDirection[r.IntValue];var a=o.getProperty(e.Prop.Visualization);-1===a.IntValue?n.visualization=a.StringValue:n.visualization=e.Visualization[a.IntValue];var s=o.getProperty(e.Prop.ContentSource);-1===s.IntValue?n.contentSource=s.StringValue:n.contentSource=e.ContentCreator[s.IntValue];var l=o.getProperty(e.Prop.Emphasis);-1===l.IntValue?n.emphasis=l.StringValue:n.emphasis=e.EmphasisLevel[l.IntValue];var c=o.getProperty(e.Prop.TextHorizontalAlignment);return-1===c.IntValue?n.textHorizontalAlignment=c.StringValue:n.textHorizontalAlignment=e.TextHorizontalAlignment[c.IntValue],n.children=o.children.serialize(t),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.TextGroup,a),l=n.getModelObject(s);if(void 0!==i.listStyle&&(void 0!==(c=e.ListStyle[i.listStyle])?l.setListStyleInternal(new o(c)):l.setListStyleInternal(new o(i.listStyle))),void 0!==i.direction&&(void 0!==(c=e.TextDirection[i.direction])?l.setDirectionInternal(new o(c)):l.setDirectionInternal(new o(i.direction))),void 0!==i.visualization&&(void 0!==(c=e.Visualization[i.visualization])?l.setVisualizationInternal(new o(c)):l.setVisualizationInternal(new o(i.visualization))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.emphasis&&(void 0!==(c=e.EmphasisLevel[i.emphasis])?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))),void 0!==i.textHorizontalAlignment){var c=e.TextHorizontalAlignment[i.textHorizontalAlignment];void 0!==c?l.setTextHorizontalAlignmentInternal(new o(c)):l.setTextHorizontalAlignmentInternal(new o(i.textHorizontalAlignment))}return void 0!==i.children&&l.children.deserialize(i.children,r),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.TextGroup=K,n(K,R),n(K,m),n(K,f),n(K,C),n(K,h),n(K,S);var Y=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.TextGroupChild)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.TextGroupChild,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.TextGroupChild],t[o.id]=!0;var i=o.getProperty(e.Prop.TextHorizontalAlignment);-1===i.IntValue?n.textHorizontalAlignment=i.StringValue:n.textHorizontalAlignment=e.TextHorizontalAlignment[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue];var a=o.getProperty(e.Prop.Emphasis);return-1===a.IntValue?n.emphasis=a.StringValue:n.emphasis=e.EmphasisLevel[a.IntValue],void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.TextGroupChild,a),l=n.getModelObject(s);if(void 0!==i.textHorizontalAlignment&&(void 0!==(c=e.TextHorizontalAlignment[i.textHorizontalAlignment])?l.setTextHorizontalAlignmentInternal(new o(c)):l.setTextHorizontalAlignmentInternal(new o(i.textHorizontalAlignment))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.TextGroupChild=Y,n(Y,C),n(Y,h),n(Y,m);var X=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.Paragraph)||this;return i.model=o.traversalModel,i.children=new Ce(i,e.Meaning.ParagraphHasParagraph),i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.Paragraph,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.Paragraph],t[o.id]=!0,null!=o.getContent()&&(n.content=o.getContent().serialize());var i=o.getProperty(e.Prop.ListStyle);-1===i.IntValue?n.listStyle=i.StringValue:n.listStyle=e.ListStyle[i.IntValue];var r=o.getProperty(e.Prop.Direction);-1===r.IntValue?n.direction=r.StringValue:n.direction=e.TextDirection[r.IntValue];var a=o.getProperty(e.Prop.ProviderType);-1===a.IntValue?n.providerType=a.StringValue:n.providerType=e.ContentProvider[a.IntValue];var s=o.getProperty(e.Prop.TextHorizontalAlignment);-1===s.IntValue?n.textHorizontalAlignment=s.StringValue:n.textHorizontalAlignment=e.TextHorizontalAlignment[s.IntValue];var l=o.getProperty(e.Prop.ContentSource);-1===l.IntValue?n.contentSource=l.StringValue:n.contentSource=e.ContentCreator[l.IntValue];var c=o.getProperty(e.Prop.Emphasis);return-1===c.IntValue?n.emphasis=c.StringValue:n.emphasis=e.EmphasisLevel[c.IntValue],n.children=o.children.serialize(t),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.Paragraph,a),l=n.getModelObject(s);if(void 0!==i.content&&l.setContent(ze.Deserialize(i.content)),void 0!==i.listStyle&&(void 0!==(c=e.ListStyle[i.listStyle])?l.setListStyleInternal(new o(c)):l.setListStyleInternal(new o(i.listStyle))),void 0!==i.direction&&(void 0!==(c=e.TextDirection[i.direction])?l.setDirectionInternal(new o(c)):l.setDirectionInternal(new o(i.direction))),void 0!==i.providerType&&(void 0!==(c=e.ContentProvider[i.providerType])?l.setProviderTypeInternal(new o(c)):l.setProviderTypeInternal(new o(i.providerType))),void 0!==i.textHorizontalAlignment&&(void 0!==(c=e.TextHorizontalAlignment[i.textHorizontalAlignment])?l.setTextHorizontalAlignmentInternal(new o(c)):l.setTextHorizontalAlignmentInternal(new o(i.textHorizontalAlignment))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.children&&l.children.deserialize(i.children,r),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.Paragraph=X,n(X,m),n(X,C),n(X,h),n(X,v);var Z=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.ImageContent)||this;return i.model=o.traversalModel,i.imageParts=new Ce(i,e.Meaning.ImageContentHasImageContentPart),i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.ImageContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.ImageContent],t[o.id]=!0,n.originalWidth=o.getOriginalWidth(),n.originalHeight=o.getOriginalHeight(),n.isAugmentationCached=o.getIsAugmentationCached(),n.sourceUrl=o.getSourceUrl(),n.summary=o.getSummary(),n.title=o.getTitle(),null!=o.getDecompInfo()&&(n.decompInfo=o.getDecompInfo().serialize()),null!=o.getUploadInfo()&&(n.uploadInfo=o.getUploadInfo().serialize()),null!=o.getVisualOverrides()&&(n.visualOverrides=o.getVisualOverrides().serialize());var i=o.getProperty(e.Prop.Availability);-1===i.IntValue?n.availability=i.StringValue:n.availability=e.ContentAvailability[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue],n.author=o.getAuthor(),n.timestamp=o.getTimestamp(),n.attribution=o.getAttribution(),null!=o.getGeoCoordinate()&&(n.geoCoordinate=o.getGeoCoordinate().serialize()),n.authorUserName=o.getAuthorUserName(),n.licenseName=o.getLicenseName(),n.licenseLink=o.getLicenseLink();var a=o.getProperty(e.Prop.Emphasis);return-1===a.IntValue?n.emphasis=a.StringValue:n.emphasis=e.EmphasisLevel[a.IntValue],n.imageParts=o.imageParts.serialize(t),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.ImageContent,a),l=n.getModelObject(s);if(void 0!==i.originalWidth&&l.setOriginalWidth(i.originalWidth),void 0!==i.originalHeight&&l.setOriginalHeight(i.originalHeight),void 0!==i.isAugmentationCached&&l.setIsAugmentationCached(i.isAugmentationCached),void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.summary&&l.setSummary(i.summary),void 0!==i.title&&l.setTitle(i.title),void 0!==i.decompInfo&&l.setDecompInfo(Ne.Deserialize(i.decompInfo)),void 0!==i.uploadInfo&&l.setUploadInfo(qe.Deserialize(i.uploadInfo)),void 0!==i.visualOverrides&&l.setVisualOverrides(Ge.Deserialize(i.visualOverrides)),void 0!==i.availability&&(void 0!==(c=e.ContentAvailability[i.availability])?l.setAvailabilityInternal(new o(c)):l.setAvailabilityInternal(new o(i.availability))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.author&&l.setAuthor(i.author),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.attribution&&l.setAttribution(i.attribution),void 0!==i.geoCoordinate&&l.setGeoCoordinate(je.Deserialize(i.geoCoordinate)),void 0!==i.authorUserName&&l.setAuthorUserName(i.authorUserName),void 0!==i.licenseName&&l.setLicenseName(i.licenseName),void 0!==i.licenseLink&&l.setLicenseLink(i.licenseLink),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.imageParts&&l.imageParts.deserialize(i.imageParts,r),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.ImageContent=Z,n(Z,I),n(Z,C),n(Z,P),n(Z,h),n(Z,T);var ee=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.VideoContent)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.VideoContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.VideoContent],t[o.id]=!0,n.videoPlayerDescriptor=o.getVideoPlayerDescriptor(),n.duration=o.getDuration(),n.size=o.getSize(),n.sourceUrl=o.getSourceUrl(),n.summary=o.getSummary(),n.title=o.getTitle(),null!=o.getDecompInfo()&&(n.decompInfo=o.getDecompInfo().serialize()),null!=o.getUploadInfo()&&(n.uploadInfo=o.getUploadInfo().serialize()),null!=o.getVisualOverrides()&&(n.visualOverrides=o.getVisualOverrides().serialize());var i=o.getProperty(e.Prop.Availability);-1===i.IntValue?n.availability=i.StringValue:n.availability=e.ContentAvailability[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue],n.author=o.getAuthor(),n.timestamp=o.getTimestamp(),n.attribution=o.getAttribution(),null!=o.getGeoCoordinate()&&(n.geoCoordinate=o.getGeoCoordinate().serialize()),n.authorUserName=o.getAuthorUserName(),n.licenseName=o.getLicenseName(),n.licenseLink=o.getLicenseLink();var a=o.getProperty(e.Prop.Emphasis);return-1===a.IntValue?n.emphasis=a.StringValue:n.emphasis=e.EmphasisLevel[a.IntValue],void 0!==o.getThumbnail()&&(n.thumbnail=o.getThumbnail().serialize(t)),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.VideoContent,a),l=n.getModelObject(s);if(void 0!==i.videoPlayerDescriptor&&l.setVideoPlayerDescriptor(i.videoPlayerDescriptor),void 0!==i.duration&&l.setDuration(i.duration),void 0!==i.size&&l.setSize(i.size),void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.summary&&l.setSummary(i.summary),void 0!==i.title&&l.setTitle(i.title),void 0!==i.decompInfo&&l.setDecompInfo(Ne.Deserialize(i.decompInfo)),void 0!==i.uploadInfo&&l.setUploadInfo(qe.Deserialize(i.uploadInfo)),void 0!==i.visualOverrides&&l.setVisualOverrides(Ge.Deserialize(i.visualOverrides)),void 0!==i.availability&&(void 0!==(c=e.ContentAvailability[i.availability])?l.setAvailabilityInternal(new o(c)):l.setAvailabilityInternal(new o(i.availability))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.author&&l.setAuthor(i.author),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.attribution&&l.setAttribution(i.attribution),void 0!==i.geoCoordinate&&l.setGeoCoordinate(je.Deserialize(i.geoCoordinate)),void 0!==i.authorUserName&&l.setAuthorUserName(i.authorUserName),void 0!==i.licenseName&&l.setLicenseName(i.licenseName),void 0!==i.licenseLink&&l.setLicenseLink(i.licenseLink),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.thumbnail&&l.setThumbnail(n.deserialize(i.thumbnail,r)),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.VideoContent=ee,n(ee,I),n(ee,C),n(ee,P),n(ee,h),n(ee,M);var te=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.AudioContent)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.AudioContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.AudioContent],t[o.id]=!0,n.audioPlayerDescriptor=o.getAudioPlayerDescriptor(),n.duration=o.getDuration(),n.size=o.getSize(),null!=o.getCopyInfo()&&(n.copyInfo=o.getCopyInfo().serialize()),n.sourceUrl=o.getSourceUrl(),n.summary=o.getSummary(),n.title=o.getTitle(),null!=o.getDecompInfo()&&(n.decompInfo=o.getDecompInfo().serialize()),null!=o.getUploadInfo()&&(n.uploadInfo=o.getUploadInfo().serialize()),null!=o.getVisualOverrides()&&(n.visualOverrides=o.getVisualOverrides().serialize());var i=o.getProperty(e.Prop.Availability);-1===i.IntValue?n.availability=i.StringValue:n.availability=e.ContentAvailability[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue],n.author=o.getAuthor(),n.timestamp=o.getTimestamp(),n.attribution=o.getAttribution(),null!=o.getGeoCoordinate()&&(n.geoCoordinate=o.getGeoCoordinate().serialize()),n.authorUserName=o.getAuthorUserName(),n.licenseName=o.getLicenseName(),n.licenseLink=o.getLicenseLink();var a=o.getProperty(e.Prop.Emphasis);return-1===a.IntValue?n.emphasis=a.StringValue:n.emphasis=e.EmphasisLevel[a.IntValue],void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.AudioContent,a),l=n.getModelObject(s);if(void 0!==i.audioPlayerDescriptor&&l.setAudioPlayerDescriptor(i.audioPlayerDescriptor),void 0!==i.duration&&l.setDuration(i.duration),void 0!==i.size&&l.setSize(i.size),void 0!==i.copyInfo&&l.setCopyInfo(Qe.Deserialize(i.copyInfo)),void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.summary&&l.setSummary(i.summary),void 0!==i.title&&l.setTitle(i.title),void 0!==i.decompInfo&&l.setDecompInfo(Ne.Deserialize(i.decompInfo)),void 0!==i.uploadInfo&&l.setUploadInfo(qe.Deserialize(i.uploadInfo)),void 0!==i.visualOverrides&&l.setVisualOverrides(Ge.Deserialize(i.visualOverrides)),void 0!==i.availability&&(void 0!==(c=e.ContentAvailability[i.availability])?l.setAvailabilityInternal(new o(c)):l.setAvailabilityInternal(new o(i.availability))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.author&&l.setAuthor(i.author),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.attribution&&l.setAttribution(i.attribution),void 0!==i.geoCoordinate&&l.setGeoCoordinate(je.Deserialize(i.geoCoordinate)),void 0!==i.authorUserName&&l.setAuthorUserName(i.authorUserName),void 0!==i.licenseName&&l.setLicenseName(i.licenseName),void 0!==i.licenseLink&&l.setLicenseLink(i.licenseLink),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.AudioContent=te,n(te,I),n(te,C),n(te,P),n(te,h),n(te,b);var oe=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.EmbeddedContent)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.EmbeddedContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.EmbeddedContent],t[o.id]=!0,n.embedCode=o.getEmbedCode(),n.height=o.getHeight(),n.width=o.getWidth();var i=o.getProperty(e.Prop.ProviderType);-1===i.IntValue?n.providerType=i.StringValue:n.providerType=e.ContentProvider[i.IntValue],n.documentID=o.getDocumentID();var r=o.getProperty(e.Prop.CardState);-1===r.IntValue?n.cardState=r.StringValue:n.cardState=e.UploadStatus[r.IntValue],n.strictSizing=o.getStrictSizing(),n.sourceUrl=o.getSourceUrl(),n.summary=o.getSummary(),n.title=o.getTitle(),null!=o.getDecompInfo()&&(n.decompInfo=o.getDecompInfo().serialize()),null!=o.getUploadInfo()&&(n.uploadInfo=o.getUploadInfo().serialize()),null!=o.getVisualOverrides()&&(n.visualOverrides=o.getVisualOverrides().serialize());var a=o.getProperty(e.Prop.Availability);-1===a.IntValue?n.availability=a.StringValue:n.availability=e.ContentAvailability[a.IntValue];var s=o.getProperty(e.Prop.ContentSource);-1===s.IntValue?n.contentSource=s.StringValue:n.contentSource=e.ContentCreator[s.IntValue],n.author=o.getAuthor(),n.timestamp=o.getTimestamp(),n.attribution=o.getAttribution(),null!=o.getGeoCoordinate()&&(n.geoCoordinate=o.getGeoCoordinate().serialize()),n.authorUserName=o.getAuthorUserName(),n.licenseName=o.getLicenseName(),n.licenseLink=o.getLicenseLink();var l=o.getProperty(e.Prop.Emphasis);return-1===l.IntValue?n.emphasis=l.StringValue:n.emphasis=e.EmphasisLevel[l.IntValue],void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.EmbeddedContent,a),l=n.getModelObject(s);if(void 0!==i.embedCode&&l.setEmbedCode(i.embedCode),void 0!==i.height&&l.setHeight(i.height),void 0!==i.width&&l.setWidth(i.width),void 0!==i.providerType&&(void 0!==(c=e.ContentProvider[i.providerType])?l.setProviderTypeInternal(new o(c)):l.setProviderTypeInternal(new o(i.providerType))),void 0!==i.documentID&&l.setDocumentID(i.documentID),void 0!==i.cardState&&(void 0!==(c=e.UploadStatus[i.cardState])?l.setCardStateInternal(new o(c)):l.setCardStateInternal(new o(i.cardState))),void 0!==i.strictSizing&&l.setStrictSizing(i.strictSizing),void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.summary&&l.setSummary(i.summary),void 0!==i.title&&l.setTitle(i.title),void 0!==i.decompInfo&&l.setDecompInfo(Ne.Deserialize(i.decompInfo)),void 0!==i.uploadInfo&&l.setUploadInfo(qe.Deserialize(i.uploadInfo)),void 0!==i.visualOverrides&&l.setVisualOverrides(Ge.Deserialize(i.visualOverrides)),void 0!==i.availability&&(void 0!==(c=e.ContentAvailability[i.availability])?l.setAvailabilityInternal(new o(c)):l.setAvailabilityInternal(new o(i.availability))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.author&&l.setAuthor(i.author),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.attribution&&l.setAttribution(i.attribution),void 0!==i.geoCoordinate&&l.setGeoCoordinate(je.Deserialize(i.geoCoordinate)),void 0!==i.authorUserName&&l.setAuthorUserName(i.authorUserName),void 0!==i.licenseName&&l.setLicenseName(i.licenseName),void 0!==i.licenseLink&&l.setLicenseLink(i.licenseLink),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.EmbeddedContent=oe,n(oe,I),n(oe,C),n(oe,P),n(oe,h),n(oe,A);var ne=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.StatusUpdateContent)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.StatusUpdateContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.StatusUpdateContent],t[o.id]=!0,null!=o.getBodyText()&&(n.bodyText=o.getBodyText().serialize()),null!=o.getSizes()&&(n.sizes=o.getSizes().serialize()),n.sourceId=o.getSourceId(),n.originalSource=o.getOriginalSource(),n.sourceUrl=o.getSourceUrl(),n.summary=o.getSummary(),n.title=o.getTitle(),null!=o.getDecompInfo()&&(n.decompInfo=o.getDecompInfo().serialize()),null!=o.getUploadInfo()&&(n.uploadInfo=o.getUploadInfo().serialize()),null!=o.getVisualOverrides()&&(n.visualOverrides=o.getVisualOverrides().serialize());var i=o.getProperty(e.Prop.Availability);-1===i.IntValue?n.availability=i.StringValue:n.availability=e.ContentAvailability[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue],n.author=o.getAuthor(),n.timestamp=o.getTimestamp(),n.attribution=o.getAttribution(),null!=o.getGeoCoordinate()&&(n.geoCoordinate=o.getGeoCoordinate().serialize()),n.authorUserName=o.getAuthorUserName(),n.licenseName=o.getLicenseName(),n.licenseLink=o.getLicenseLink();var a=o.getProperty(e.Prop.Emphasis);return-1===a.IntValue?n.emphasis=a.StringValue:n.emphasis=e.EmphasisLevel[a.IntValue],void 0!==o.getBodyImage()&&(n.bodyImage=o.getBodyImage().serialize(t)),void 0!==o.getProfileImage()&&(n.profileImage=o.getProfileImage().serialize(t)),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.StatusUpdateContent,a),l=n.getModelObject(s);if(void 0!==i.bodyText&&l.setBodyText(ze.Deserialize(i.bodyText)),void 0!==i.sizes&&l.getSizes().deserializeStructCollection(i.sizes,We.Deserialize),void 0!==i.sourceId&&l.setSourceId(i.sourceId),void 0!==i.originalSource&&l.setOriginalSource(i.originalSource),void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.summary&&l.setSummary(i.summary),void 0!==i.title&&l.setTitle(i.title),void 0!==i.decompInfo&&l.setDecompInfo(Ne.Deserialize(i.decompInfo)),void 0!==i.uploadInfo&&l.setUploadInfo(qe.Deserialize(i.uploadInfo)),void 0!==i.visualOverrides&&l.setVisualOverrides(Ge.Deserialize(i.visualOverrides)),void 0!==i.availability&&(void 0!==(c=e.ContentAvailability[i.availability])?l.setAvailabilityInternal(new o(c)):l.setAvailabilityInternal(new o(i.availability))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.author&&l.setAuthor(i.author),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.attribution&&l.setAttribution(i.attribution),void 0!==i.geoCoordinate&&l.setGeoCoordinate(je.Deserialize(i.geoCoordinate)),void 0!==i.authorUserName&&l.setAuthorUserName(i.authorUserName),void 0!==i.licenseName&&l.setLicenseName(i.licenseName),void 0!==i.licenseLink&&l.setLicenseLink(i.licenseLink),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.bodyImage&&l.setBodyImage(n.deserialize(i.bodyImage,r)),void 0!==i.profileImage&&l.setProfileImage(n.deserialize(i.profileImage,r)),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.StatusUpdateContent=ne,n(ne,I),n(ne,C),n(ne,P),n(ne,h),n(ne,w);var ie=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.DocumentContent)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.DocumentContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.DocumentContent],t[o.id]=!0,n.sourceUrl=o.getSourceUrl(),n.summary=o.getSummary(),n.title=o.getTitle(),null!=o.getDecompInfo()&&(n.decompInfo=o.getDecompInfo().serialize()),null!=o.getUploadInfo()&&(n.uploadInfo=o.getUploadInfo().serialize()),null!=o.getVisualOverrides()&&(n.visualOverrides=o.getVisualOverrides().serialize());var i=o.getProperty(e.Prop.Availability);-1===i.IntValue?n.availability=i.StringValue:n.availability=e.ContentAvailability[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue],n.author=o.getAuthor(),n.timestamp=o.getTimestamp(),n.attribution=o.getAttribution(),null!=o.getGeoCoordinate()&&(n.geoCoordinate=o.getGeoCoordinate().serialize()),n.authorUserName=o.getAuthorUserName(),n.licenseName=o.getLicenseName(),n.licenseLink=o.getLicenseLink();var a=o.getProperty(e.Prop.Emphasis);return-1===a.IntValue?n.emphasis=a.StringValue:n.emphasis=e.EmphasisLevel[a.IntValue],void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.DocumentContent,a),l=n.getModelObject(s);if(void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.summary&&l.setSummary(i.summary),void 0!==i.title&&l.setTitle(i.title),void 0!==i.decompInfo&&l.setDecompInfo(Ne.Deserialize(i.decompInfo)),void 0!==i.uploadInfo&&l.setUploadInfo(qe.Deserialize(i.uploadInfo)),void 0!==i.visualOverrides&&l.setVisualOverrides(Ge.Deserialize(i.visualOverrides)),void 0!==i.availability&&(void 0!==(c=e.ContentAvailability[i.availability])?l.setAvailabilityInternal(new o(c)):l.setAvailabilityInternal(new o(i.availability))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.author&&l.setAuthor(i.author),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.attribution&&l.setAttribution(i.attribution),void 0!==i.geoCoordinate&&l.setGeoCoordinate(je.Deserialize(i.geoCoordinate)),void 0!==i.authorUserName&&l.setAuthorUserName(i.authorUserName),void 0!==i.licenseName&&l.setLicenseName(i.licenseName),void 0!==i.licenseLink&&l.setLicenseLink(i.licenseLink),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.DocumentContent=ie,n(ie,I),n(ie,C),n(ie,P),n(ie,h),n(ie,_);var re=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.ClosedCaptionContent)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.ClosedCaptionContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.ClosedCaptionContent],t[o.id]=!0,n.sourceUrl=o.getSourceUrl(),n.summary=o.getSummary(),n.title=o.getTitle(),null!=o.getDecompInfo()&&(n.decompInfo=o.getDecompInfo().serialize()),null!=o.getUploadInfo()&&(n.uploadInfo=o.getUploadInfo().serialize()),null!=o.getVisualOverrides()&&(n.visualOverrides=o.getVisualOverrides().serialize());var i=o.getProperty(e.Prop.Availability);-1===i.IntValue?n.availability=i.StringValue:n.availability=e.ContentAvailability[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue],n.author=o.getAuthor(),n.timestamp=o.getTimestamp(),n.attribution=o.getAttribution(),null!=o.getGeoCoordinate()&&(n.geoCoordinate=o.getGeoCoordinate().serialize()),n.authorUserName=o.getAuthorUserName(),n.licenseName=o.getLicenseName(),n.licenseLink=o.getLicenseLink();var a=o.getProperty(e.Prop.Emphasis);return-1===a.IntValue?n.emphasis=a.StringValue:n.emphasis=e.EmphasisLevel[a.IntValue],void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.ClosedCaptionContent,a),l=n.getModelObject(s);if(void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.summary&&l.setSummary(i.summary),void 0!==i.title&&l.setTitle(i.title),void 0!==i.decompInfo&&l.setDecompInfo(Ne.Deserialize(i.decompInfo)),void 0!==i.uploadInfo&&l.setUploadInfo(qe.Deserialize(i.uploadInfo)),void 0!==i.visualOverrides&&l.setVisualOverrides(Ge.Deserialize(i.visualOverrides)),void 0!==i.availability&&(void 0!==(c=e.ContentAvailability[i.availability])?l.setAvailabilityInternal(new o(c)):l.setAvailabilityInternal(new o(i.availability))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.author&&l.setAuthor(i.author),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.attribution&&l.setAttribution(i.attribution),void 0!==i.geoCoordinate&&l.setGeoCoordinate(je.Deserialize(i.geoCoordinate)),void 0!==i.authorUserName&&l.setAuthorUserName(i.authorUserName),void 0!==i.licenseName&&l.setLicenseName(i.licenseName),void 0!==i.licenseLink&&l.setLicenseLink(i.licenseLink),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.ClosedCaptionContent=re,n(re,I),n(re,C),n(re,P),n(re,h),n(re,O);var ae=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.AgaveContent)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.AgaveContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.AgaveContent],t[o.id]=!0,n.agaveId=o.getAgaveId(),n.agaveSettings=o.getAgaveSettings();var i=o.getProperty(e.Prop.ContentSource);-1===i.IntValue?n.contentSource=i.StringValue:n.contentSource=e.ContentCreator[i.IntValue];var r=o.getProperty(e.Prop.Emphasis);return-1===r.IntValue?n.emphasis=r.StringValue:n.emphasis=e.EmphasisLevel[r.IntValue],void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.AgaveContent,a),l=n.getModelObject(s);if(void 0!==i.agaveId&&l.setAgaveId(i.agaveId),void 0!==i.agaveSettings&&l.setAgaveSettings(i.agaveSettings),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.AgaveContent=ae,n(ae,C),n(ae,h),n(ae,D);var se=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.ImportingOrEmbeddingDocumentContent)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.ImportingOrEmbeddingDocumentContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.ImportingOrEmbeddingDocumentContent],t[o.id]=!0,n.downloadLink=o.getDownloadLink(),n.extension=o.getExtension(),n.size=o.getSize();var i=o.getProperty(e.Prop.ProviderType);-1===i.IntValue?n.providerType=i.StringValue:n.providerType=e.ContentProvider[i.IntValue],n.documentID=o.getDocumentID();var r=o.getProperty(e.Prop.CardState);-1===r.IntValue?n.cardState=r.StringValue:n.cardState=e.UploadStatus[r.IntValue],n.sourceUrl=o.getSourceUrl(),n.summary=o.getSummary(),n.title=o.getTitle(),null!=o.getDecompInfo()&&(n.decompInfo=o.getDecompInfo().serialize()),null!=o.getUploadInfo()&&(n.uploadInfo=o.getUploadInfo().serialize()),null!=o.getVisualOverrides()&&(n.visualOverrides=o.getVisualOverrides().serialize());var a=o.getProperty(e.Prop.Availability);-1===a.IntValue?n.availability=a.StringValue:n.availability=e.ContentAvailability[a.IntValue];var s=o.getProperty(e.Prop.ContentSource);-1===s.IntValue?n.contentSource=s.StringValue:n.contentSource=e.ContentCreator[s.IntValue],n.author=o.getAuthor(),n.timestamp=o.getTimestamp(),n.attribution=o.getAttribution(),null!=o.getGeoCoordinate()&&(n.geoCoordinate=o.getGeoCoordinate().serialize()),n.authorUserName=o.getAuthorUserName(),n.licenseName=o.getLicenseName(),n.licenseLink=o.getLicenseLink();var l=o.getProperty(e.Prop.Emphasis);return-1===l.IntValue?n.emphasis=l.StringValue:n.emphasis=e.EmphasisLevel[l.IntValue],void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.ImportingOrEmbeddingDocumentContent,a),l=n.getModelObject(s);if(void 0!==i.downloadLink&&l.setDownloadLink(i.downloadLink),void 0!==i.extension&&l.setExtension(i.extension),void 0!==i.size&&l.setSize(i.size),void 0!==i.providerType&&(void 0!==(c=e.ContentProvider[i.providerType])?l.setProviderTypeInternal(new o(c)):l.setProviderTypeInternal(new o(i.providerType))),void 0!==i.documentID&&l.setDocumentID(i.documentID),void 0!==i.cardState&&(void 0!==(c=e.UploadStatus[i.cardState])?l.setCardStateInternal(new o(c)):l.setCardStateInternal(new o(i.cardState))),void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.summary&&l.setSummary(i.summary),void 0!==i.title&&l.setTitle(i.title),void 0!==i.decompInfo&&l.setDecompInfo(Ne.Deserialize(i.decompInfo)),void 0!==i.uploadInfo&&l.setUploadInfo(qe.Deserialize(i.uploadInfo)),void 0!==i.visualOverrides&&l.setVisualOverrides(Ge.Deserialize(i.visualOverrides)),void 0!==i.availability&&(void 0!==(c=e.ContentAvailability[i.availability])?l.setAvailabilityInternal(new o(c)):l.setAvailabilityInternal(new o(i.availability))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.author&&l.setAuthor(i.author),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.attribution&&l.setAttribution(i.attribution),void 0!==i.geoCoordinate&&l.setGeoCoordinate(je.Deserialize(i.geoCoordinate)),void 0!==i.authorUserName&&l.setAuthorUserName(i.authorUserName),void 0!==i.licenseName&&l.setLicenseName(i.licenseName),void 0!==i.licenseLink&&l.setLicenseLink(i.licenseLink),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.ImportingOrEmbeddingDocumentContent=se,n(se,I),n(se,C),n(se,P),n(se,h),n(se,E);var le=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.CodeBlock)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.CodeBlock,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.CodeBlock],t[o.id]=!0,n.code=o.getCode(),n.language=o.getLanguage(),n.sourceUrl=o.getSourceUrl(),n.summary=o.getSummary(),n.title=o.getTitle(),null!=o.getDecompInfo()&&(n.decompInfo=o.getDecompInfo().serialize()),null!=o.getUploadInfo()&&(n.uploadInfo=o.getUploadInfo().serialize()),null!=o.getVisualOverrides()&&(n.visualOverrides=o.getVisualOverrides().serialize());var i=o.getProperty(e.Prop.Availability);-1===i.IntValue?n.availability=i.StringValue:n.availability=e.ContentAvailability[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue],n.author=o.getAuthor(),n.timestamp=o.getTimestamp(),n.attribution=o.getAttribution(),null!=o.getGeoCoordinate()&&(n.geoCoordinate=o.getGeoCoordinate().serialize()),n.authorUserName=o.getAuthorUserName(),n.licenseName=o.getLicenseName(),n.licenseLink=o.getLicenseLink();var a=o.getProperty(e.Prop.Emphasis);return-1===a.IntValue?n.emphasis=a.StringValue:n.emphasis=e.EmphasisLevel[a.IntValue],void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.CodeBlock,a),l=n.getModelObject(s);if(void 0!==i.code&&l.setCode(i.code),void 0!==i.language&&l.setLanguage(i.language),void 0!==i.sourceUrl&&l.setSourceUrl(i.sourceUrl),void 0!==i.summary&&l.setSummary(i.summary),void 0!==i.title&&l.setTitle(i.title),void 0!==i.decompInfo&&l.setDecompInfo(Ne.Deserialize(i.decompInfo)),void 0!==i.uploadInfo&&l.setUploadInfo(qe.Deserialize(i.uploadInfo)),void 0!==i.visualOverrides&&l.setVisualOverrides(Ge.Deserialize(i.visualOverrides)),void 0!==i.availability&&(void 0!==(c=e.ContentAvailability[i.availability])?l.setAvailabilityInternal(new o(c)):l.setAvailabilityInternal(new o(i.availability))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.author&&l.setAuthor(i.author),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.attribution&&l.setAttribution(i.attribution),void 0!==i.geoCoordinate&&l.setGeoCoordinate(je.Deserialize(i.geoCoordinate)),void 0!==i.authorUserName&&l.setAuthorUserName(i.authorUserName),void 0!==i.licenseName&&l.setLicenseName(i.licenseName),void 0!==i.licenseLink&&l.setLicenseLink(i.licenseLink),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.CodeBlock=le,n(le,I),n(le,C),n(le,P),n(le,h),n(le,U);var ce=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.StyleOverrides)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.StyleOverrides,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.StyleOverrides],t[o.id]=!0,n.fontSetId=o.getFontSetId(),n.backgroundSetId=o.getBackgroundSetId(),n.filterSetId=o.getFilterSetId(),n.coverpageBackgroundsId=o.getCoverpageBackgroundsId();var i=o.getProperty(e.Prop.AnimationAmount);return-1===i.IntValue?n.animationAmount=i.StringValue:n.animationAmount=e.AnimationLevel[i.IntValue],n.fontScale=o.getFontScale(),void 0!==o.getSeedColorOverrides()&&(n.seedColorOverrides=o.getSeedColorOverrides().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.StyleOverrides,a),l=n.getModelObject(s);if(void 0!==i.fontSetId&&l.setFontSetId(i.fontSetId),void 0!==i.backgroundSetId&&l.setBackgroundSetId(i.backgroundSetId),void 0!==i.filterSetId&&l.setFilterSetId(i.filterSetId),void 0!==i.coverpageBackgroundsId&&l.setCoverpageBackgroundsId(i.coverpageBackgroundsId),void 0!==i.animationAmount){var c=e.AnimationLevel[i.animationAmount];void 0!==c?l.setAnimationAmountInternal(new o(c)):l.setAnimationAmountInternal(new o(i.animationAmount))}return void 0!==i.fontScale&&l.setFontScale(i.fontScale),void 0!==i.seedColorOverrides&&l.setSeedColorOverrides(n.deserialize(i.seedColorOverrides,r)),l},i}(N);e.StyleOverrides=ce,n(ce,L);var ue=function(o){function n(t,n){var i=o.call(this,t,n,e.ObjectType.SeedColorOverrides)||this;return i.model=n.traversalModel,i}return __extends(n,o),n.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.SeedColorOverrides,o);return t.getModelObject(n)},n.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};return n.id=o.id,void 0!==t[o.id]?(n.ref=!0,n):(n.objType=e.ObjectType[e.ObjectType.SeedColorOverrides],t[o.id]=!0,null!=o.getColors()&&(n.colors=o.getColors().serialize()),n)},n.Deserialize=function(o,n,i){var r=n.id;if(i&&(i[n.id]||(i[n.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),r=i[n.id]),n.ref)return o.getModelObject(r);var a=o.graph.createObject(e.ObjectType.SeedColorOverrides,r),s=o.getModelObject(a);return void 0!==n.colors&&s.getColors().deserializeStructCollection(n.colors,Fe.Deserialize),s},n}(N);e.SeedColorOverrides=ue,n(ue,V);var pe=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.Set)||this;return i.model=o.traversalModel,i.content=new Ce(i,e.Meaning.SetHasSpecifiedGroupChild),i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.Set,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.Set],t[o.id]=!0;var i=o.getProperty(e.Prop.Visualization);-1===i.IntValue?n.visualization=i.StringValue:n.visualization=e.Visualization[i.IntValue];var r=o.getProperty(e.Prop.ContentSource);-1===r.IntValue?n.contentSource=r.StringValue:n.contentSource=e.ContentCreator[r.IntValue];var a=o.getProperty(e.Prop.Emphasis);return-1===a.IntValue?n.emphasis=a.StringValue:n.emphasis=e.EmphasisLevel[a.IntValue],n.content=o.content.serialize(t),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.Set,a),l=n.getModelObject(s);if(void 0!==i.visualization&&(void 0!==(c=e.Visualization[i.visualization])?l.setVisualizationInternal(new o(c)):l.setVisualizationInternal(new o(i.visualization))),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.content&&l.content.deserialize(i.content,r),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.Set=pe,n(pe,R),n(pe,f),n(pe,C),n(pe,h),n(pe,k);var de=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.ClosedCaptionComposite)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.ClosedCaptionComposite,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.ClosedCaptionComposite],t[o.id]=!0,n.language=o.getLanguage(),n.fileName=o.getFileName(),n.label=o.getLabel();var i=o.getProperty(e.Prop.ContentSource);-1===i.IntValue?n.contentSource=i.StringValue:n.contentSource=e.ContentCreator[i.IntValue];var r=o.getProperty(e.Prop.Emphasis);return-1===r.IntValue?n.emphasis=r.StringValue:n.emphasis=e.EmphasisLevel[r.IntValue],void 0!==o.getContent()&&(n.content=o.getContent().serialize(t)),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.ClosedCaptionComposite,a),l=n.getModelObject(s);if(void 0!==i.language&&l.setLanguage(i.language),void 0!==i.fileName&&l.setFileName(i.fileName),void 0!==i.label&&l.setLabel(i.label),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.content&&l.setContent(n.deserialize(i.content,r)),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.ClosedCaptionComposite=de,n(de,f),n(de,C),n(de,h),n(de,j);var ge=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.MediaWithTextComposite)||this;return i.model=o.traversalModel,i.closedCaptions=new Ce(i,e.Meaning.MediaWithTextCompositeHasClosedCaptionComposite),i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.MediaWithTextComposite,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.MediaWithTextComposite],t[o.id]=!0,n.isDecorative=o.getIsDecorative();var i=o.getProperty(e.Prop.ContentSource);-1===i.IntValue?n.contentSource=i.StringValue:n.contentSource=e.ContentCreator[i.IntValue];var r=o.getProperty(e.Prop.Emphasis);return-1===r.IntValue?n.emphasis=r.StringValue:n.emphasis=e.EmphasisLevel[r.IntValue],void 0!==o.getText()&&(n.text=o.getText().serialize(t)),void 0!==o.getDescription()&&(n.description=o.getDescription().serialize(t)),void 0!==o.getMedia()&&(n.media=o.getMedia().serialize(t)),n.closedCaptions=o.closedCaptions.serialize(t),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.MediaWithTextComposite,a),l=n.getModelObject(s);if(void 0!==i.isDecorative&&l.setIsDecorative(i.isDecorative),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.text&&l.setText(n.deserialize(i.text,r)),void 0!==i.description&&l.setDescription(n.deserialize(i.description,r)),void 0!==i.media&&l.setMedia(n.deserialize(i.media,r)),void 0!==i.closedCaptions&&l.closedCaptions.deserialize(i.closedCaptions,r),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.MediaWithTextComposite=ge,n(ge,f),n(ge,C),n(ge,h),n(ge,z);var ye=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.TitleComposite)||this;return i.model=o.traversalModel,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.TitleComposite,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.TitleComposite],t[o.id]=!0,n.backgroundPresent=o.getBackgroundPresent();var i=o.getProperty(e.Prop.ContentSource);-1===i.IntValue?n.contentSource=i.StringValue:n.contentSource=e.ContentCreator[i.IntValue];var r=o.getProperty(e.Prop.Emphasis);return-1===r.IntValue?n.emphasis=r.StringValue:n.emphasis=e.EmphasisLevel[r.IntValue],void 0!==o.getTitle()&&(n.title=o.getTitle().serialize(t)),void 0!==o.getSubtitle()&&(n.subtitle=o.getSubtitle().serialize(t)),void 0!==o.getAuthor()&&(n.author=o.getAuthor().serialize(t)),void 0!==o.getLogo()&&(n.logo=o.getLogo().serialize(t)),void 0!==o.getBackground()&&(n.background=o.getBackground().serialize(t)),void 0!==o.getAuthoringHint()&&(n.authoringHint=o.getAuthoringHint().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.TitleComposite,a),l=n.getModelObject(s);if(void 0!==i.backgroundPresent&&l.setBackgroundPresent(i.backgroundPresent),void 0!==i.contentSource&&(void 0!==(c=e.ContentCreator[i.contentSource])?l.setContentSourceInternal(new o(c)):l.setContentSourceInternal(new o(i.contentSource))),void 0!==i.emphasis){var c=e.EmphasisLevel[i.emphasis];void 0!==c?l.setEmphasisInternal(new o(c)):l.setEmphasisInternal(new o(i.emphasis))}return void 0!==i.title&&l.setTitle(n.deserialize(i.title,r)),void 0!==i.subtitle&&l.setSubtitle(n.deserialize(i.subtitle,r)),void 0!==i.author&&l.setAuthor(n.deserialize(i.author,r)),void 0!==i.logo&&l.setLogo(n.deserialize(i.logo,r)),void 0!==i.background&&l.setBackground(n.deserialize(i.background,r)),void 0!==i.authoringHint&&l.setAuthoringHint(n.deserialize(i.authoringHint,r)),l},i}(N);e.TitleComposite=ye,n(ye,f),n(ye,C),n(ye,h),n(ye,x);var he=function(o){function n(t,n){var i=o.call(this,t,n,e.ObjectType.RenderModel)||this;return i.model=n.renderModel,i}return __extends(n,o),n.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.RenderModel,o);return t.getModelObject(n)},n.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};return n.id=o.id,void 0!==t[o.id]?(n.ref=!0,n):(n.objType=e.ObjectType[e.ObjectType.RenderModel],t[o.id]=!0,n)},n.Deserialize=function(e,o,n){var i=o.id;if(n&&(n[o.id]||(n[o.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),i=n[o.id]),o.ref)return e.getModelObject(i);return e.getModelObject("RenderRoot")},n}(N);e.RenderModel=he,n(he,H);var fe=function(o){function n(t){var n=o.call(this)||this;return n.graph=new e.StoryGraph(t),n._modelObjects={},n._creators={AffinityModel:F,ImageContentPart:B,TraversalModel:G,SpecifiedGrouping:W,SpecifiedGroup:q,Table:Q,TableRow:$,TableCell:J,TextGroup:K,TextGroupChild:Y,Paragraph:X,ImageContent:Z,VideoContent:ee,AudioContent:te,EmbeddedContent:oe,StatusUpdateContent:ne,DocumentContent:ie,ClosedCaptionContent:re,AgaveContent:ae,ImportingOrEmbeddingDocumentContent:se,CodeBlock:le,StyleOverrides:ce,SeedColorOverrides:ue,Set:pe,ClosedCaptionComposite:de,MediaWithTextComposite:ge,TitleComposite:ye,RenderModel:he},n.affinityModel=n.getModelObject("AffinityRoot"),n.traversalModel=n.getModelObject("TraversalRoot"),n.renderModel=n.getModelObject("RenderRoot"),n.graph.registerObjectDisposalCallback(n.disposeModelObjects.bind(n)),n}return __extends(n,o),n.prototype.getModelObject=function(t){var o=this;return o.graph.containsObject(t)?(void 0===o._modelObjects[t]&&(o._modelObjects[t]=new(o._creators[e.ObjectType[o.graph.getObjectType(t)]])(t,o)),o._modelObjects[t]):null},n.prototype.getSchemaVersion=function(){var t=this,o=t.graph.getProperty("ModelRoot",e.Prop.SchemaVersion);return 0==o&&(o=t.graph.getProperty("AffinityRoot",e.Prop.SchemaVersion)),o},n.prototype.disposeModelObjects=function(e){for(var t=this,o=0;o<e.length;o++){var n=e[o],i=t._modelObjects[n];i&&i.dispose(),delete t._modelObjects[n]}},n.prototype.deserialize=function(e,o){var n=this,i=e.id;if(o&&(o[e.id]||(o[e.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),i=o[e.id]),e.ref)return n.getModelObject(i);if(void 0===e.objType)throw new Error("Missing object type encountered when deserializing object.");if(void 0===n._creators[e.objType])throw new Error("Invalid object type encountered when deserializing object.");return n._creators[e.objType].Deserialize(n,e,o)},n.PropSerializer=e.StoryGraph.PropSerializer,n.RootId=e.StoryGraph.RootId,n.ModelType=1,n}(ObjectOM);e.StoryModel=fe;var Se=function(e){function t(t,o,n,i,r){var a=e.call(this)||this;return a._modelObject=t,a._leftProp=o,a._topProp=n,a._widthProp=i,a._heightProp=r,a}return __extends(t,e),t.prototype.getLeft=function(e){var t=this;return t._modelObject.getProperty(t._leftProp,e)},t.prototype.setLeft=function(e){var t=this;t._modelObject.setProperty(t._leftProp,e)},t.prototype.getTop=function(e){var t=this;return t._modelObject.getProperty(t._topProp,e)},t.prototype.setTop=function(e){var t=this;t._modelObject.setProperty(t._topProp,e)},t.prototype.getWidth=function(e){var t=this;return t._modelObject.getProperty(t._widthProp,e)},t.prototype.setWidth=function(e){var t=this;t._modelObject.setProperty(t._widthProp,e)},t.prototype.getHeight=function(e){var t=this;return t._modelObject.getProperty(t._heightProp,e)},t.prototype.setHeight=function(e){var t=this;t._modelObject.setProperty(t._heightProp,e)},t}(ObjectOM);e.Rectangle=Se;var me=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setParent=function(e){var t=this;if(null!=e&&null!=t._parent)throw new Error("You must orphan this element before setting it to a new parent.");t._parent=e},t.prototype.setObjectProperty=function(e,t){var o=this;o._modelObject=e,o._prop=t},t.prototype.propertyUpdated=function(){var e=this;null!=e._parent?e._parent.propertyUpdated():void 0!=e._modelObject&&void 0!=e._prop&&e._modelObject.updateProperty(e._prop)},t.prototype.watchProperty=function(e){var t=this;void 0!=e&&(null!=t._parent?t._parent.watchProperty(e):void 0!=t._modelObject&&void 0!=t._prop&&t._modelObject.getProperty(t._prop,e))},t.prototype.copyFrom=function(e){var t=this;t._modelObject=e._modelObject,t._prop=e._prop},t}(ObjectOM);e.PropertyParent=me;var ve=function(e){function t(t,o,n){var i=e.call(this)||this;return i.modelObject=t,i.meaning=o,i.forward=n,i}return __extends(t,e),t.prototype.getCollection=function(e){var t=this;return t.forward?t.modelObject.getRelationshipsFrom(t.meaning,e):t.modelObject.getRelationshipsTo(t.meaning,e)},t}(ObjectOM);e.ObjectCollection=ve;var Ce=function(e){function t(t,o){return e.call(this,t,o,!0)||this}return __extends(t,e),t.prototype.add=function(e,t){var o=this;o.modelObject.addRelationship(e,o.meaning,t)},t.prototype.remove=function(e){var t=this;t.modelObject.removeRelationship(e,t.meaning)},t.prototype.removeAt=function(e){var t=this;t.remove(t.getCollection()[e])},t.prototype.set=function(e){var t=this;t.modelObject.setRelationships(e,t.meaning)},t.prototype.serialize=function(e){for(var t=[],o=this.getCollection(),n=o.length,i=0;i<n;i++)t.push(o[i].serialize(e));return t},t.prototype.deserialize=function(e,t){for(var o=this,n=0;n<e.length;n++){var i=e[n],r=o.modelObject.storyModel.deserialize(i,t);o.add(r)}},t}(ve);e.ObjectCollectionWritable=Ce;var Pe=function(e){function t(){var t=e.call(this)||this;return t._collection=[],t}return __extends(t,e),t.prototype.getLength=function(e){var t=this;return t.watchProperty(e),t._collection.length},t.prototype.itemAtIndex=function(e,t){var o=this;return o.watchProperty(t),o._collection[e]},t.prototype.add=function(e,t){var o=this;o.propertyUpdated(),void 0!=t?o._collection.splice(t,0,e):o._collection.push(e)},t.prototype.removeAt=function(e){var t=this;t.propertyUpdated(),t._collection.splice(e,1)},t.prototype.getCollection=function(e){var t=this;return t.watchProperty(e),t._collection},t.prototype.setCollection=function(e){var t=this;t.propertyUpdated(),t._collection=e},t.prototype.serialize=function(){var e=this,t=e.getLength();if(0!=t){for(var o=[],n=0;n<t;n++)o.push(e.itemAtIndex(n));return o}},t.prototype.deserializePropertyCollection=function(e){this._collection=e},t.prototype.copyFrom=function(t){var o=this;e.prototype.copyFrom.call(this,t),o._collection=t._collection.slice()},t.prototype.createCopy=function(){var e=this,o=new t;return o.copyFrom(e),o},t.prototype.equals=function(e){var t=this;return!!e&&StoryApp.Utilities.sequenceEquals(t._collection,e._collection)},t}(me);e.PropertyCollection=Pe;var Ie=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.add=function(t,o){var n=this;t.setParent(n),e.prototype.add.call(this,t,o)},t.prototype.removeAt=function(t){this.itemAtIndex(t).setParent(null),e.prototype.removeAt.call(this,t)},t.prototype.setCollection=function(t){for(var o=this,n=o.getLength(),i=0;i<n;i++)o.itemAtIndex(i).setParent(null);e.prototype.setCollection.call(this,t);for(var i=0,r=t.length;i<r;++i)t[i].setParent(o)},t.prototype.serialize=function(){for(var e=this,t=[],o=e.getLength(),n=0;n<o;n++)t.push(e.itemAtIndex(n).serialize());return t},t.prototype.deserializeStructCollection=function(e,t){for(var o=this;o.getLength()>0;)o.removeAt(0);for(var n=e.length,i=0;i<n;i++)o.add(t(e[i]))},t.prototype.copyFrom=function(t){var o=this;e.prototype.copyFrom.call(this,t);for(var n=o.getCollection(),i=0,r=n.length;i<r;++i){var a=n[i].createCopy();n[i]=a,a.setParent(o)}},t.prototype.createCopy=function(){var e=this,o=new t;return o.copyFrom(e),o},t.prototype.equals=function(e){var t=this;if(!e)return!1;var o=t.getCollection(),n=e.getCollection();if(o.length!==n.length)return!1;for(var i=0,r=o.length;i<r;++i)if(!o[i].equals(n[i]))return!1;return!0},t}(Pe);e.StructCollection=Ie;var Te=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.add=function(t,n){t instanceof o?e.prototype.add.call(this,t,n):e.prototype.add.call(this,new o(t),n)},t.prototype.removeAt=function(t){e.prototype.removeAt.call(this,t)},t.prototype.setCollection=function(t){if(t[0]instanceof o)e.prototype.setCollection.call(this,t);else{var n=[];for(var i in t)n.push(new o(i));e.prototype.setCollection.call(this,n)}},t.prototype.getCollectionCopy=function(){for(var e=[],t=this.getLength(),o=0;o<t;o++)e.push(this.itemAtIndex(o).IntValue);return e},t.prototype.serialize=function(e){for(var t=this,o=[],n=t.getLength(),i=0;i<n;i++)o.push(t.itemAtIndex(i).serialize(e));return o},t.prototype.deserializeEnumCollection=function(e,t){for(var n=this;n.getLength()>0;)n.removeAt(0);for(var i=e.length,r=0;r<i;r++){var a=t[e[r]];void 0!==a?n.add(new o(a)):n.add(new o(e[r]))}},t.prototype.copyFrom=function(t){var o=this;e.prototype.copyFrom.call(this,t);for(var n=o.getCollection(),i=0,r=n.length;i<r;++i)n[i]=n[i].createCopy()},t.prototype.createCopy=function(){var e=this,o=new t;return o.copyFrom(e),o},t.prototype.equals=function(e){var t=this;if(!e)return!1;var o=t.getCollection(),n=e.getCollection();if(o.length!==n.length)return!1;for(var i=0,r=o.length;i<r;++i)if(!o[i].equals(n[i]))return!1;return!0},t}(Pe);e.EnumCollection=Te;var Me={getLatitude:function(e){return this.watchProperty(e),this._Latitude},setLatitude:function(e){this._Latitude!=e&&(this.propertyUpdated(),this._Latitude=e)},getLongitude:function(e){return this.watchProperty(e),this._Longitude},setLongitude:function(e){this._Longitude!=e&&(this.propertyUpdated(),this._Longitude=e)}},be={getText:function(e){return this.watchProperty(e),this._Text},setText:function(e){this._Text!=e&&(this.propertyUpdated(),this._Text=e)}},Ae={getEmphasis:function(e){return this.watchProperty(e),this._Emphasis.IntValue},setEmphasis:function(e){this._Emphasis.IntValue!=e&&(this.propertyUpdated(),this._Emphasis=new o(e))},getUrl:function(e){return this.watchProperty(e),this._Url},setUrl:function(e){this._Url!=e&&(this.propertyUpdated(),this._Url=e)},getIndex:function(e){return this.watchProperty(e),this._Index},setIndex:function(e){this._Index!=e&&(this.propertyUpdated(),this._Index=e)},getLength:function(e){return this.watchProperty(e),this._Length},setLength:function(e){this._Length!=e&&(this.propertyUpdated(),this._Length=e)},getIsQuotation:function(e){return this.watchProperty(e),this._IsQuotation},setIsQuotation:function(e){this._IsQuotation!=e&&(this.propertyUpdated(),this._IsQuotation=e)},getIsItalics:function(e){return this.watchProperty(e),this._IsItalics},setIsItalics:function(e){this._IsItalics!=e&&(this.propertyUpdated(),this._IsItalics=e)}},we={getLeft:function(e){return this.watchProperty(e),this._Left},setLeft:function(e){this._Left!=e&&(this.propertyUpdated(),this._Left=e)},getTop:function(e){return this.watchProperty(e),this._Top},setTop:function(e){this._Top!=e&&(this.propertyUpdated(),this._Top=e)},getRight:function(e){return this.watchProperty(e),this._Right},setRight:function(e){this._Right!=e&&(this.propertyUpdated(),this._Right=e)},getBottom:function(e){return this.watchProperty(e),this._Bottom},setBottom:function(e){this._Bottom!=e&&(this.propertyUpdated(),this._Bottom=e)}},_e={getProvider:function(e){return this.watchProperty(e),this._Provider.IntValue},setProvider:function(e){this._Provider.IntValue!=e&&(this.propertyUpdated(),this._Provider=new o(e))},getDecompProperties:function(e){return this.watchProperty(e),this._DecompProperties},setDecompProperties:function(e){this._DecompProperties!=e&&(this.propertyUpdated(),this._DecompProperties=e)},getVersion:function(e){return this.watchProperty(e),this._Version},setVersion:function(e){this._Version!=e&&(this.propertyUpdated(),this._Version=e)}},Oe={getId:function(e){return this.watchProperty(e),this._Id},setId:function(e){this._Id!=e&&(this.propertyUpdated(),this._Id=e)},getValue:function(e){return this.watchProperty(e),this._Value},setValue:function(e){this._Value!=e&&(this.propertyUpdated(),this._Value=e)}},De={getId:function(e){return this.watchProperty(e),this._Id},setId:function(e){this._Id!=e&&(this.propertyUpdated(),this._Id=e)},getValue:function(e){return this.watchProperty(e),this._Value},setValue:function(e){this._Value!=e&&(this.propertyUpdated(),this._Value=e)}},Ee={getTextColorOverride:function(e){return this.watchProperty(e),this._TextColorOverride},setTextColorOverride:function(e){this._TextColorOverride!=e&&(this.propertyUpdated(),this._TextColorOverride=e)}},Ue={getWidth:function(e){return this.watchProperty(e),this._Width},setWidth:function(e){this._Width!=e&&(this.propertyUpdated(),this._Width=e)},getHeight:function(e){return this.watchProperty(e),this._Height},setHeight:function(e){this._Height!=e&&(this.propertyUpdated(),this._Height=e)}},Le={getFileName:function(e){return this.watchProperty(e),this._FileName},setFileName:function(e){this._FileName!=e&&(this.propertyUpdated(),this._FileName=e)},getErrorMessage:function(e){return this.watchProperty(e),this._ErrorMessage.IntValue},setErrorMessage:function(e){this._ErrorMessage.IntValue!=e&&(this.propertyUpdated(),this._ErrorMessage=new o(e))},getStartAttempt:function(e){return this.watchProperty(e),this._StartAttempt},setStartAttempt:function(e){this._StartAttempt!=e&&(this.propertyUpdated(),this._StartAttempt=e)},getEndAttempt:function(e){return this.watchProperty(e),this._EndAttempt},setEndAttempt:function(e){this._EndAttempt!=e&&(this.propertyUpdated(),this._EndAttempt=e)},getClientId:function(e){return this.watchProperty(e),this._ClientId},setClientId:function(e){this._ClientId!=e&&(this.propertyUpdated(),this._ClientId=e)}},Ve={getLookupId:function(e){return this.watchProperty(e),this._LookupId},setLookupId:function(e){this._LookupId!=e&&(this.propertyUpdated(),this._LookupId=e)},getOriginId:function(e){return this.watchProperty(e),this._OriginId},setOriginId:function(e){this._OriginId!=e&&(this.propertyUpdated(),this._OriginId=e)}},Re={getStartAutomatically:function(e){return this.watchProperty(e),this._StartAutomatically},setStartAutomatically:function(e){this._StartAutomatically!=e&&(this.propertyUpdated(),this._StartAutomatically=e)},getLoop:function(e){return this.watchProperty(e),this._Loop},setLoop:function(e){this._Loop!=e&&(this.propertyUpdated(),this._Loop=e)},getSpeed:function(e){return this.watchProperty(e),this._Speed},setSpeed:function(e){this._Speed!=e&&(this.propertyUpdated(),this._Speed=e)}},ke=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.compareUnknownDictionaries=function(e,o){if(!e||!o)return!1;if(Object.keys(e).length!==Object.keys(o).length)return!1;for(var n in e)if(e[n]!==o[n])return e[n]instanceof Object&&o[n]instanceof Object&&t.compareUnknownDictionaries(e[n],o[n]);return!0},t}(me);e.Struct=ke;var je=function(t){function o(){var o=t.call(this)||this,n=o;return n.structType=e.StructType.GeoCoordinate,n._Latitude=0,n._Longitude=0,n._UnknownProps={},o}return __extends(o,t),o.Deserialize=function(e){var t=new o;for(var n in e)switch(n){case"Latitude":t._Latitude=e.Latitude;break;case"Longitude":t._Longitude=e.Longitude;break;case"_Type":break;default:t._UnknownProps[n]=e[n]}return t},o.prototype.serialize=function(){var e=this,t={};0!=e._Latitude&&(t.Latitude=e._Latitude),0!=e._Longitude&&(t.Longitude=e._Longitude);for(var o in e._UnknownProps)t[o]=e._UnknownProps[o];return t},o.prototype.createCopy=function(){var e=this,t=new o;t._Latitude=e._Latitude,t._Longitude=e._Longitude;for(var n in e._UnknownProps)t._UnknownProps[n]=e._UnknownProps[n];return t},o.prototype.equals=function(e){var t=this;return!!e&&(this.structType===e.structType&&t._Latitude===e._Latitude&&t._Longitude===e._Longitude&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},o}(ke);e.GeoCoordinate=je,n(je,Me);var ze=function(t){function o(){var o=t.call(this)||this,n=o;return n.structType=e.StructType.TextBlock,n._Text="",n.runs=new Ie,n.runs.setParent(n),n._UnknownProps={},o}return __extends(o,t),o.Deserialize=function(e){var t=new o;for(var n in e)switch(n){case"Text":t._Text=e.Text;break;case"Runs":t.runs.deserializeStructCollection(e.Runs,xe.Deserialize);break;case"_Type":break;default:t._UnknownProps[n]=e[n]}return t},o.prototype.serialize=function(){var e=this,t={};""!=e._Text&&(t.Text=e._Text),t.Runs=e.runs.serialize();for(var o in e._UnknownProps)t[o]=e._UnknownProps[o];return t},o.prototype.createCopy=function(){var e=this,t=new o;t._Text=e._Text;var n=e.runs;n&&(n=n.createCopy()).setParent(t),t.runs=n;for(var i in e._UnknownProps)t._UnknownProps[i]=e._UnknownProps[i];return t},o.prototype.equals=function(e){var t=this;return!!e&&(!(this.structType!==e.structType||t._Text!==e._Text||(t.runs?!t.runs.equals(e.runs):e.runs))&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},o}(ke);e.TextBlock=ze,n(ze,be);var xe=function(t){function n(){var n=t.call(this)||this,i=n;return i.structType=e.StructType.TextRun,i._Emphasis=new o(e.EmphasisLevel.Auto),i._Url="",i._Index=0,i._Length=0,i._IsQuotation=!1,i._IsItalics=!1,i._UnknownProps={},n}return __extends(n,t),n.Deserialize=function(t){var i=new n;for(var r in t)switch(r){case"Emphasis":var a=e.EmphasisLevel[t.Emphasis];i._Emphasis=new o(void 0!==a?a:t.Emphasis);break;case"Url":i._Url=t.Url;break;case"Index":i._Index=t.Index;break;case"Length":i._Length=t.Length;break;case"IsQuotation":i._IsQuotation=t.IsQuotation;break;case"IsItalics":i._IsItalics=t.IsItalics;break;case"_Type":break;default:i._UnknownProps[r]=t[r]}return i},n.prototype.serialize=function(){var t=this,o={};t._Emphasis.IntValue!=e.EmphasisLevel.Auto&&(t._Emphasis.IntValue===e.EmphasisLevel.UnknownValue?o.Emphasis=t._Emphasis.StringValue:o.Emphasis=e.EmphasisLevel[t._Emphasis.IntValue]),""!=t._Url&&(o.Url=t._Url),0!=t._Index&&(o.Index=t._Index),0!=t._Length&&(o.Length=t._Length),0!=t._IsQuotation&&(o.IsQuotation=t._IsQuotation),0!=t._IsItalics&&(o.IsItalics=t._IsItalics);for(var n in t._UnknownProps)o[n]=t._UnknownProps[n];return o},n.prototype.createCopy=function(){var e=this,t=new n,o=e._Emphasis;o&&(o=o.createCopy()),t._Emphasis=o,t._Url=e._Url,t._Index=e._Index,t._Length=e._Length,t._IsQuotation=e._IsQuotation,t._IsItalics=e._IsItalics;for(var i in e._UnknownProps)t._UnknownProps[i]=e._UnknownProps[i];return t},n.prototype.equals=function(e){var t=this;return!!e&&(!(this.structType!==e.structType||(t._Emphasis?!t._Emphasis.equals(e._Emphasis):e._Emphasis)||t._Url!==e._Url||t._Index!==e._Index||t._Length!==e._Length||t._IsQuotation!==e._IsQuotation||t._IsItalics!==e._IsItalics)&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},n}(ke);e.TextRun=xe,n(xe,Ae);var He=function(t){function o(){var o=t.call(this)||this,n=o;return n.structType=e.StructType.Rect,n._Left=0,n._Top=0,n._Right=0,n._Bottom=0,n._UnknownProps={},o}return __extends(o,t),o.Deserialize=function(e){var t=new o;for(var n in e)switch(n){case"Left":t._Left=e.Left;break;case"Top":t._Top=e.Top;break;case"Right":t._Right=e.Right;break;case"Bottom":t._Bottom=e.Bottom;break;case"_Type":break;default:t._UnknownProps[n]=e[n]}return t},o.prototype.serialize=function(){var e=this,t={};0!=e._Left&&(t.Left=e._Left),0!=e._Top&&(t.Top=e._Top),0!=e._Right&&(t.Right=e._Right),0!=e._Bottom&&(t.Bottom=e._Bottom);for(var o in e._UnknownProps)t[o]=e._UnknownProps[o];return t},o.prototype.createCopy=function(){var e=this,t=new o;t._Left=e._Left,t._Top=e._Top,t._Right=e._Right,t._Bottom=e._Bottom;for(var n in e._UnknownProps)t._UnknownProps[n]=e._UnknownProps[n];return t},o.prototype.equals=function(e){var t=this;return!!e&&(this.structType===e.structType&&t._Left===e._Left&&t._Top===e._Top&&t._Right===e._Right&&t._Bottom===e._Bottom&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},o}(ke);e.Rect=He,n(He,we);var Ne=function(t){function n(){var n=t.call(this)||this,i=n;return i.structType=e.StructType.DecompInfo,i._Provider=new o(e.ContentProvider.None),i._DecompProperties="",i._Version=0,i._UnknownProps={},n}return __extends(n,t),n.Deserialize=function(t){var i=new n;for(var r in t)switch(r){case"Provider":var a=e.ContentProvider[t.Provider];i._Provider=new o(void 0!==a?a:t.Provider);break;case"DecompProperties":i._DecompProperties=t.DecompProperties;break;case"Version":i._Version=t.Version;break;case"_Type":break;default:i._UnknownProps[r]=t[r]}return i},n.prototype.serialize=function(){var t=this,o={};t._Provider.IntValue!=e.ContentProvider.None&&(t._Provider.IntValue===e.ContentProvider.UnknownValue?o.Provider=t._Provider.StringValue:o.Provider=e.ContentProvider[t._Provider.IntValue]),""!=t._DecompProperties&&(o.DecompProperties=t._DecompProperties),0!=t._Version&&(o.Version=t._Version);for(var n in t._UnknownProps)o[n]=t._UnknownProps[n];return o},n.prototype.createCopy=function(){var e=this,t=new n,o=e._Provider;o&&(o=o.createCopy()),t._Provider=o,t._DecompProperties=e._DecompProperties,t._Version=e._Version;for(var i in e._UnknownProps)t._UnknownProps[i]=e._UnknownProps[i];return t},n.prototype.equals=function(e){var t=this;return!!e&&(!(this.structType!==e.structType||(t._Provider?!t._Provider.equals(e._Provider):e._Provider)||t._DecompProperties!==e._DecompProperties||t._Version!==e._Version)&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},n}(ke);e.DecompInfo=Ne,n(Ne,_e);var Fe=function(t){function o(){var o=t.call(this)||this,n=o;return n.structType=e.StructType.SeedColorOverride,n._Id="",n._Value="",n._UnknownProps={},o}return __extends(o,t),o.Deserialize=function(e){var t=new o;for(var n in e)switch(n){case"Id":t._Id=e.Id;break;case"Value":t._Value=e.Value;break;case"_Type":break;default:t._UnknownProps[n]=e[n]}return t},o.prototype.serialize=function(){var e=this,t={};""!=e._Id&&(t.Id=e._Id),""!=e._Value&&(t.Value=e._Value);for(var o in e._UnknownProps)t[o]=e._UnknownProps[o];return t},o.prototype.createCopy=function(){var e=this,t=new o;t._Id=e._Id,t._Value=e._Value;for(var n in e._UnknownProps)t._UnknownProps[n]=e._UnknownProps[n];return t},o.prototype.equals=function(e){var t=this;return!!e&&(this.structType===e.structType&&t._Id===e._Id&&t._Value===e._Value&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},o}(ke);e.SeedColorOverride=Fe,n(Fe,Oe);var Be=function(t){function o(){var o=t.call(this)||this,n=o;return n.structType=e.StructType.LayoutColor,n._Id="",n._Value="",n._UnknownProps={},o}return __extends(o,t),o.Deserialize=function(e){var t=new o;for(var n in e)switch(n){case"Id":t._Id=e.Id;break;case"Value":t._Value=e.Value;break;case"_Type":break;default:t._UnknownProps[n]=e[n]}return t},o.prototype.serialize=function(){var e=this,t={};""!=e._Id&&(t.Id=e._Id),""!=e._Value&&(t.Value=e._Value);for(var o in e._UnknownProps)t[o]=e._UnknownProps[o];return t},o.prototype.createCopy=function(){var e=this,t=new o;t._Id=e._Id,t._Value=e._Value;for(var n in e._UnknownProps)t._UnknownProps[n]=e._UnknownProps[n];return t},o.prototype.equals=function(e){var t=this;return!!e&&(this.structType===e.structType&&t._Id===e._Id&&t._Value===e._Value&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},o}(ke);e.LayoutColor=Be,n(Be,De);var Ge=function(t){function o(){var o=t.call(this)||this,n=o;return n.structType=e.StructType.VisualOverrides,n._TextColorOverride="",n._UnknownProps={},o}return __extends(o,t),o.Deserialize=function(e){var t=new o;for(var n in e)switch(n){case"TextColorOverride":t._TextColorOverride=e.TextColorOverride;break;case"_Type":break;default:t._UnknownProps[n]=e[n]}return t},o.prototype.serialize=function(){var e=this,t={};""!=e._TextColorOverride&&(t.TextColorOverride=e._TextColorOverride);for(var o in e._UnknownProps)t[o]=e._UnknownProps[o];return t},o.prototype.createCopy=function(){var e=this,t=new o;t._TextColorOverride=e._TextColorOverride;for(var n in e._UnknownProps)t._UnknownProps[n]=e._UnknownProps[n];return t},o.prototype.equals=function(e){var t=this;return!!e&&(this.structType===e.structType&&t._TextColorOverride===e._TextColorOverride&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},o}(ke);e.VisualOverrides=Ge,n(Ge,Ee);var We=function(t){function o(){var o=t.call(this)||this,n=o;return n.structType=e.StructType.Size,n._Width=0,n._Height=0,n._UnknownProps={},o}return __extends(o,t),o.Deserialize=function(e){var t=new o;for(var n in e)switch(n){case"Width":t._Width=e.Width;break;case"Height":t._Height=e.Height;break;case"_Type":break;default:t._UnknownProps[n]=e[n]}return t},o.prototype.serialize=function(){var e=this,t={};0!=e._Width&&(t.Width=e._Width),0!=e._Height&&(t.Height=e._Height);for(var o in e._UnknownProps)t[o]=e._UnknownProps[o];return t},o.prototype.createCopy=function(){var e=this,t=new o;t._Width=e._Width,t._Height=e._Height;for(var n in e._UnknownProps)t._UnknownProps[n]=e._UnknownProps[n];return t},o.prototype.equals=function(e){var t=this;return!!e&&(this.structType===e.structType&&t._Width===e._Width&&t._Height===e._Height&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},o}(ke);e.Size=We,n(We,Ue);var qe=function(t){function n(){var n=t.call(this)||this,i=n;return i.structType=e.StructType.UploadInfo,i._FileName="",i._ErrorMessage=new o(e.UploadCardErrorMessage.Generic),i._StartAttempt="",i._EndAttempt="",i._ClientId="",i._UnknownProps={},n}return __extends(n,t),n.Deserialize=function(t){var i=new n;for(var r in t)switch(r){case"FileName":i._FileName=t.FileName;break;case"ErrorMessage":var a=e.UploadCardErrorMessage[t.ErrorMessage];i._ErrorMessage=new o(void 0!==a?a:t.ErrorMessage);break;case"StartAttempt":i._StartAttempt=t.StartAttempt;break;case"EndAttempt":i._EndAttempt=t.EndAttempt;break;case"ClientId":i._ClientId=t.ClientId;break;case"_Type":break;default:i._UnknownProps[r]=t[r]}return i},n.prototype.serialize=function(){var t=this,o={};""!=t._FileName&&(o.FileName=t._FileName),t._ErrorMessage.IntValue!=e.UploadCardErrorMessage.Generic&&(t._ErrorMessage.IntValue===e.UploadCardErrorMessage.UnknownValue?o.ErrorMessage=t._ErrorMessage.StringValue:o.ErrorMessage=e.UploadCardErrorMessage[t._ErrorMessage.IntValue]),""!=t._StartAttempt&&(o.StartAttempt=t._StartAttempt),""!=t._EndAttempt&&(o.EndAttempt=t._EndAttempt),""!=t._ClientId&&(o.ClientId=t._ClientId);for(var n in t._UnknownProps)o[n]=t._UnknownProps[n];return o},n.prototype.createCopy=function(){var e=this,t=new n;t._FileName=e._FileName;var o=e._ErrorMessage;o&&(o=o.createCopy()),t._ErrorMessage=o,t._StartAttempt=e._StartAttempt,t._EndAttempt=e._EndAttempt,t._ClientId=e._ClientId;for(var i in e._UnknownProps)t._UnknownProps[i]=e._UnknownProps[i];return t},n.prototype.equals=function(e){var t=this;return!!e&&(!(this.structType!==e.structType||t._FileName!==e._FileName||(t._ErrorMessage?!t._ErrorMessage.equals(e._ErrorMessage):e._ErrorMessage)||t._StartAttempt!==e._StartAttempt||t._EndAttempt!==e._EndAttempt||t._ClientId!==e._ClientId)&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},n}(ke);e.UploadInfo=qe,n(qe,Le);var Qe=function(t){function o(){var o=t.call(this)||this,n=o;return n.structType=e.StructType.CopyInfo,n._LookupId="",n._OriginId="",n._UnknownProps={},o}return __extends(o,t),o.Deserialize=function(e){var t=new o;for(var n in e)switch(n){case"LookupId":t._LookupId=e.LookupId;break;case"OriginId":t._OriginId=e.OriginId;break;case"_Type":break;default:t._UnknownProps[n]=e[n]}return t},o.prototype.serialize=function(){var e=this,t={};""!=e._LookupId&&(t.LookupId=e._LookupId),""!=e._OriginId&&(t.OriginId=e._OriginId);for(var o in e._UnknownProps)t[o]=e._UnknownProps[o];return t},o.prototype.createCopy=function(){var e=this,t=new o;t._LookupId=e._LookupId,t._OriginId=e._OriginId;for(var n in e._UnknownProps)t._UnknownProps[n]=e._UnknownProps[n];return t},o.prototype.equals=function(e){var t=this;return!!e&&(this.structType===e.structType&&t._LookupId===e._LookupId&&t._OriginId===e._OriginId&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},o}(ke);e.CopyInfo=Qe,n(Qe,Ve);var $e=function(t){function o(){var o=t.call(this)||this,n=o;return n.structType=e.StructType.AutoPlaySettings,n._StartAutomatically=!1,n._Loop=!0,n._Speed=5,n._UnknownProps={},o}return __extends(o,t),o.Deserialize=function(e){var t=new o;for(var n in e)switch(n){case"StartAutomatically":t._StartAutomatically=e.StartAutomatically;break;case"Loop":t._Loop=e.Loop;break;case"Speed":t._Speed=e.Speed;break;case"_Type":break;default:t._UnknownProps[n]=e[n]}return t},o.prototype.serialize=function(){var e=this,t={};0!=e._StartAutomatically&&(t.StartAutomatically=e._StartAutomatically),1!=e._Loop&&(t.Loop=e._Loop),5!=e._Speed&&(t.Speed=e._Speed);for(var o in e._UnknownProps)t[o]=e._UnknownProps[o];return t},o.prototype.createCopy=function(){var e=this,t=new o;t._StartAutomatically=e._StartAutomatically,t._Loop=e._Loop,t._Speed=e._Speed;for(var n in e._UnknownProps)t._UnknownProps[n]=e._UnknownProps[n];return t},o.prototype.equals=function(e){var t=this;return!!e&&(this.structType===e.structType&&t._StartAutomatically===e._StartAutomatically&&t._Loop===e._Loop&&t._Speed===e._Speed&&ke.compareUnknownDictionaries(this._UnknownProps,e._UnknownProps))},o}(ke);e.AutoPlaySettings=$e,n($e,Re),e.StoryGraph.SetStructValues(),e.StoryGraph.SetStructCollectionValues(),e.StoryGraph.SetPropertyCollectionValues(),e.StoryGraph.SetEnumCollectionValues()}(e.SM||(e.SM={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){var t=StoryApp.Model.GraphModel,o=StoryApp.Model.EnumWrapper;!function(e){var n;!function(e){e[e.ContentRoot=0]="ContentRoot",e[e.ContentNode=1]="ContentNode",e[e.ContentMetadata=2]="ContentMetadata",e[e.VideoContentMetadata=3]="VideoContentMetadata",e[e.AudioContentMetadata=4]="AudioContentMetadata",e[e.ImageContentPart=5]="ImageContentPart",e[e.ImportingOrEmbeddingDocumentContent=6]="ImportingOrEmbeddingDocumentContent",e[e.StoryVideoInfo=7]="StoryVideoInfo",e[e.StoryAudioInfo=8]="StoryAudioInfo",e[e.Root=9]="Root"}(n=e.ObjectType||(e.ObjectType={}));e.StructType||(e.StructType={});var i;!function(e){e[e.DocumentIngestionInProcess=0]="DocumentIngestionInProcess",e[e.DocumentIngestionPreparedEarlySway=1]="DocumentIngestionPreparedEarlySway",e[e.IngestionResultCode=2]="IngestionResultCode",e[e.IngestionNotifyStatus=3]="IngestionNotifyStatus",e[e.IngestionFilename=4]="IngestionFilename",e[e.OneNoteContainerName=5]="OneNoteContainerName",e[e.StoryCreationMethod=6]="StoryCreationMethod",e[e.IsSwspStory=7]="IsSwspStory",e[e.AugmentationSucceeded=8]="AugmentationSucceeded",e[e.ContentState=9]="ContentState",e[e.RetryCount=10]="RetryCount",e[e.Timestamp=11]="Timestamp",e[e.ProcessingError=12]="ProcessingError",e[e.VideoPlayerDescriptorOverride=13]="VideoPlayerDescriptorOverride",e[e.DurationOverride=14]="DurationOverride",e[e.StreamingId=15]="StreamingId",e[e.AudioPlayerDescriptorOverride=16]="AudioPlayerDescriptorOverride",e[e.Width=17]="Width",e[e.Height=18]="Height",e[e.Semantic=19]="Semantic",e[e.SourceUrlOverride=20]="SourceUrlOverride",e[e.DocumentID=21]="DocumentID",e[e.VideoId=22]="VideoId",e[e.VideoModelIds=23]="VideoModelIds",e[e.AudioId=24]="AudioId",e[e.AudioModelIds=25]="AudioModelIds",e[e.AssetCleaned=26]="AssetCleaned",e[e.SchemaVersion=27]="SchemaVersion"}(i=e.Prop||(e.Prop={}));var r;!function(e){e[e.ContentRootHasContentNode=0]="ContentRootHasContentNode",e[e.ContentRootHasImageContentPart=1]="ContentRootHasImageContentPart",e[e.ContentRootHasImportingOrEmbeddingDocumentContent=2]="ContentRootHasImportingOrEmbeddingDocumentContent",e[e.ContentRootHasStoryVideoInfo=3]="ContentRootHasStoryVideoInfo",e[e.ContentRootHasStoryAudioInfo=4]="ContentRootHasStoryAudioInfo",e[e.ContentNodeHasContentMetadata=5]="ContentNodeHasContentMetadata",e[e.ModelRoot=6]="ModelRoot",e[e.ExternalData=7]="ExternalData"}(r=e.Meaning||(e.Meaning={}));var a;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Undefined=0]="Undefined",e[e.Uploading=1]="Uploading",e[e.UploadFailed=2]="UploadFailed",e[e.Transferring=3]="Transferring",e[e.TransferFailed=4]="TransferFailed",e[e.WaitingPreProcessing=5]="WaitingPreProcessing",e[e.PreProcessing=6]="PreProcessing",e[e.PreProcessingFailed=7]="PreProcessingFailed",e[e.PendingProcessing=8]="PendingProcessing",e[e.Failed=9]="Failed",e[e.Ready=10]="Ready"}(a=e.ContentState||(e.ContentState={}));var s;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Unknown=0]="Unknown",e[e.Other=1]="Other",e[e.NonCroppable=2]="NonCroppable"}(s=e.ImageSemantic||(e.ImageSemantic={}));var l;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.None=0]="None",e[e.Generic=1]="Generic",e[e.TimeOut=2]="TimeOut",e[e.InternalProcessingError=3]="InternalProcessingError",e[e.FeatureDisabled=4]="FeatureDisabled",e[e.CorruptedFile=5]="CorruptedFile",e[e.UnsupportedFormat=6]="UnsupportedFormat"}(l=e.ProcessingErrorMessage||(e.ProcessingErrorMessage={}));var c;!function(e){e[e.UnknownValue=-1]="UnknownValue",e[e.Unknown=0]="Unknown",e[e.CreateNew=1]="CreateNew",e[e.DocIngestionWord=2]="DocIngestionWord",e[e.DocIngestionPowerPoint=3]="DocIngestionPowerPoint",e[e.DocIngestionPdf=4]="DocIngestionPdf",e[e.DocIngestionOneNote=5]="DocIngestionOneNote",e[e.StartFromTopic=6]="StartFromTopic",e[e.Duplication=7]="Duplication",e[e.TemplateDuplication=8]="TemplateDuplication",e[e.Uploaded=9]="Uploaded",e[e.Facebook=10]="Facebook",e[e.WinPhoto=11]="WinPhoto",e[e.CreatedUsingApi=12]="CreatedUsingApi",e[e.CreateNewWithGhostedContent=13]="CreateNewWithGhostedContent",e[e.DuplicateStoryForFeedback=14]="DuplicateStoryForFeedback",e[e.ExampleSway=15]="ExampleSway",e[e.DocsDotCom=16]="DocsDotCom",e[e.NearPod=17]="NearPod",e[e.DocsDotComApiCopySway=18]="DocsDotComApiCopySway",e[e.ApiCopySway=19]="ApiCopySway",e[e.PublishWordOnline=20]="PublishWordOnline",e[e.PublishWordClient=21]="PublishWordClient",e[e.OfficeDotComWord=22]="OfficeDotComWord",e[e.OfficeDotComPowerPoint=23]="OfficeDotComPowerPoint",e[e.OfficeDotComPdf=24]="OfficeDotComPdf"}(c=e.CreationMethod||(e.CreationMethod={}));var u=function(){function e(){}return e.prototype.serializeProperties=function(e,t){return p.SerializeProperties(e,t)},e.prototype.deserializeProperties=function(e,t){return p.DeserializeProperties(e,t)},e}(),p=function(){function p(e){this._model=new t(e,p.DefaultProps,p.PropNotifierMappings),this._model.isEmpty()&&(this.createObject(n.Root,"ModelRoot"),this.createObject(n.ContentRoot,"ContentRoot"),this.addRelationship("ModelRoot","ContentRoot",r.ModelRoot))}return p.prototype.createObject=function(e,t){return this._model.createObject(n[e],t)},p.prototype.containsObject=function(e){return this._model.containsObject(e)},p.prototype.getObjectType=function(e){return n[this._model.getObjectType(e)]},p.prototype.getProperty=function(e,t,o){return this._model.getProperty(e,i[t],o)},p.prototype.setProperty=function(e,t,o,n){void 0===n&&(n=!0),this._model.setProperty(e,i[t],o,n)},p.prototype.updateProperty=function(e,t){this._model.updateProperty(e,i[t])},p.prototype.resetProperty=function(e,t){this._model.resetProperty(e,i[t])},p.prototype.addRelationship=function(e,t,o,n){this._model.addRelationship(e,t,p.HashedMeanings[o],n)},p.prototype.removeRelationship=function(e,t,o){this._model.removeRelationship(e,t,p.HashedMeanings[o])},p.prototype.setRelationships=function(e,t,o){this._model.setRelationships(e,t,p.HashedMeanings[o])},p.prototype.getObjectsRelatedFrom=function(e,t,o){return this._model.getObjectsRelatedFrom(e,p.HashedMeanings[t],o)},p.prototype.getObjectsRelatedTo=function(e,t,o){return this._model.getObjectsRelatedTo(e,p.HashedMeanings[t],o)},p.prototype.isExternalObject=function(e){return this._model.isExternalObject(e)},p.prototype.getExternalDataId=function(e){return this._model.getExternalDataId(e)},p.prototype.registerObjectDisposalCallback=function(e){this._model.registerObjectDisposalCallback(e)},p.SerializeProperties=function(e,o){var n=t.GetObjectTypeFromPropBagType(e);if(n){var i={},r=0;for(var a in o)if(o.hasOwnProperty(a)){var s=p.EnumValues[n][a],l=p.StructValues[n][a],c=p.StructCollectionValues[n][a],u=p.PropertyCollectionValues[n][a],d=p.EnumCollectionValues[n][a];s?s.flags?i[a]=Flags.serialize(s,o[a]):-1===o[a].IntValue?i[a]=o[a].StringValue:i[a]=s.type[o[a].IntValue]:i[a]=l?o[a].serialize():c?o[a].serialize():u?o[a].serialize():d?o[a].serialize(function(e){return p.EnumCollectionValueTypes[n][a].type[e]}):o[a],r++}return r>0?i:void 0}},p.DeserializeProperties=function(n,i){var r=t.GetObjectTypeFromPropBagType(n);if(r){var a=p.DefaultProps[r];if(a){var s=Object.create(a);for(var l in i){var c=p.EnumValues[r][l],u=p.StructValues[r][l],d=p.StructCollectionValues[r][l],g=p.PropertyCollectionValues[r][l],y=p.EnumCollectionValues[r][l];if(c)if(c.flags)s[l]=Flags.deserialize(c.type,i[l]);else{var h=i[l];s[l]=new o(c.type[h]||h)}else if(u)s[l]=u.Deserialize(i[l]);else if(d)s[l]=new e.StructCollection,s[l].deserializeStructCollection(i[l],d.Deserialize);else if(g)s[l]=new e.PropertyCollection,s[l].deserializePropertyCollection(i[l]);else if(y){var f=p.EnumCollectionValueTypes[r][l].type;s[l]=new e.EnumCollection,s[l].deserializeEnumCollection(i[l],f)}else s[l]=i[l]}return s}}},p.getHashedMeanings=function(){var e={};return e[r.ContentRootHasContentNode]="BDoXyO",e[r.ContentRootHasImageContentPart]="5Sl2Yr",e[r.ContentRootHasImportingOrEmbeddingDocumentContent]="Fn67kw",e[r.ContentRootHasStoryVideoInfo]="1CbiLt",e[r.ContentRootHasStoryAudioInfo]="4tzhox",e[r.ContentNodeHasContentMetadata]="7EeJQD",e[r.ModelRoot]="2SLmQk",e[r.ExternalData]="9w0IDE",e},p.getDefaultProps=function(){return{ContentRoot:{DocumentIngestionInProcess:!1,DocumentIngestionPreparedEarlySway:!1,IngestionResultCode:0,IngestionNotifyStatus:0,IngestionFilename:"",OneNoteContainerName:"",StoryCreationMethod:new o(c.Unknown),IsSwspStory:!1},ContentNode:{ContentState:new o(a.Undefined),RetryCount:0,Timestamp:""},VideoContentMetadata:{VideoPlayerDescriptorOverride:"",DurationOverride:"",StreamingId:"",ProcessingError:new o(l.None)},AudioContentMetadata:{AudioPlayerDescriptorOverride:"",DurationOverride:"",StreamingId:"",ProcessingError:new o(l.None)},ImageContentPart:{Width:0,Height:0,Semantic:new o(s.Unknown),SourceUrlOverride:""},ImportingOrEmbeddingDocumentContent:{DocumentID:"",ContentState:new o(a.Undefined)},StoryVideoInfo:{VideoId:"",VideoModelIds:null},StoryAudioInfo:{AudioId:"",AudioModelIds:null,AssetCleaned:!1},Root:{SchemaVersion:0}}},p.getPropNotifierMappings=function(){return{ContentRoot:{DocumentIngestionInProcess:"Main",DocumentIngestionPreparedEarlySway:"Main",IngestionResultCode:"Main",IngestionNotifyStatus:"Main",IngestionFilename:"Main",OneNoteContainerName:"Main",StoryCreationMethod:"Main",IsSwspStory:"Main"},ContentNode:{ContentState:"Main",RetryCount:"Main",Timestamp:"Main"},VideoContentMetadata:{VideoPlayerDescriptorOverride:"Main",DurationOverride:"Main",StreamingId:"Main",ProcessingError:"Main"},AudioContentMetadata:{AudioPlayerDescriptorOverride:"Main",DurationOverride:"Main",StreamingId:"Main",ProcessingError:"Main"},ImageContentPart:{Width:"Main",Height:"Main",Semantic:"Main",SourceUrlOverride:"Main"},ImportingOrEmbeddingDocumentContent:{DocumentID:"Main",ContentState:"Main"},StoryVideoInfo:{VideoId:"Main",VideoModelIds:"Main"},StoryAudioInfo:{AudioId:"Main",AudioModelIds:"Main",AssetCleaned:"Main"},Root:{SchemaVersion:"Main"}}},p.getEnumValues=function(){return{ContentRoot:{StoryCreationMethod:{flags:!1,type:c}},ContentNode:{ContentState:{flags:!1,type:a}},VideoContentMetadata:{ProcessingError:{flags:!1,type:l}},AudioContentMetadata:{ProcessingError:{flags:!1,type:l}},ImageContentPart:{Semantic:{flags:!1,type:s}},ImportingOrEmbeddingDocumentContent:{ContentState:{flags:!1,type:a}},StoryVideoInfo:{},StoryAudioInfo:{},Root:{}}},p.getEnumCollectionValues=function(){return{ContentRoot:{},ContentNode:{},VideoContentMetadata:{},AudioContentMetadata:{},ImageContentPart:{},ImportingOrEmbeddingDocumentContent:{},StoryVideoInfo:{},StoryAudioInfo:{},Root:{}}},p.SetStructValues=function(){p.StructValues={ContentRoot:{},ContentNode:{},VideoContentMetadata:{},AudioContentMetadata:{},ImageContentPart:{},ImportingOrEmbeddingDocumentContent:{},StoryVideoInfo:{},StoryAudioInfo:{},Root:{}}},p.SetStructCollectionValues=function(){p.StructCollectionValues={ContentRoot:{},ContentNode:{},VideoContentMetadata:{},AudioContentMetadata:{},ImageContentPart:{},ImportingOrEmbeddingDocumentContent:{},StoryVideoInfo:{},StoryAudioInfo:{},Root:{}}},p.SetPropertyCollectionValues=function(){p.PropertyCollectionValues={ContentRoot:{},ContentNode:{},VideoContentMetadata:{},AudioContentMetadata:{},ImageContentPart:{},ImportingOrEmbeddingDocumentContent:{},StoryVideoInfo:{VideoModelIds:!0},StoryAudioInfo:{AudioModelIds:!0},Root:{}}},p.SetEnumCollectionValues=function(){p.EnumCollectionValues={ContentRoot:{},ContentNode:{},VideoContentMetadata:{},AudioContentMetadata:{},ImageContentPart:{},ImportingOrEmbeddingDocumentContent:{},StoryVideoInfo:{},StoryAudioInfo:{},Root:{}}},p.PropSerializer=new u,p.DefaultProps=p.getDefaultProps(),p.PropNotifierMappings=p.getPropNotifierMappings(),p.EnumValues=p.getEnumValues(),p.EnumCollectionValueTypes=p.getEnumCollectionValues(),p.HashedMeanings=p.getHashedMeanings(),p.RootId="ModelRoot",p}();e.ContentStorageGraph=p}(e.CSM||(e.CSM={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){var t=StoryApp.Model.GraphModel,o=StoryApp.Model.EnumWrapper;!function(e){function n(e,t){var o=e.prototype;for(var n in t)o[n]=t[n]}var i={getDocumentIngestionInProcess:function(t){return this.getProperty(e.Prop.DocumentIngestionInProcess,t)},setDocumentIngestionInProcess:function(t){this.setProperty(e.Prop.DocumentIngestionInProcess,t)},getDocumentIngestionPreparedEarlySway:function(t){return this.getProperty(e.Prop.DocumentIngestionPreparedEarlySway,t)},setDocumentIngestionPreparedEarlySway:function(t){this.setProperty(e.Prop.DocumentIngestionPreparedEarlySway,t)},getIngestionResultCode:function(t){return this.getProperty(e.Prop.IngestionResultCode,t)},setIngestionResultCode:function(t){this.setProperty(e.Prop.IngestionResultCode,t)},getIngestionNotifyStatus:function(t){return this.getProperty(e.Prop.IngestionNotifyStatus,t)},setIngestionNotifyStatus:function(t){this.setProperty(e.Prop.IngestionNotifyStatus,t)},getIngestionFilename:function(t){return this.getProperty(e.Prop.IngestionFilename,t)},setIngestionFilename:function(t){this.setProperty(e.Prop.IngestionFilename,t)},getOneNoteContainerName:function(t){return this.getProperty(e.Prop.OneNoteContainerName,t)},setOneNoteContainerName:function(t){this.setProperty(e.Prop.OneNoteContainerName,t)},getStoryCreationMethod:function(t){return this.getProperty(e.Prop.StoryCreationMethod,t).IntValue},setStoryCreationMethod:function(t){this.setProperty(e.Prop.StoryCreationMethod,new o(t))},setStoryCreationMethodInternal:function(t){this.setProperty(e.Prop.StoryCreationMethod,t)},getIsSwspStory:function(t){return this.getProperty(e.Prop.IsSwspStory,t)},setIsSwspStory:function(t){this.setProperty(e.Prop.IsSwspStory,t)}},r={getContentState:function(t){return this.getProperty(e.Prop.ContentState,t).IntValue},setContentState:function(t){this.setProperty(e.Prop.ContentState,new o(t))},setContentStateInternal:function(t){this.setProperty(e.Prop.ContentState,t)},getRetryCount:function(t){return this.getProperty(e.Prop.RetryCount,t)},setRetryCount:function(t){this.setProperty(e.Prop.RetryCount,t)},getTimestamp:function(t){return this.getProperty(e.Prop.Timestamp,t)},setTimestamp:function(t){this.setProperty(e.Prop.Timestamp,t)},getMetadata:function(t){return this.getRelationshipFrom(e.Meaning.ContentNodeHasContentMetadata,t)},setMetadata:function(t){this.setRelationships(t?[t]:[],e.Meaning.ContentNodeHasContentMetadata)}},a={getProcessingError:function(t){return this.getProperty(e.Prop.ProcessingError,t).IntValue},setProcessingError:function(t){this.setProperty(e.Prop.ProcessingError,new o(t))},setProcessingErrorInternal:function(t){this.setProperty(e.Prop.ProcessingError,t)}},s={getVideoPlayerDescriptorOverride:function(t){return this.getProperty(e.Prop.VideoPlayerDescriptorOverride,t)},setVideoPlayerDescriptorOverride:function(t){this.setProperty(e.Prop.VideoPlayerDescriptorOverride,t)},getDurationOverride:function(t){return this.getProperty(e.Prop.DurationOverride,t)},setDurationOverride:function(t){this.setProperty(e.Prop.DurationOverride,t)},getStreamingId:function(t){return this.getProperty(e.Prop.StreamingId,t)},setStreamingId:function(t){this.setProperty(e.Prop.StreamingId,t)}},l={getAudioPlayerDescriptorOverride:function(t){return this.getProperty(e.Prop.AudioPlayerDescriptorOverride,t)},setAudioPlayerDescriptorOverride:function(t){this.setProperty(e.Prop.AudioPlayerDescriptorOverride,t)},getDurationOverride:function(t){return this.getProperty(e.Prop.DurationOverride,t)},setDurationOverride:function(t){this.setProperty(e.Prop.DurationOverride,t)},getStreamingId:function(t){return this.getProperty(e.Prop.StreamingId,t)},setStreamingId:function(t){this.setProperty(e.Prop.StreamingId,t)}},c={getWidth:function(t){return this.getProperty(e.Prop.Width,t)},setWidth:function(t){this.setProperty(e.Prop.Width,t)},getHeight:function(t){return this.getProperty(e.Prop.Height,t)},setHeight:function(t){this.setProperty(e.Prop.Height,t)},getSemantic:function(t){return this.getProperty(e.Prop.Semantic,t).IntValue},setSemantic:function(t){this.setProperty(e.Prop.Semantic,new o(t))},setSemanticInternal:function(t){this.setProperty(e.Prop.Semantic,t)},getSourceUrlOverride:function(t){return this.getProperty(e.Prop.SourceUrlOverride,t)},setSourceUrlOverride:function(t){this.setProperty(e.Prop.SourceUrlOverride,t)}},u={getDocumentID:function(t){return this.getProperty(e.Prop.DocumentID,t)},setDocumentID:function(t){this.setProperty(e.Prop.DocumentID,t)},getContentState:function(t){return this.getProperty(e.Prop.ContentState,t).IntValue},setContentState:function(t){this.setProperty(e.Prop.ContentState,new o(t))},setContentStateInternal:function(t){this.setProperty(e.Prop.ContentState,t)}},p={getVideoId:function(t){return this.getProperty(e.Prop.VideoId,t)},setVideoId:function(t){this.setProperty(e.Prop.VideoId,t)},getVideoModelIds:function(t){var o=this.getProperty(e.Prop.VideoModelIds,t);return null==o&&(o=new w,this.setProperty(e.Prop.VideoModelIds,o,!1)),o.setObjectProperty(this,e.Prop.VideoModelIds),o}},d={getAudioId:function(t){return this.getProperty(e.Prop.AudioId,t)},setAudioId:function(t){this.setProperty(e.Prop.AudioId,t)},getAudioModelIds:function(t){var o=this.getProperty(e.Prop.AudioModelIds,t);return null==o&&(o=new w,this.setProperty(e.Prop.AudioModelIds,o,!1)),o.setObjectProperty(this,e.Prop.AudioModelIds),o},getAssetCleaned:function(t){return this.getProperty(e.Prop.AssetCleaned,t)},setAssetCleaned:function(t){this.setProperty(e.Prop.AssetCleaned,t)}},g=function(t){function o(e,o,n){var i=t.call(this,null)||this;if(!o.graph.containsObject(e))throw new Error("Object does not exist.");return i.id=e,i.contentStorageModel=o,i.objectType=n,i}return __extends(o,t),o.prototype.getProperty=function(e,t){var o=this;return o.contentStorageModel.graph.getProperty(o.id,e,t)},o.prototype.setProperty=function(e,t,o){void 0===o&&(o=!0);var n=this;n.contentStorageModel.graph.setProperty(n.id,e,t,o)},o.prototype.updateProperty=function(e){var t=this;t.contentStorageModel.graph.updateProperty(t.id,e)},o.prototype.getRelationshipsFrom=function(e,t){var o=this,n=o.contentStorageModel.graph.getObjectsRelatedFrom(o.id,e,t);if(!n)return[];for(var i=n.length,r=[],a=o.contentStorageModel,s=0;s<i;s++)r.push(a.getModelObject(n[s]));return r},o.prototype.getRelationshipsTo=function(e,t){var o=this,n=o.contentStorageModel.graph.getObjectsRelatedTo(o.id,e,t);if(!n)return[];for(var i=n.length,r=[],a=o.contentStorageModel,s=0;s<i;s++)r.push(a.getModelObject(n[s]));return r},o.prototype.getRelationshipFrom=function(e,t){var o=this,n=o.contentStorageModel.graph.getObjectsRelatedFrom(o.id,e,t);if(n&&0!=n.length)return o.contentStorageModel.getModelObject(n[0])},o.prototype.getRelationshipTo=function(e,t){var o=this,n=o.contentStorageModel.graph.getObjectsRelatedTo(o.id,e,t);if(n&&0!=n.length)return o.contentStorageModel.getModelObject(n[0])},o.prototype.addRelationship=function(e,t,o){var n=this;n.contentStorageModel.graph.addRelationship(n.id,e.id,t,o)},o.prototype.removeRelationship=function(e,t){var o=this;o.contentStorageModel.graph.removeRelationship(o.id,e.id,t)},o.prototype.setRelationships=function(e,t){for(var o=this,n=e.length,i=[],r=0;r<n;r++)i.push(e[r].id);o.contentStorageModel.graph.setRelationships(o.id,i,t)},o.prototype.getExternalDataId=function(t){var o=this,n=o.contentStorageModel.graph,i=n.getObjectsRelatedFrom(o.id,e.Meaning.ExternalData,t);return i&&i.length>0?n.getExternalDataId(i[0]):void 0},o}(DisposableObjectOM);e.ModelObject=g;var y=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.ContentRoot)||this;return i.model=o.contentRoot,i.contentNodes=new A(i,e.Meaning.ContentRootHasContentNode),i.imageContentParts=new A(i,e.Meaning.ContentRootHasImageContentPart),i.documentIDs=new A(i,e.Meaning.ContentRootHasImportingOrEmbeddingDocumentContent),i.storyVideos=new A(i,e.Meaning.ContentRootHasStoryVideoInfo),i.storyAudios=new A(i,e.Meaning.ContentRootHasStoryAudioInfo),i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.ContentRoot,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.ContentRoot],t[o.id]=!0,n.documentIngestionInProcess=o.getDocumentIngestionInProcess(),n.documentIngestionPreparedEarlySway=o.getDocumentIngestionPreparedEarlySway(),n.ingestionResultCode=o.getIngestionResultCode(),n.ingestionNotifyStatus=o.getIngestionNotifyStatus(),n.ingestionFilename=o.getIngestionFilename(),n.oneNoteContainerName=o.getOneNoteContainerName();var i=o.getProperty(e.Prop.StoryCreationMethod);return-1===i.IntValue?n.storyCreationMethod=i.StringValue:n.storyCreationMethod=e.CreationMethod[i.IntValue],n.isSwspStory=o.getIsSwspStory(),n.contentNodes=o.contentNodes.serialize(t),n.imageContentParts=o.imageContentParts.serialize(t),n.documentIDs=o.documentIDs.serialize(t),n.storyVideos=o.storyVideos.serialize(t),n.storyAudios=o.storyAudios.serialize(t),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.getModelObject("ContentRoot");if(void 0!==i.documentIngestionInProcess&&s.setDocumentIngestionInProcess(i.documentIngestionInProcess),void 0!==i.documentIngestionPreparedEarlySway&&s.setDocumentIngestionPreparedEarlySway(i.documentIngestionPreparedEarlySway),void 0!==i.ingestionResultCode&&s.setIngestionResultCode(i.ingestionResultCode),void 0!==i.ingestionNotifyStatus&&s.setIngestionNotifyStatus(i.ingestionNotifyStatus),void 0!==i.ingestionFilename&&s.setIngestionFilename(i.ingestionFilename),void 0!==i.oneNoteContainerName&&s.setOneNoteContainerName(i.oneNoteContainerName),void 0!==i.storyCreationMethod){var l=e.CreationMethod[i.storyCreationMethod];void 0!==l?s.setStoryCreationMethodInternal(new o(l)):s.setStoryCreationMethodInternal(new o(i.storyCreationMethod))}return void 0!==i.isSwspStory&&s.setIsSwspStory(i.isSwspStory),void 0!==i.contentNodes&&s.contentNodes.deserialize(i.contentNodes,r),void 0!==i.imageContentParts&&s.imageContentParts.deserialize(i.imageContentParts,r),void 0!==i.documentIDs&&s.documentIDs.deserialize(i.documentIDs,r),void 0!==i.storyVideos&&s.storyVideos.deserialize(i.storyVideos,r),void 0!==i.storyAudios&&s.storyAudios.deserialize(i.storyAudios,r),s},i}(g);e.ContentRoot=y,n(y,i);var h=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.ContentNode)||this;return i.model=o.contentRoot,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.ContentNode,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.ContentNode],t[o.id]=!0;var i=o.getProperty(e.Prop.ContentState);return-1===i.IntValue?n.contentState=i.StringValue:n.contentState=e.ContentState[i.IntValue],n.retryCount=o.getRetryCount(),n.timestamp=o.getTimestamp(),void 0!==o.getMetadata()&&(n.metadata=o.getMetadata().serialize(t)),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.ContentNode,a),l=n.getModelObject(s);if(void 0!==i.contentState){var c=e.ContentState[i.contentState];void 0!==c?l.setContentStateInternal(new o(c)):l.setContentStateInternal(new o(i.contentState))}return void 0!==i.retryCount&&l.setRetryCount(i.retryCount),void 0!==i.timestamp&&l.setTimestamp(i.timestamp),void 0!==i.metadata&&l.setMetadata(n.deserialize(i.metadata,r)),l},i}(g);e.ContentNode=h,n(h,r);var f=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.VideoContentMetadata)||this;return i.model=o.contentRoot,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.VideoContentMetadata,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.VideoContentMetadata],t[o.id]=!0,n.videoPlayerDescriptorOverride=o.getVideoPlayerDescriptorOverride(),n.durationOverride=o.getDurationOverride(),n.streamingId=o.getStreamingId();var i=o.getProperty(e.Prop.ProcessingError);return-1===i.IntValue?n.processingError=i.StringValue:n.processingError=e.ProcessingErrorMessage[i.IntValue],n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.VideoContentMetadata,a),l=n.getModelObject(s);if(void 0!==i.videoPlayerDescriptorOverride&&l.setVideoPlayerDescriptorOverride(i.videoPlayerDescriptorOverride),void 0!==i.durationOverride&&l.setDurationOverride(i.durationOverride),void 0!==i.streamingId&&l.setStreamingId(i.streamingId),void 0!==i.processingError){var c=e.ProcessingErrorMessage[i.processingError];void 0!==c?l.setProcessingErrorInternal(new o(c)):l.setProcessingErrorInternal(new o(i.processingError))}return l},i}(g);e.VideoContentMetadata=f,n(f,a),n(f,s);var S=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.AudioContentMetadata)||this;return i.model=o.contentRoot,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.AudioContentMetadata,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.AudioContentMetadata],t[o.id]=!0,n.audioPlayerDescriptorOverride=o.getAudioPlayerDescriptorOverride(),n.durationOverride=o.getDurationOverride(),n.streamingId=o.getStreamingId();var i=o.getProperty(e.Prop.ProcessingError);return-1===i.IntValue?n.processingError=i.StringValue:n.processingError=e.ProcessingErrorMessage[i.IntValue],n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.AudioContentMetadata,a),l=n.getModelObject(s);if(void 0!==i.audioPlayerDescriptorOverride&&l.setAudioPlayerDescriptorOverride(i.audioPlayerDescriptorOverride),void 0!==i.durationOverride&&l.setDurationOverride(i.durationOverride),void 0!==i.streamingId&&l.setStreamingId(i.streamingId),void 0!==i.processingError){var c=e.ProcessingErrorMessage[i.processingError];void 0!==c?l.setProcessingErrorInternal(new o(c)):l.setProcessingErrorInternal(new o(i.processingError))}return l},i}(g);e.AudioContentMetadata=S,n(S,a),n(S,l);var m=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.ImageContentPart)||this;return i.model=o.contentRoot,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.ImageContentPart,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.ImageContentPart],t[o.id]=!0,n.width=o.getWidth(),n.height=o.getHeight();var i=o.getProperty(e.Prop.Semantic);return-1===i.IntValue?n.semantic=i.StringValue:n.semantic=e.ImageSemantic[i.IntValue],n.sourceUrlOverride=o.getSourceUrlOverride(),n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.ImageContentPart,a),l=n.getModelObject(s);if(void 0!==i.width&&l.setWidth(i.width),void 0!==i.height&&l.setHeight(i.height),void 0!==i.semantic){var c=e.ImageSemantic[i.semantic];void 0!==c?l.setSemanticInternal(new o(c)):l.setSemanticInternal(new o(i.semantic))}return void 0!==i.sourceUrlOverride&&l.setSourceUrlOverride(i.sourceUrlOverride),l},i}(g);e.ImageContentPart=m,n(m,c);var v=function(n){function i(t,o){var i=n.call(this,t,o,e.ObjectType.ImportingOrEmbeddingDocumentContent)||this;return i.model=o.contentRoot,i}return __extends(i,n),i.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.ImportingOrEmbeddingDocumentContent,o);return t.getModelObject(n)},i.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};if(n.id=o.id,void 0!==t[o.id])return n.ref=!0,n;n.objType=e.ObjectType[e.ObjectType.ImportingOrEmbeddingDocumentContent],t[o.id]=!0,n.documentID=o.getDocumentID();var i=o.getProperty(e.Prop.ContentState);return-1===i.IntValue?n.contentState=i.StringValue:n.contentState=e.ContentState[i.IntValue],n},i.Deserialize=function(n,i,r){var a=i.id;if(r&&(r[i.id]||(r[i.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),a=r[i.id]),i.ref)return n.getModelObject(a);var s=n.graph.createObject(e.ObjectType.ImportingOrEmbeddingDocumentContent,a),l=n.getModelObject(s);if(void 0!==i.documentID&&l.setDocumentID(i.documentID),void 0!==i.contentState){var c=e.ContentState[i.contentState];void 0!==c?l.setContentStateInternal(new o(c)):l.setContentStateInternal(new o(i.contentState))}return l},i}(g);e.ImportingOrEmbeddingDocumentContent=v,n(v,u);var C=function(o){function n(t,n){var i=o.call(this,t,n,e.ObjectType.StoryVideoInfo)||this;return i.model=n.contentRoot,i}return __extends(n,o),n.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.StoryVideoInfo,o);return t.getModelObject(n)},n.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};return n.id=o.id,void 0!==t[o.id]?(n.ref=!0,n):(n.objType=e.ObjectType[e.ObjectType.StoryVideoInfo],t[o.id]=!0,n.videoId=o.getVideoId(),null!=o.getVideoModelIds()&&(n.videoModelIds=o.getVideoModelIds().serialize()),n)},n.Deserialize=function(o,n,i){var r=n.id;if(i&&(i[n.id]||(i[n.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),r=i[n.id]),n.ref)return o.getModelObject(r);var a=o.graph.createObject(e.ObjectType.StoryVideoInfo,r),s=o.getModelObject(a);return void 0!==n.videoId&&s.setVideoId(n.videoId),void 0!==n.videoModelIds&&s.getVideoModelIds().deserializePropertyCollection(n.videoModelIds),s},n}(g);e.StoryVideoInfo=C,n(C,p);var P=function(o){function n(t,n){var i=o.call(this,t,n,e.ObjectType.StoryAudioInfo)||this;return i.model=n.contentRoot,i}return __extends(n,o),n.Create=function(t,o){var n=t.graph.createObject(e.ObjectType.StoryAudioInfo,o);return t.getModelObject(n)},n.prototype.serialize=function(t){var o=this;void 0===t&&(t={});var n={};return n.id=o.id,void 0!==t[o.id]?(n.ref=!0,n):(n.objType=e.ObjectType[e.ObjectType.StoryAudioInfo],t[o.id]=!0,n.audioId=o.getAudioId(),null!=o.getAudioModelIds()&&(n.audioModelIds=o.getAudioModelIds().serialize()),n.assetCleaned=o.getAssetCleaned(),n)},n.Deserialize=function(o,n,i){var r=n.id;if(i&&(i[n.id]||(i[n.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),r=i[n.id]),n.ref)return o.getModelObject(r);var a=o.graph.createObject(e.ObjectType.StoryAudioInfo,r),s=o.getModelObject(a);return void 0!==n.audioId&&s.setAudioId(n.audioId),void 0!==n.audioModelIds&&s.getAudioModelIds().deserializePropertyCollection(n.audioModelIds),void 0!==n.assetCleaned&&s.setAssetCleaned(n.assetCleaned),s},n}(g);e.StoryAudioInfo=P,n(P,d);var I=function(o){function n(t){var n=o.call(this)||this;return n.graph=new e.ContentStorageGraph(t),n._modelObjects={},n._creators={ContentRoot:y,ContentNode:h,VideoContentMetadata:f,AudioContentMetadata:S,ImageContentPart:m,ImportingOrEmbeddingDocumentContent:v,StoryVideoInfo:C,StoryAudioInfo:P},n.contentRoot=n.getModelObject("ContentRoot"),n.graph.registerObjectDisposalCallback(n.disposeModelObjects.bind(n)),n}return __extends(n,o),n.prototype.getModelObject=function(t){var o=this;return o.graph.containsObject(t)?(void 0===o._modelObjects[t]&&(o._modelObjects[t]=new(o._creators[e.ObjectType[o.graph.getObjectType(t)]])(t,o)),o._modelObjects[t]):null},n.prototype.getSchemaVersion=function(){return this.graph.getProperty("ModelRoot",e.Prop.SchemaVersion)},n.prototype.disposeModelObjects=function(e){for(var t=this,o=0;o<e.length;o++){var n=e[o],i=t._modelObjects[n];i&&i.dispose(),delete t._modelObjects[n]}},n.prototype.deserialize=function(e,o){var n=this,i=e.id;if(o&&(o[e.id]||(o[e.id]=IdGenerator.generate().substr(0,t.MaxNodeIdLength)),i=o[e.id]),e.ref)return n.getModelObject(i);if(void 0===e.objType)throw new Error("Missing object type encountered when deserializing object.");if(void 0===n._creators[e.objType])throw new Error("Invalid object type encountered when deserializing object.");return n._creators[e.objType].Deserialize(n,e,o)},n.PropSerializer=e.ContentStorageGraph.PropSerializer,n.RootId=e.ContentStorageGraph.RootId,n.ModelType=2,n}(ObjectOM);e.ContentStorageModel=I;var T=function(e){function t(t,o,n,i,r){var a=e.call(this)||this;return a._modelObject=t,a._leftProp=o,a._topProp=n,a._widthProp=i,a._heightProp=r,a}return __extends(t,e),t.prototype.getLeft=function(e){var t=this;return t._modelObject.getProperty(t._leftProp,e)},t.prototype.setLeft=function(e){var t=this;t._modelObject.setProperty(t._leftProp,e)},t.prototype.getTop=function(e){var t=this;return t._modelObject.getProperty(t._topProp,e)},t.prototype.setTop=function(e){var t=this;t._modelObject.setProperty(t._topProp,e)},t.prototype.getWidth=function(e){var t=this;return t._modelObject.getProperty(t._widthProp,e)},t.prototype.setWidth=function(e){var t=this;t._modelObject.setProperty(t._widthProp,e)},t.prototype.getHeight=function(e){var t=this;return t._modelObject.getProperty(t._heightProp,e)},t.prototype.setHeight=function(e){var t=this;t._modelObject.setProperty(t._heightProp,e)},t}(ObjectOM);e.Rectangle=T;var M=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.prototype.setParent=function(e){var t=this;if(null!=e&&null!=t._parent)throw new Error("You must orphan this element before setting it to a new parent.");t._parent=e},t.prototype.setObjectProperty=function(e,t){var o=this;o._modelObject=e,o._prop=t},t.prototype.propertyUpdated=function(){var e=this;null!=e._parent?e._parent.propertyUpdated():void 0!=e._modelObject&&void 0!=e._prop&&e._modelObject.updateProperty(e._prop)},t.prototype.watchProperty=function(e){var t=this;void 0!=e&&(null!=t._parent?t._parent.watchProperty(e):void 0!=t._modelObject&&void 0!=t._prop&&t._modelObject.getProperty(t._prop,e))},t.prototype.copyFrom=function(e){var t=this;t._modelObject=e._modelObject,t._prop=e._prop},t}(ObjectOM);e.PropertyParent=M;var b=function(e){function t(t,o,n){var i=e.call(this)||this;return i.modelObject=t,i.meaning=o,i.forward=n,i}return __extends(t,e),t.prototype.getCollection=function(e){var t=this;return t.forward?t.modelObject.getRelationshipsFrom(t.meaning,e):t.modelObject.getRelationshipsTo(t.meaning,e)},t}(ObjectOM);e.ObjectCollection=b;var A=function(e){function t(t,o){return e.call(this,t,o,!0)||this}return __extends(t,e),t.prototype.add=function(e,t){var o=this;o.modelObject.addRelationship(e,o.meaning,t)},t.prototype.remove=function(e){var t=this;t.modelObject.removeRelationship(e,t.meaning)},t.prototype.removeAt=function(e){var t=this;t.remove(t.getCollection()[e])},t.prototype.set=function(e){var t=this;t.modelObject.setRelationships(e,t.meaning)},t.prototype.serialize=function(e){for(var t=[],o=this.getCollection(),n=o.length,i=0;i<n;i++)t.push(o[i].serialize(e));return t},t.prototype.deserialize=function(e,t){for(var o=this,n=0;n<e.length;n++){var i=e[n],r=o.modelObject.contentStorageModel.deserialize(i,t);o.add(r)}},t}(b);e.ObjectCollectionWritable=A;var w=function(e){function t(){var t=e.call(this)||this;return t._collection=[],t}return __extends(t,e),t.prototype.getLength=function(e){var t=this;return t.watchProperty(e),t._collection.length},t.prototype.itemAtIndex=function(e,t){var o=this;return o.watchProperty(t),o._collection[e]},t.prototype.add=function(e,t){var o=this;o.propertyUpdated(),void 0!=t?o._collection.splice(t,0,e):o._collection.push(e)},t.prototype.removeAt=function(e){var t=this;t.propertyUpdated(),t._collection.splice(e,1)},t.prototype.getCollection=function(e){var t=this;return t.watchProperty(e),t._collection},t.prototype.setCollection=function(e){var t=this;t.propertyUpdated(),t._collection=e},t.prototype.serialize=function(){var e=this,t=e.getLength();if(0!=t){for(var o=[],n=0;n<t;n++)o.push(e.itemAtIndex(n));return o}},t.prototype.deserializePropertyCollection=function(e){this._collection=e},t.prototype.copyFrom=function(t){var o=this;e.prototype.copyFrom.call(this,t),o._collection=t._collection.slice()},t.prototype.createCopy=function(){var e=this,o=new t;return o.copyFrom(e),o},t.prototype.equals=function(e){var t=this;return!!e&&StoryApp.Utilities.sequenceEquals(t._collection,e._collection)},t}(M);e.PropertyCollection=w;var _=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.add=function(t,o){var n=this;t.setParent(n),e.prototype.add.call(this,t,o)},t.prototype.removeAt=function(t){this.itemAtIndex(t).setParent(null),e.prototype.removeAt.call(this,t)},t.prototype.setCollection=function(t){for(var o=this,n=o.getLength(),i=0;i<n;i++)o.itemAtIndex(i).setParent(null);e.prototype.setCollection.call(this,t);for(var i=0,r=t.length;i<r;++i)t[i].setParent(o)},t.prototype.serialize=function(){for(var e=this,t=[],o=e.getLength(),n=0;n<o;n++)t.push(e.itemAtIndex(n).serialize());return t},t.prototype.deserializeStructCollection=function(e,t){for(var o=this;o.getLength()>0;)o.removeAt(0);for(var n=e.length,i=0;i<n;i++)o.add(t(e[i]))},t.prototype.copyFrom=function(t){var o=this;e.prototype.copyFrom.call(this,t);for(var n=o.getCollection(),i=0,r=n.length;i<r;++i){var a=n[i].createCopy();n[i]=a,a.setParent(o)}},t.prototype.createCopy=function(){var e=this,o=new t;return o.copyFrom(e),o},t.prototype.equals=function(e){var t=this;if(!e)return!1;var o=t.getCollection(),n=e.getCollection();if(o.length!==n.length)return!1;for(var i=0,r=o.length;i<r;++i)if(!o[i].equals(n[i]))return!1;return!0},t}(w);e.StructCollection=_;var O=function(e){function t(){return e.call(this)||this}return __extends(t,e),t.prototype.add=function(t,n){t instanceof o?e.prototype.add.call(this,t,n):e.prototype.add.call(this,new o(t),n)},t.prototype.removeAt=function(t){e.prototype.removeAt.call(this,t)},t.prototype.setCollection=function(t){if(t[0]instanceof o)e.prototype.setCollection.call(this,t);else{var n=[];for(var i in t)n.push(new o(i));e.prototype.setCollection.call(this,n)}},t.prototype.getCollectionCopy=function(){for(var e=[],t=this.getLength(),o=0;o<t;o++)e.push(this.itemAtIndex(o).IntValue);return e},t.prototype.serialize=function(e){for(var t=this,o=[],n=t.getLength(),i=0;i<n;i++)o.push(t.itemAtIndex(i).serialize(e));return o},t.prototype.deserializeEnumCollection=function(e,t){for(var n=this;n.getLength()>0;)n.removeAt(0);for(var i=e.length,r=0;r<i;r++){var a=t[e[r]];void 0!==a?n.add(new o(a)):n.add(new o(e[r]))}},t.prototype.copyFrom=function(t){var o=this;e.prototype.copyFrom.call(this,t);for(var n=o.getCollection(),i=0,r=n.length;i<r;++i)n[i]=n[i].createCopy()},t.prototype.createCopy=function(){var e=this,o=new t;return o.copyFrom(e),o},t.prototype.equals=function(e){var t=this;if(!e)return!1;var o=t.getCollection(),n=e.getCollection();if(o.length!==n.length)return!1;for(var i=0,r=o.length;i<r;++i)if(!o[i].equals(n[i]))return!1;return!0},t}(w);e.EnumCollection=O;var D=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t.compareUnknownDictionaries=function(e,o){if(!e||!o)return!1;if(Object.keys(e).length!==Object.keys(o).length)return!1;for(var n in e)if(e[n]!==o[n])return e[n]instanceof Object&&o[n]instanceof Object&&t.compareUnknownDictionaries(e[n],o[n]);return!0},t}(M);e.Struct=D,e.ContentStorageGraph.SetStructValues(),e.ContentStorageGraph.SetStructCollectionValues(),e.ContentStorageGraph.SetPropertyCollectionValues(),e.ContentStorageGraph.SetEnumCollectionValues()}(e.CSM||(e.CSM={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryEditPageMain;!function(e){var t=StoryApp.Common,o=function(e){function o(){return null!==e&&e.apply(this,arguments)||this}return __extends(o,e),o.prototype.join=function(o,n,i){var r=this;"undefined"==typeof swayAuthoringFirstModel?(StoryApp.Utilities.weblog(StoryPageMain.RenderModelManager.FirstModelWeblogTag,"firstModel isn't available so authoring will make the /join XHR."),e.prototype.join.call(this,o,n,i)):swayAuthoringFirstModel.data?(StoryApp.Utilities.weblog(StoryPageMain.RenderModelManager.FirstModelWeblogTag,"firstModel is loaded so we're using it."),t.Environment.getInstance().retrieveOfflineState(o).then(function(t){t?(n.offlineState=t,i.then(function(e){e&&(e.joined||e.offlineStateConflict)&&(StoryLog.StructuredTraceTag(596456610,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Offline state was uploaded successfully",{}),StoryApp.Common.Environment.getInstance().deleteOfflineState(o))},function(e,t,n){400==e.status&&(StoryLog.StructuredTraceTag(596456611,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Offline state was rejected",{}),StoryApp.Common.Environment.getInstance().deleteOfflineState(o))}),e.prototype.join.call(r,o,n,i)):i.resolve(swayAuthoringFirstModel.data),swayAuthoringFirstModel=void 0},function(e){i.reject(swayAuthoringFirstModel.xhr,"could not determine offline content","could not determine offline content")})):swayAuthoringFirstModel.xhr&&4===swayAuthoringFirstModel.xhr.readyState?(StoryApp.Utilities.weblog(StoryPageMain.RenderModelManager.FirstModelWeblogTag,"Error loading the model. Status: "+swayAuthoringFirstModel.xhr.status+"."),i.reject(swayAuthoringFirstModel.xhr,swayAuthoringFirstModel.xhr.statusText,"error loading the model")):(StoryApp.Utilities.weblog(StoryPageMain.RenderModelManager.FirstModelWeblogTag,"Waiting for the firstModel XHR to finish."),this.firstModelReadyEventListener=function(a){StoryApp.Utilities.weblog(StoryPageMain.RenderModelManager.FirstModelWeblogTag,"The firstModel XHR finished"),t.Environment.getInstance().retrieveOfflineState(o).then(function(t){t?(swayAuthoringFirstModel=void 0,n.offlineState=t,e.prototype.join.call(r,o,n,i)):i.resolve(swayAuthoringFirstModel.data),r.removeEventsAndFirstModel()},function(e){i.reject(swayAuthoringFirstModel.xhr,"could not determine offline content","could not determine offline content"),r.removeEventsAndFirstModel()})},this.firstModelFailedEventListener=function(e){StoryApp.Utilities.weblog(StoryPageMain.RenderModelManager.FirstModelWeblogTag,"The firstModel XHR failed"),i.reject(swayAuthoringFirstModel.xhr.status),r.removeEventsAndFirstModel()},document.addEventListener(FirstModel.FirstModelReadyEventName,this.firstModelReadyEventListener),document.addEventListener(FirstModel.FirstModelFailedEventName,this.firstModelFailedEventListener))},o.prototype.removeEventsAndFirstModel=function(){document.removeEventListener(FirstModel.FirstModelReadyEventName,this.firstModelReadyEventListener),document.removeEventListener(FirstModel.FirstModelFailedEventName,this.firstModelFailedEventListener),swayAuthoringFirstModel=void 0},o}(t.AjaxJoiner);e.FirstModelJoiner=o}(StoryEditPageMain||(StoryEditPageMain={}));var StoryEditPageMain;!function(e){var t=StoryAppEdit.Model.SM,o=StoryAppEdit.Model.CSM,n=function(){function n(){}return n.getNumberOfStoryElements=function(e){var t=StoryAppEdit.Model&&StoryAppEdit.Model.StoryModel;if(t){var o=t.traversalModel.getSpecifiedGrouping().getRootGroup();return n.getNumberOfGroupElements(o,e)}return 0},n.getStoryTitleText=function(e){var t=StoryAppEdit.Model&&StoryAppEdit.Model.StoryModel;if(t){var o=t.traversalModel.getSpecifiedGrouping().getRootGroup().getHeading(e).getTitle(e);if(o)return o.getContent(e).getText(e)}return""},n.getNumberOfGroupElements=function(e,o){var i=0;if(!e)return i;var r=[];if(e instanceof t.SpecifiedGroup){var a=e;r=a.children.getCollection(o);var s=a.getHeading(o);s&&(n.isTextEmpty(s.getTitle())||i++,s.getBackground(o)&&i++)}else e instanceof t.Set&&(r=e.content.getCollection(o));for(var l=r.length,c=0;c<l;c++){var u=r[c];u instanceof t.SpecifiedGroup?i+=n.getNumberOfGroupElements(u,o):u instanceof t.Set?i+=n.getNumberOfGroupElements(u,o):u instanceof t.MediaWithTextComposite?n.isMediaEmpty(u.getMedia(o),o)||(i+=1):u instanceof t.TextGroup?n.isTextEmpty(u,o)||(i+=1):i+=1}return i},n.isMediaEmpty=function(e,o){var i=0;if(e instanceof t.ImageContent)i=e.imageParts.getCollection(o).length;else if(e instanceof t.VideoContent){var r=e,a=n.calculateVideoPlayerDescriptor(r,o);i=a?a.length:0}else if(e instanceof t.AudioContent){var s=e,l=n.calculateAudioPlayerDescriptor(s,o);i=l?l.length:0}return 0===i},n.calculateVideoPlayerDescriptor=function(t,n){if(!t)return null;var i=null,r=StoryAppEdit.Model.ContentStorageModel.getModelObject(t.id);r||StoryAppEdit.Model.ContentStorageModel.contentRoot.contentNodes.getCollection(n);var a=r?r.getMetadata(n):null;if(a&&a instanceof o.VideoContentMetadata&&(i=a.getVideoPlayerDescriptorOverride(n)),!i){var s=t.getDecompInfo(n);if(s){var l=t.getVideoPlayerDescriptor(n),c=e.MediaPlayerDescriptorHandlerFactory.createVideoHandler(s.getProvider(n));!l||c.isDescriptorFake(l)||c.isCopyDescriptor(l)||(i=t.getVideoPlayerDescriptor(n))}}return i},n.calculateAudioPlayerDescriptor=function(t,n){if(!t)return null;var i=null,r=StoryAppEdit.Model.ContentStorageModel.getModelObject(t.id);r||StoryAppEdit.Model.ContentStorageModel.contentRoot.contentNodes.getCollection(n);var a=r?r.getMetadata(n):null;if(a&&a instanceof o.AudioContentMetadata&&(i=a.getAudioPlayerDescriptorOverride(n)),!i){var s=t.getDecompInfo(n);if(s){var l=t.getAudioPlayerDescriptor(n),c=e.MediaPlayerDescriptorHandlerFactory.createAudioHandler(s.getProvider(n));!l||c.isDescriptorFake(l)||c.isCopyDescriptor(l)||(i=t.getAudioPlayerDescriptor(n))}}return i},n.isTextEmpty=function(e,o){if(e instanceof t.TextGroup){var n=e.children.getCollection(o);if(n.length>1)return!1;if(n.length<1)return!0;var i=n[0];return i instanceof t.Paragraph&&(!i.getContent()||!i.getContent().getText(o))}return e instanceof t.Paragraph&&!e.getContent().getText(o)},n}();e.ModelHelper=n}(StoryEditPageMain||(StoryEditPageMain={}));var StoryEditPageMain;!function(e){var t=StoryAppEdit.Model.SM,o=StoryApp.View.ViewElements,n=StoryApp.View.Common.FRE,i=function(){function i(){}return i.activateSwayLoadedTrigger=function(e){if("ConsumptionClientId"!=e)if(StoryAppEdit.Model.ContentStorageModel.contentRoot.getDocumentIngestionInProcess())i.calloutsBlockedDuringDocIngestion=!0;else if(this.hasHints(StoryAppEdit.Model.StoryModel.traversalModel.getSpecifiedGrouping().getRootGroup()))n.FirstRunTriggers.hintsAvailable();else{var t=n.getFirstRunManager().getFirstRunType();if(t===n.FirstRunType.Default)o.ViewModel.isPreviewMode.getValue()?StoryPageSettings.IsOwner?n.FirstRunTriggers.digitalPrintEntryPoint():n.FirstRunTriggers.shareSwayAADRecipients():o.ViewModel.authoringPaneOpen.getValue()?0==o.ViewModel.titleWatcher.getWatchedValue().length?n.FirstRunTriggers.swayLoaded(!1):i.hasContentThreshold()?n.FirstRunTriggers.thresholdContentAdded(!1):n.FirstRunTriggers.swayTitleAdded(!0):n.FirstRunTriggers.navigatedToDesign();else{if(t!==n.FirstRunType.FRENonEmpty)return void TDB.raiseRecoverableError("Unhandled first run type: "+t,TDB.LogLevel.error);n.FirstRunTriggers.swayTitleAdded(i.hasContentThreshold())}}else StoryApp.View.ViewElements.NavigationHelper.hasContentOverflow()&&n.StoryFirstRunHelper.triggerPlayEntered()},i.hasContentThreshold=function(t){return e.ModelHelper.getNumberOfStoryElements(t)>=4},i.hasHints=function(e){if(!e)return!1;if(e.getAuthoringHint())return!0;if(e instanceof t.MediaWithTextComposite&&e.getText()&&e.getText().getAuthoringHint())return!0;var o=null;if(e instanceof t.SpecifiedGroup)o=e.children;else{if(!(e instanceof t.Set))return!1;o=e.content}for(var n=o.getCollection(),i=0;i<n.length;i++)if(this.hasHints(n[i]))return!0;return!1},i.calloutsBlockedDuringDocIngestion=!1,i}();e.FREHelper=i}(StoryEditPageMain||(StoryEditPageMain={}));var StoryAppEdit;!function(e){!function(e){e.StoryModel=null,e.ContentStorageModel=null,e.IsPremiumSway=!1}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryPageEditSettings,StoryAppEdit;!function(e){!function(t){!function(o){var n=StoryApp.RethrowLogger,i=function(){function t(e){if(e)for(var t in e)"type"!==t&&(this[t]=e[t])}return t.prototype.inCollection=function(){return!this.name},t.Deserialize=function(t){var o=t.type,i=o+"PropertyDefinition",r=e.Model.CompositeModel[i];if(!r)throw n.createError("Unknown property definition type: "+o);return new r(t)},t}();o.PropertyDefinition=i;var r=function(e){function o(t){return e.call(this,t)||this}return __extends(o,e),o.prototype.getValue=function(e,o){if(this.inCollection())throw n.createError("Cannot call getValue on a PropertyDefinition in a collection.");var i=t.SM.Prop[this.name];return e.getProperty(i,o)},o.prototype.setValue=function(e,o){if(this.inCollection())throw n.createError("Cannot call setValue on a PropertyDefinition in a collection.");var i=t.SM.Prop[this.name];e.setProperty(i,o)},o.prototype.getCollection=function(e,o){if(!this.inCollection())throw n.createError("Can only call getCollection on a PropertyDefinition inside of a collection.");var i=t.SM.Prop[this.name];return e.getProperty(i,o)},o}(i);o.PropertyDefinitionBase=r}(t.CompositeModel||(t.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(t){var o=StoryApp.RethrowLogger,n=function(t){function n(e){return t.call(this,e)||this}return __extends(n,t),n.prototype.getValue=function(t,n){if(this.inCollection())throw o.createError("Cannot call getValue on a PropertyDefinition in a collection.");var i=e.SM.Meaning[this.relationshipType];return t.getRelationshipFrom(i,n)},n.prototype.setValue=function(t,n){if(this.inCollection())throw o.createError("Cannot call setValue on a PropertyDefinition in a collection.");var i=e.SM.Meaning[this.relationshipType];t.setRelationships([n],i)},n.prototype.getCollection=function(t,n){if(!this.inCollection())throw o.createError("Can only call getCollection on a PropertyDefinition inside of a collection.");var i=e.SM.Meaning[this.relationshipType];return new e.SM.ObjectCollectionWritable(t,i)},n}(t.PropertyDefinitionBase);t.ObjectPropertyDefinition=n}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.PropertyDefinitionBase);e.BooleanPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(t){function o(o){var n=this;{if(o){var i=o.contentType;return delete o.contentType,n=t.call(this,o)||this,n.contentType=e.PropertyDefinition.Deserialize(i),n}n=t.call(this)||this}}return __extends(o,t),o}(e.PropertyDefinition);e.CollectionPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=StoryApp.RethrowLogger,o=function(){function o(t,o){if(this._compositeModel=o,this.inheritsFrom=[],t)for(var n in t)if("properties"==n){this.properties=[];for(var i in t.properties){var r=t.properties[i];this.properties.push(e.PropertyDefinition.Deserialize(r))}}else"contentClass"==n?this.contentClass=e.ContentClass[t[n]]:this[n]=t[n]}return o.prototype.getAllProperties=function(){for(var e=[],t=0,o=this.inheritsFrom;t<o.length;t++){var n=o[t],i=this._compositeModel.getCompositeDefinition(n).getAllProperties();for(var r in i)e.addunique(i[r])}for(var a=0,s=this.properties;a<s.length;a++){var l=s[a];e.addunique(l)}return e},o.prototype.getPropertyDefinition=function(e){for(var o=0,n=this.getAllProperties();o<n.length;o++){var i=n[o];if(i.name==e)return i}throw t.createError("Invalid property name.")},o}();e.CompositeDefinition=o}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(t){var o=StoryApp.RethrowLogger,n=function(){function n(e){if(e){this.compositeDefinitions=[],this._compositeDefinitions={};for(var o in e.compositeDefinitions){var n=e.compositeDefinitions[o],i=new t.CompositeDefinition(n,this);this.compositeDefinitions.push(i),this._compositeDefinitions[i.name]=i}this.enumDefinitions=e.enumDefinitions}}return n.prototype.getCompositeDefinition=function(t){var n;if("string"==typeof t)n=t;else{if(!(t instanceof e.SM.ModelObject))throw o.createError("Invalid argument.");n=e.SM.ObjectType[t.objectType]}return this._compositeDefinitions[n]},n}();t.CompositeModel=n}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.ObjectPropertyDefinition);e.CompositePropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){!function(e){e[e.Auto=0]="Auto",e[e.Text=1]="Text",e[e.Image=2]="Image"}(e.ContentClass||(e.ContentClass={}))}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.ObjectPropertyDefinition);e.ContentPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.PropertyDefinitionBase);e.DoublePropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.ObjectPropertyDefinition);e.EmbeddedContentPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.PropertyDefinitionBase);e.EnumPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.ObjectPropertyDefinition);e.ImageContentPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.PropertyDefinitionBase);e.IntegerPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.ObjectPropertyDefinition);e.MediaContentPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.ObjectPropertyDefinition);e.ParagraphPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.ObjectPropertyDefinition);e.StatusUpdateContentPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.PropertyDefinitionBase);e.StringPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.ObjectPropertyDefinition);e.TextGroupPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t}(e.ObjectPropertyDefinition);e.VideoContentPropertyDefinition=t}(e.CompositeModel||(e.CompositeModel={}))}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryEditPageMain;!function(e){var t=StoryApp.RethrowLogger,o=function(){function e(){}return e.prototype.encodeFakeDescriptor=function(e){if(!e)throw t.createError("Argument null or empty: descriptor");return e},e.prototype.isDescriptorFake=function(e){if(!e)throw t.createError("Argument null or empty: descriptor");return!1},e.prototype.createCopyDescriptor=function(e){if(!e)throw t.createError("Argument null or empty: descriptor");return e},e.prototype.isCopyDescriptor=function(e){if(!e)throw t.createError("Argument null or empty: descriptor");return!1},e.prototype.GetOriginalDescriptor=function(e){if(!e)throw t.createError("Argument null or empty: descriptor");return e},e}();e.GenericMediaPlayerDescriptorHandler=o}(StoryEditPageMain||(StoryEditPageMain={}));var StoryEditPageMain;!function(e){var t=StoryApp.RethrowLogger,o=function(){function e(){}return e.generateStoryVideoId=function(e){var t=CommonSettings.EnvironmentName;return"DevFabric"==t||"SingleBox_Cloud"==t||"ScaledPr_Cloud"==t?t="PR":"Weekly"==t&&(t="Int"),StoryPageSettings.StoryId+"-"+e+":"+t},e.generateStoryAudioId=function(t){var o=CommonSettings.EnvironmentName;return"DevFabric"==o||"SingleBox_Cloud"==o||"ScaledPr_Cloud"==o?o="PR":"Weekly"==o&&(o="Int"),StoryPageSettings.StoryId+"-"+t+":"+o+e.c_audioAssetNameSuffix},e.prototype.encodeFakeDescriptor=function(o){if(!o)throw t.createError("Argument null or empty: descriptor");var n=o;return this.isDescriptorFake(o)||(n=o+e.c_fakeSuffix),n},e.prototype.isDescriptorFake=function(o){if(!o)throw t.createError("Argument null or empty: descriptor");return o.lastIndexOf(e.c_fakeSuffix)==o.length-e.c_fakeSuffix.length},e.prototype.createCopyDescriptor=function(o){if(!o)throw t.createError("Argument null or empty: descriptor");var n=o;return this.isCopyDescriptor(o)||(n=e.c_copyPrefix+o),n},e.prototype.isCopyDescriptor=function(o){if(!o)throw t.createError("Argument null or empty: descriptor");return 0==o.indexOf(e.c_copyPrefix)},e.prototype.GetOriginalDescriptor=function(o){if(!o)throw t.createError("Argument null or empty: descriptor");var n=o;return this.isDescriptorFake(o)&&(n=o.substring(0,o.lastIndexOf(e.c_fakeSuffix))),this.isCopyDescriptor(n)&&(n=n.substring(n.indexOf(e.c_copyPrefix)+e.c_copyPrefix.length)),n},e.c_fakeSuffix="*fake*",e.c_copyPrefix="@copy@",e.c_audioAssetNameSuffix="-audio",e}();e.AzureMediaPlayerDescriptorHandler=o}(StoryEditPageMain||(StoryEditPageMain={}));var StoryEditPageMain;!function(e){var t=StoryAppEdit.Model.SM,o=function(){function o(){}return o.createVideoHandler=function(o){return o==t.ContentProvider.Azure||o==t.ContentProvider.OneDrivePro?new e.AzureMediaPlayerDescriptorHandler:new e.GenericMediaPlayerDescriptorHandler},o.createAudioHandler=function(o){return o==t.ContentProvider.Azure||o==t.ContentProvider.OneDrive||o==t.ContentProvider.OneDrivePro?new e.AzureMediaPlayerDescriptorHandler:new e.GenericMediaPlayerDescriptorHandler},o}();e.MediaPlayerDescriptorHandlerFactory=o}(StoryEditPageMain||(StoryEditPageMain={}));var StoryAppEdit;!function(e){!function(e){function t(e,t){for(var o=t.props,n=e.props,i=Object.getPrototypeOf(n),r=0,a=o.length;r<a;++r){var s=o[r],l=s.name,c=s.value,u=c&&"object"==typeof c;(u?c.equals(i[l]):i[l]===c)?delete n[l]:n[l]=u?c.createCopy():c}t.children&&(e.children=t.children.slice())}function o(){return l||(l=a.PageCompartmentManager.getInstance().createAccessor("UndoManager")),l}var n,i=StoryApp.RethrowLogger,r=StoryApp.View.ViewElements,a=StoryApp.Common,s=function(){function e(e,t,o){this.id=e,this.registrations=t,this.component=o}return e.prototype.dispose=function(){this.id&&(delete this.registrations[this.id],this.id=null)},e.prototype.getComponent=function(){return this.component},e}();!function(e){e[e.ViewElements=0]="ViewElements",e[e.Dom=1]="Dom"}(n=e.StateChangePhase||(e.StateChangePhase={}));var l;e.currentUndoManager=o;var c=function(e){function o(){var t=null!==e&&e.apply(this,arguments)||this;return t._undoStack=TDB.watchableTag(596475939,t,[]),t._redoStack=TDB.watchableTag(596475968,t,[]),t.originalPropBags={},t.userActionCount=0,t.runningIgnorableAction=!1,t.descriptions=[],t.initialized=!1,t.undoCallback=TDB.watchableTag(596475969,t,null),t.statefulComponents=[{},{}],t.startingState=null,t.store=null,t.isApplyingUndo=!1,t.logs=[],t}return __extends(o,e),o.prototype.initialize=function(e,t,o,n){var r=this;if(this.initialized)throw i.createError("tried to initialize undo manager twice");this.initialized=!0,this.rootElement=o,this.isEditMode=n,this.registerEventHandler(this),this.onLoggedActionHandler=this.onLoggedAction.bind(this),ActionLogger.RegisterActionCallback(this.onLoggedActionHandler),this.store=e,e.registerUpdateCallback(function(){r.isApplyingUndo||r.clear()}),e.registerBagChangeCallback(this.onBagChanged.bind(this)),this.exceptionHandler=t,t.registerUndoManagerRecentActionsCallback(this.buildRecentActionsLog.bind(this))},o.prototype.registerStatefulComponent=function(e,t,o){void 0===o&&(o=n.ViewElements);var i=this.statefulComponents[o],r=i[t];r&&r.dispose();var a=i[t]=new s(t,i,e);return o===n.ViewElements&&this.newStatefulComponents&&(this.newStatefulComponents[t]=a),a},o.prototype.isUndoAllowed=function(){return StoryPageEditSettings.UndoEnabled&&!StoryApp.View.Common.DialogManager.getCurrentDialog()},o.prototype.endUserAction=function(){var e=this,t=this.undoCallback.getValue();t&&(t(),TDB.applyUpdate(function(){return e.undoCallback.setValue(null)}))},o.prototype.undo=function(){if(!this.isUndoAllowed())return!1;this.endUserAction(),this.saveRedoState();var e=ArrayExtensions.lastOrDefault(this._undoStack.getValue());StoryLog.TraceTag(596475970,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Undo: {0}",[e?e.actionDescription:"no actions to undo"]);var t=this.hasUndo();return this.undoOrRedo(!0),t},o.prototype.redo=function(){if(!this.isUndoAllowed())return!1;var e=ArrayExtensions.lastOrDefault(this._redoStack.getValue());StoryLog.TraceTag(596475971,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Redo: {0}",[e?e.actionDescription:"no actions to redo"]);var t=this.hasRedo();return this.undoOrRedo(!1),t},o.prototype.getLastUndoContext=function(e){var t=ArrayExtensions.lastOrDefault(this._undoStack.getWatchedValue(e));return t?t.userActionContext:null},o.prototype.hasUndo=function(e){return this._undoStack.getWatchedValue(e).length>0||null!=this.undoCallback.getWatchedValue(e)},o.prototype.hasRedo=function(e){return this._redoStack.getWatchedValue(e).length>0},o.prototype.undoOrRedo=function(e,t){var o,i=this;if(TDB.applyUpdate(function(){var t=e?i._undoStack:i._redoStack,n=t.getValue().pop();if(t.notify(),n){o=i.applyUndoObject(n,e);var r=e?i._redoStack:i._undoStack;r.getValue().push(n),r.notify()}}),o&&!t){this.newStatefulComponents={},TDB.applyUpdate(function(){i.setState(o,n.ViewElements)});for(var r=this;!$.isEmptyObject(this.newStatefulComponents);)!function(){var e=r.newStatefulComponents;r.newStatefulComponents={},TDB.applyUpdate(function(){i.setState(o,n.ViewElements,e)})}();this.newStatefulComponents=void 0,this.setState(o,n.Dom)}},o.prototype.clear=function(e,t){var o=this;void 0===e&&(e=!0),void 0===t&&(t=!0),(e&&this._undoStack.getValue().length||t&&this._redoStack.getValue().length)&&TDB.applyUpdate(function(){e&&o._undoStack.setValue([]),t&&o._redoStack.setValue([])})},o.prototype.onBagChanged=function(e,t,o){this.initialized&&!o&&(0!==this.userActionCount||this.runningIgnorableAction||StoryLog.RaiseRecoverableError("Cannot modify a story model property bag outside of a user or ignorable action. Try UndoManager.captureUserAction or StoryAppOM.UndoOM.CaptureUserActionStartAsync for automation. UserActionCallstack: "+this.descriptions),e in this.originalPropBags||(this.originalPropBags[e]=t))},o.prototype.onLoggedAction=function(e,t){if(this.userActionCount){var o=this.logs,n=o.firstOrDefault(function(t){return t.original===e}),i=n?n.copy.action:e.clone();o.push({original:e,copy:{action:i,starting:t}})}},o.prototype.startUserAction=function(e){var t=this;if(this.initialized){if(this.userActionCount||this.runningIgnorableAction)throw i.createError("UndoManager doesn't support nesting startUserAction inside other actions");this.endUserAction(),this.startingState=this.startingState||this.getState(),this.saveRedoState(this.startingState),TDB.applyUpdate(function(){t.clear(!1,!0),t.undoCallback.setValue(e)})}},o.prototype.cancelUserAction=function(){var e=this;this.initialized&&(this.undoCallback.getValue()||StoryLog.TraceTag(596475972,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.warning,"Cannot cancel a user action when no action is in progress"),TDB.applyUpdate(function(){return e.undoCallback.setValue(null)},TDB.Justification.SynchronousBrowserEvent))},o.prototype.getState=function(){for(var e=this.statefulComponents,t=e.length,o=new Array(e.length),n=0;n<t;++n){var i=e[n],r=o[n]={};for(var a in i)r[a]=JSON.stringify(i[a].getComponent().getState())}return o},o.prototype.setState=function(e,t,o){o=o||this.statefulComponents[t];var n=e[t];for(var i in n){var r=o[i];r&&r.getComponent().setState(JSON.parse(n[i]))}},o.prototype.saveRedoState=function(e){var t=ArrayExtensions.lastOrDefault(this._undoStack.getValue());t&&!t.newState&&(t.newState=e||this.getState())},o.prototype.captureUserAction=function(e,t,o){var n=null;if(this.initialized){this.captureUserActionStartAsync(t);try{o?this.store.createPartialChange(e):n=e()}finally{this.captureUserActionEndAsync(n,o)}}else e()},o.prototype.captureUserUpdate=function(e,t,o){var n=this;TDB.applyUpdate(function(){n.captureUserAction(e,t,o)})},o.prototype.captureUserActionStartAsync=function(e){if(this.descriptions.push(e),this.runningIgnorableAction)throw i.createError("UndoManager doesn't support nesting user actions inside ignorable actions. UserActionCallstack: "+this.descriptions);0===this.userActionCount&&(this.startingState=this.startingState||this.getState(),this.saveRedoState(this.startingState)),++this.userActionCount},o.prototype.captureUserActionEndAsync=function(e,t){var o=this;0===--this.userActionCount&&(this.createUndoObject(this.descriptions.join("; "),e),this.descriptions=[],this.startingState=null,platform.setImmediate(function(){return o.saveRedoState()}),t||this.store.partialChangesCompleted())},o.prototype.captureIgnorableUpdate=function(e,t,o){var n,r=this;if(this.initialized){if(this.userActionCount&&!StoryApp.OM.inAutomation||this.runningIgnorableAction){if(t&&this.store.getPropBag(t)&&t in this.originalPropBags&&!this.originalPropBags[t])return void TDB.applyUpdate(e,o);throw i.createError("UndoManager doesn't support nesting ignorable actions inside user actions or other ignorable actions. ModelId: "+t+" UndoActionCallstack: "+this.descriptions)}StoryApp.OM.inAutomation&&(n=this.originalPropBags,this.originalPropBags={});var a=t?this.findPropBag(t):0;isFinite(a)&&(TDB.applyUpdate(function(){for(var t=a<0,o=t?-1:1,n=0;n!==a;n+=o)r.undoOrRedo(t,!0);r.runningIgnorableAction=!0;try{e()}finally{r.runningIgnorableAction=!1}r.mergeCurrentChanges();for(n=0;n!==a;n+=o)r.undoOrRedo(!t,!0);0!==a&&r.store.removeUnrootedPropBags()},o),StoryApp.OM.inAutomation&&(this.originalPropBags=n||{}))}else TDB.applyUpdate(e,o)},o.prototype.findPropBag=function(e){if(this.store.removeUnrootedPropBags(),this.store.getPropBag(e))return 0;var t=ArrayExtensions.indexOfFirst(this._undoStack.getValue().slice().reverse(),function(t){return e in t.originalPropBags});if(-1!==t)return-1-t;var o=ArrayExtensions.indexOfFirst(this._redoStack.getValue().slice().reverse(),function(t){return e in t.newPropBags});return-1!==o?1+o:NaN},o.prototype.mergeCurrentChanges=function(){var e=this,o=this.store;o.removeUnrootedPropBags();var n=Obj.keys(this.originalPropBags).map(function(e){return o.getPropBag(e).createCopy()});if(n.some(function(e){return!e}))throw i.createError("we don't support merging changes that removed bags");var r={},a={};n.forEach(function(t){var o=e.originalPropBags[t.id];if(o){if(o.externalDataId!==t.externalDataId||o.type!==t.type)throw i.createError("we don't support merging changes that change types or external data");var n=!StoryApp.Utilities.sequenceEquals(o.children,t.children);if(n&&o.children.length>0&&(o.children.length!==t.children.length||1!==t.children.length))throw i.createError("unsupported merge of child list");var s=[];for(var l in t.props){var c=o.props[l],u=t.props[l];c===u||c&&"object"==typeof c&&c.equals(u)||s.push({name:l,value:u})}r[t.id]={props:s,children:n?t.children:null}}else a[t.id]=t}),this._undoStack.getValue().concat(this._redoStack.getValue()).forEach(function(e){for(var o in r){var n=r[o],s=e.originalPropBags[o],l=e.newPropBags[o],c=null;if(s&&(t(s,n),l||(c=e.originalPropBags)),l&&(t(l,n),s||(c=e.newPropBags)),n.children&&c)for(var u=n.children.slice(),p=void 0;p=u.shift();){var d=a[p];if(!d)throw i.createError("merging in UndoManager: can't find added bag");c[p]=d.createCopy(),u.push.apply(u,d.children)}}}),this.originalPropBags={}},o.prototype.createUndoObject=function(e,t){var o=this;if(!$.isEmptyObject(this.originalPropBags)){StoryLog.TraceTag(596475973,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"UndoManager capturing user action: {0}",[e]);var n=this.store,i=n.removeUnrootedPropBags(),r={};for(var a in this.originalPropBags)(l=n.getPropBag(a))&&(r[a]=l.createCopy());i.forEach(function(e){e.id in o.originalPropBags||(o.originalPropBags[e.id]=e)});var s={};for(var a in this.originalPropBags){var l=this.originalPropBags[a];l&&(s[a]=l)}this.originalPropBags={};var c={originalPropBags:s,newPropBags:r,actionDescription:e,timestamp:(new Date).getTime(),originalState:this.startingState,newState:null,logs:this.logs.map(function(e){return e.copy}),userActionContext:t};this.logs.length=0,this.clear(!1,!0);var u=this._undoStack.getValue();u.push(c),u.length>StoryPageEditSettings.MaxUndoStackSize&&u.shift(),TDB.applyUpdate(function(){o._undoStack.notify()})}},o.prototype.applyUndoObject=function(e,t){for(var o=e.logs,n=t?ClientAction.UndoState.undo:ClientAction.UndoState.redo,i=0,r=o.length;i<r;++i){var a=o[i],s=a.action;s.resetActionStartTime(),s.setUndoState(n),a.starting?ActionLogger.BeginSyncAction(s):ActionLogger.RecordClientAction(s)}var l=Obj.values(t?e.originalPropBags:e.newPropBags).map(function(e){return e.createCopy()});return this.isApplyingUndo=!0,this.store.updatePropBags(l),this.isApplyingUndo=!1,t?e.originalState:e.newState},o.prototype.isInitialized=function(){return this.initialized},o.prototype.registerEventHandler=function(e){r.DomEventRegister.getInstance().registerEventHandler(e)},o.prototype.unregisterEventHandler=function(e){r.DomEventRegister.getInstance().unregisterEventHandler(e)},o.prototype.handleGlobalKeyEvent=function(e,t){if(t===TDB.ViewElementKeyEventType.KeyDownEvent)if((e.ctrlKey&&!e.altKey||e.metaKey)&&e.keyCode===KeyCodeType.ZKey){var o=this.getFocusedElementNames()||{},n=new ClientAction.UndoActionData(ClientAction.ActionType.Edit_Undo_Keyboard_Undo,"The user triggered the undo keyboard shortcut",o.focusedElement,o.focusedElementParent),i=TDB.FocusableViewElement.getFocusedElement();i instanceof r.TextAreaVE&&i.textAreaValueBinding&&i.textAreaValueBinding.getValue(),ActionLogger.RecordClientAction(n),this.isEditMode&&this.isEditMode.getValue()&&this.undo(),e.stopPropagation(),e.preventDefault()}else if((e.ctrlKey&&!e.altKey||e.metaKey)&&e.keyCode==KeyCodeType.YKey){var o=this.getFocusedElementNames()||{},a=new ClientAction.UndoActionData(ClientAction.ActionType.Edit_Undo_Keyboard_Redo,"The user triggered the redo keyboard shortcut",o.focusedElement,o.focusedElementParent);ActionLogger.RecordClientAction(a),this.isEditMode&&this.isEditMode.getValue()&&this.redo(),e.stopPropagation(),e.preventDefault()}},o.prototype.handleGlobalMouseEvent=function(e,t,o){},o.prototype.touchStart=function(e){return!0},o.prototype.touchMove=function(e){return!0},o.prototype.touchStop=function(e){return!0},o.prototype.getFocusedElementNames=function(){var e=this.rootElement&&TDB.FocusableViewElement.getFocusedElement();return{focusedElement:e&&e.constructor&&e.constructor.name,focusedElementParent:e&&e.parent&&e.parent.constructor&&e.parent.constructor.name}},o.prototype.getLastLoggedActionTypes=function(){for(var e=[],t=ArrayExtensions.lastOrDefault(this._undoStack.getValue()),o=0;o<t.logs.length;o++){var n=t.logs[o].action.getActionType();e.push(n)}return e},o.prototype.getRecentActions=function(e){void 0===e&&(e=!0);var t=[],o=e?this._undoStack.getValue():this._redoStack.getValue();if(o)for(var n=o.length-1;n>=0&&n>o.length-5;n--)t.push(o[n].actionDescription);return JSON.stringify(t)},o.prototype.buildRecentActionsLog=function(){return"UndoStack: "+this.getRecentActions(!0)+", RedoStack: "+this.getRecentActions(!1)},o.prototype.dispose=function(){this.exceptionHandler&&this.exceptionHandler.unregisterUndoManagerRecentActionsCallback(),this.onLoggedActionHandler&&ActionLogger.UnregisterActionCallback(this.onLoggedActionHandler),e.prototype.dispose.call(this)},o}(Disposable);e.UndoManager=c}(e.Model||(e.Model={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function e(e){this.model=e}return e.prototype.getModel=function(){return this.model},e.prototype.getEmail=function(){return this.model.email},e.prototype.getGivenName=function(){return this.getModel().givenName},e.prototype.getDisplayName=function(){return this.getModel().displayName},e.prototype.getClientId=function(){return this.getModel().clientId},e.prototype.getObjectId=function(){return this.getModel().objectId},e}();e.SharingSubjectModel=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getFullName=function(){return this.getModel().displayName||this.getModel().givenName},t.prototype.getInitials=function(){return this.getModel().initials},t.prototype.getThumbnailSmall=function(){},t.prototype.getThumbnail=function(){},t.prototype.getSurname=function(){},t.prototype.getOnlineStatus=function(){return!1},t.prototype.getSgMembershipStatus=function(){return!1},t.prototype.removeSharingSubjectDescription=function(){return ResourceManager.ResolveString(Resources.SharingSelectedPersonDescription,[this.getGivenName()])},t}(e.SharingSubjectModel);e.SecurityGroupModel=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(t){return e.call(this,t)||this}return __extends(t,e),t.prototype.getFullName=function(){var e="";return this.getModel().givenName&&this.getModel().surname?e=ResourceManager.ResolveString(Resources.AuthorEntryName,[this.getModel().givenName,this.getModel().surname]):this.getModel().givenName?e=""+this.getModel().givenName:this.getModel().surname&&(e=""+this.getModel().surname),e},t.prototype.getInitials=function(){var e=this.getModel().initials;return e||(e="",this.getModel().givenName&&this.getModel().givenName.length>0&&(e=""+this.getModel().givenName[0]),this.getModel().surname&&this.getModel().surname.length>0&&(e=""+e+this.getModel().surname[0]),e.toUpperCase())},t.prototype.getThumbnailSmall=function(){return this.getModel().thumbnailUrlSmall},t.prototype.getThumbnail=function(){return this.getModel().thumbnailUrl},t.prototype.getSurname=function(){return this.getModel().surname},t.prototype.getOnlineStatus=function(){return this.getModel().onlineStatus},t.prototype.getSgMembershipStatus=function(){return this.getModel().securityGroupMember},t.prototype.removeSharingSubjectDescription=function(){var e=this.getSurname(),t="";return e&&e.length>0&&(t=" "+e),ResourceManager.ResolveString(Resources.SharingSelectedPersonDescription,[this.getGivenName()+t])},t}(e.SharingSubjectModel);e.StoryUserModel=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function e(){}return e}();e.SharingSubject=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){!function(e){e[e.AddEditors=0]="AddEditors",e[e.AddViewers=1]="AddViewers",e[e.RemoveEditors=2]="RemoveEditors",e[e.RemoveViewers=3]="RemoveViewers",e[e.ConvertToEditors=4]="ConvertToEditors",e[e.ConvertToViewers=5]="ConvertToViewers",e[e.RemoveEditor=6]="RemoveEditor",e[e.RemoveViewer=7]="RemoveViewer"}(e.ChangeAudienceOperationType||(e.ChangeAudienceOperationType={}))}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function e(){}return e}();e.ChangeAudienceRequest=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function e(){}return e}();e.ChangeAudienceResponse=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){!function(e){e[e.Success=0]="Success",e[e.UpdateAudienceFail=1]="UpdateAudienceFail",e[e.StoryUserListRetrieveFail=2]="StoryUserListRetrieveFail",e[e.StoryNotFound=3]="StoryNotFound",e[e.TableLimitExceeded=4]="TableLimitExceeded",e[e.SecurityGroupListRetrieveFail=5]="SecurityGroupListRetrieveFail"}(e.ChangeAudienceResponseStatusCode||(e.ChangeAudienceResponseStatusCode={}))}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(e.SharingSubject);e.SecurityGroup=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function e(){}return e}();e.SearchUsersResponse=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(e.SharingSubject);e.StoryUser=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return __extends(t,e),t}(e.SearchUsersResponse);e.GetGroupMembersResponse=t}(e.AuthorsManager||(e.AuthorsManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(t){!function(t){function o(){return n||(n=StoryApp.Common.PageCompartmentManager.getInstance().createAccessor("ContentSourcesManager")),n}var n,i=StoryApp.RequestManager,r=e.Model.SM,a=StoryApp.Common;t.currentContentSourcesManager=o;var s=function(){function e(t,o){void 0===o&&(o=void 0),this.lookupId=t,this.contentSources=TDB.watchableTag(596475935,e,[]),this.sourcesLoaded=TDB.watchableTag(595908824,e,!1),this.waitingForContentSources=!1,this.onSuccessCallback=o}return e.prototype.ajaxCall=function(){var e=this;$.ajax(a.UrlHelper.getInstance().getContentSourcesUrl(this.lookupId),{type:"GET",contentType:i.JsonContentType,dataType:"json",cache:!1}).then(function(t,o,n){return e.onGetContentSourcesSuccess(t,o,n)},function(t,o,n){return e.onGetContentSourcesError(t,o,n)})},e.prototype.onGetContentSourcesSuccess=function(e,t,o){var n=this;e.ContentSources&&!this.sourcesLoaded.getValue()&&(this.waitingForContentSources=void 0,TDB.applyUpdate(function(){var t=e.ContentSources;StoryPageEditSettings&&StoryPageEditSettings.OnDeviceContentSources&&(t=t.concat(StoryPageEditSettings.OnDeviceContentSources)),n.contentSources.setValue(t),n.sourcesLoaded.setValue(!0)}),this.onSuccessCallback&&this.onSuccessCallback(),this.onSuccessCallback=void 0,StoryPageEditSettings.OneDriveBusinessDelayedTokenRefresh&&this.sendRefreshTokenRequest())},e.prototype.sendRefreshTokenRequest=function(){ArrayExtensions.any(this.getContentSources(),function(e){return"OneDrivePro"===e.providerType&&e.pageType!=PageType.UnavailableForClient})&&$.ajax(a.UrlHelper.getInstance().getTokenRefreshUrl(),{type:"POST"}).then(function(){StoryLog.TraceTag(595919053,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Successfully refreshed tokens")},function(e,t,o){StoryLog.StructuredTraceTag(595919054,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Failed to refresh tokens",{textStatus:t,errorThrown:o})})},e.prototype.onGetContentSourcesError=function(e,t,o){var n=this;if("abort"!==t&&404!==e.status&&this.requestContentSourcesMaxRetrys>0)return StoryLog.StructuredTraceTag(596475936,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Attempt to retrieve content sources failed. Retrying.",{textStatus:t,errorThrown:o,retriesLeft:String(this.requestContentSourcesMaxRetrys)}),this.requestContentSourcesMaxRetrys--,void platform.setTimeout(function(){return n.ajaxCall()},1e3);this.waitingForContentSources=void 0,"abort"===t||e&&0===e.status?StoryLog.StructuredTraceTag(596475937,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.info,"Failed to get content sources from the server because of network connection problems or user aborted.",{ErrorStatus:t,ErrorThrown:o,Status:e?e.status.toString():null}):StoryLog.StructuredTraceTag(596475938,Diag.ULSCat.msoulscat_Story_AddContent,Diag.ULSTraceLevel.warning,"Failed to get content sources from the server.",{textStatus:t,errorThrown:o,Status:e?e.status.toString():null})},e.prototype.getContentSources=function(e){return this.sourcesLoaded.getWatchedValue(e)||this.waitingForContentSources||(this.waitingForContentSources=!0,this.requestContentSourcesMaxRetrys=2,this.ajaxCall()),this.contentSources.getWatchedValue(e)},e.prototype.areContentSourcesLoaded=function(e){return this.sourcesLoaded.getWatchedValue(e)},e.isProviderAvailable=function(e,t,n){var i=o().get(t),a=[];return i&&(a=i.getContentSources(n))&&0!==a.length&&StoryPageEditSettings.OnDeviceContentSources&&(a=a.concat(StoryPageEditSettings.OnDeviceContentSources)),a.some(function(t){return t.providerType===r.ContentProvider[e]})},e.getSearchDescriptor=function(e){if(!e.tabs||0==e.tabs.length)return e.searchDescriptor;var t=e.searchTabIndex,o=e.tabs[t];return o&&o.searchDescriptor?o.searchDescriptor:e.searchDescriptor},e}();t.ContentSourcesManager=s}(t.ContentSourcesManager||(t.ContentSourcesManager={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function t(e,t,o,n){this.pageId=n,this._resubscribeResponse="Resubscribe",this._renewSubscriptionUrl=e,this._editSessionToken=t,this._clientId=o}return t.prototype.getMessage=function(o){var n=this,i=$.Deferred();return $.ajax(o.listenUrl,{name:"StoryNotification",description:"Story notification request",type:"DELETE",dataType:"text",timeout:t.timeout,headers:{Authorization:o.authToken},success:function(t,o,r){n._encounteredError=!1;var a;if(StoryApp.Common.PageCompartmentManager.getInstance().isCompartmentAvailable(n.pageId)){switch(r.status){case 200:var s=r.responseText;if(s==n._resubscribeResponse)a={renewSubscription:!0,notification:null},StoryLog.TraceTag(596132171,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.verbose,"NotificationAPI: Resubscription required (manual).");else{var l=s.indexOf(":"),c=l>-1?[s.substring(0,l),s.substring(l+1)]:[s];if(2==c.length){var u={type:e.NotificationType[c[0]],contents:c[1]};void 0!==u.type?(a={renewSubscription:!1,notification:u},StoryLog.TraceTag(596132172,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.verbose,"NotificationAPI: Message received. Type: "+u.type+" Contents: "+u.contents)):(a=null,StoryLog.TraceTag(596132173,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"NotificationAPI: Message received with unknown type. Type: "+u.type+" Contents: "+u.contents))}else a=null,StoryLog.TraceTag(596132174,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"NotificationAPI: Unknown message received.")}break;case 204:a={renewSubscription:!1,notification:null},StoryLog.TraceTag(596132175,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.verbose,"NotificationAPI: No message received (204).");break;default:a=null,StoryLog.TraceTag(596132176,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"NotificationAPI: Unknown error.")}i.resolve(a)}else StoryLog.StructuredTraceTag(596132170,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Received message from NotificationAPI after page compartment was destroyed",{pageId:n.pageId})},error:function(e,t,o){var r;StoryApp.Common.PageCompartmentManager.getInstance().isCompartmentAvailable(n.pageId)?("timeout"==t?(n._encounteredError=!1,r={renewSubscription:!1,notification:null},StoryLog.TraceTag(596132178,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.verbose,"NotificationAPI: No message received (timeout).")):401==e.status?(r={renewSubscription:!0,notification:null},StoryLog.TraceTag(596132179,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.verbose,"NotificationAPI: Subscription required (401).")):n._encounteredError?(r=null,StoryLog.TraceTag(596132181,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"NotificationAPI: Unknown error: "+o)):(n._encounteredError=!0,r={renewSubscription:!0,notification:null},StoryLog.TraceTag(596132180,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.verbose,"NotificationAPI: Unknown error. Attempting to resubscribe.")),i.resolve(r)):StoryLog.StructuredTraceTag(596132177,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Received error from NotificationAPI after page compartment was destroyed",{pageId:n.pageId})}}),i.promise()},t.prototype.sendMessage=function(o,n,i){var r=e.NotificationType[i]+":"+n;return""==o.sendUrl?$.Deferred().resolve().promise():$.ajax(o.sendUrl,{name:"StorySendNotification",description:"Sending a story notification",type:"POST",timeout:t.timeout,headers:{Authorization:o.sendAuthToken,StoryId:StoryPageSettings.StoryId,EditToken:this._editSessionToken,Sender:this._clientId},data:r,processData:!1})},t.prototype.renewSubscription=function(){var e=this,o=$.Deferred();return $.ajax(this._renewSubscriptionUrl,{name:"StoryRenewSubscription",description:"Story subscription renewal request",type:"POST",dataType:"text",timeout:t.timeout,success:function(t,n,i){if(StoryApp.Common.PageCompartmentManager.getInstance().isCompartmentAvailable(e.pageId)){var r=JSON.parse(t);StoryLog.TraceTag(596132182,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.verbose,"Subscription renewed."),o.resolve(r)}},error:function(t,n,i){StoryApp.Common.PageCompartmentManager.getInstance().isCompartmentAvailable(e.pageId)&&(StoryLog.TraceTag(596132183,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"NotificationAPI: Error occured renewing subscription: "+i),o.resolve(null))}}),o.promise()},t.timeout=CommonSettings.NotificationAPITimeout,t}();e.NotificationAPI=t}(e.NotificationBus||(e.NotificationBus={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){function t(){return o||(o=StoryApp.Common.PageCompartmentManager.getInstance().createAccessor("NotificationManager")),o}var o,n=StoryApp.RethrowLogger;e.currentNotificationManager=t;var i=function(){function t(e,t,o){this._notificationAPI=e,this._subscriptionInfo=t,this._notificationQueues=[],this._started=!1,this._active=!1,this._numConsecutiveTimeouts=0,this._config=o,this._mustRenewSubscription=!0,this.fullyInitialized=!1}return t.Create=function(o,n,i,r){return new t(new e.NotificationAPI(o,n,i,r),{authToken:"",listenUrl:"",sendUrl:"",sendAuthToken:"",newSubscription:!1},{apiScheduler:function(e,t){return platform.setTimeout(function(){return e()},t)},maxAttemptsBeforeSleep:CommonSettings.AzureStorySubscriptionMaxAttemptsBeforeSleep,minMillisecondsBetweenRenewals:CommonSettings.AzureStorySubscriptionRenewalInterval})},t.prototype.startProcessingNotifications=function(){if(this._started)throw n.createError("Already listening.");this._started=!0,this._active=!0,this._config.apiScheduler(this.processNotifications.bind(this),0)},t.prototype.sleeping=function(){if(!this._started)throw n.createError("We have not started processing notifications yet.");return!this._active},t.prototype.gotoSleep=function(){if(!this._started)throw n.createError("We have not started processing notifications yet.");this._active=!1},t.prototype.wakeUp=function(){if(!this._started)throw n.createError("We have not started processing notifications yet.");if(this._active)throw n.createError("We are not asleep.");this._numConsecutiveTimeouts=0,this._active=!0,this._config.apiScheduler(this.processNotifications.bind(this),0)},t.prototype.createListener=function(t){var o=new e.NotificationQueue(t);return this._notificationQueues.push(o),o},t.prototype.removeListener=function(e){var t=e;t&&this._notificationQueues.removefirst(t)&&t.dispose()},t.prototype.informListenersOfLostMessages=function(){for(var e=0;e<this._notificationQueues.length;e++)this._notificationQueues[e].addNotification(null)},t.prototype.updateSubscription=function(e){var t=!!e&&!!e.listenUrl&&!!e.authToken;t&&!e.newSubscription||this.informListenersOfLostMessages(),t&&(this._subscriptionInfo=e,this._mustRenewSubscription=!1,this.fullyInitialized=!0)},t.prototype.processNotifications=function(){var e=this,t=0;if(this._numConsecutiveTimeouts>=this._config.maxAttemptsBeforeSleep&&(this._active=!1),this._active){var o=platform.now();this._mustRenewSubscription?this._notificationAPI.renewSubscription().pipe(function(n){if(e.updateSubscription(n),e._mustRenewSubscription){e._numConsecutiveTimeouts++;var i=platform.now()-o;(t=e._config.minMillisecondsBetweenRenewals-i)<0&&(t=0)}else e._numConsecutiveTimeouts=0;e._config.apiScheduler(e.processNotifications.bind(e),t)}):this._notificationAPI.getMessage(this._subscriptionInfo).then(function(o){if(o)if(o.renewSubscription)e._mustRenewSubscription=!0,e._numConsecutiveTimeouts=0;else if(o.notification){for(var n=0;n<e._notificationQueues.length;n++){var i=e._notificationQueues[n];i.notificationType===o.notification.type&&i.addNotification(o.notification.contents)}e._numConsecutiveTimeouts=0}else e._numConsecutiveTimeouts++;else e._numConsecutiveTimeouts++;e._config.apiScheduler(e.processNotifications.bind(e),t)})}},t.prototype.sendMessage=function(e,t){return this._notificationAPI.sendMessage(this._subscriptionInfo,e,t)},t}();e.NotificationManager=i}(e.NotificationBus||(e.NotificationBus={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function e(e){this.notificationType=e,this._undeliveredNotifications=[],this._listenResult=null}return e.prototype.listen=function(e){var t=this;if(this._listenResult)throw StoryApp.RethrowLogger.createError("Already listening.");var o=$.Deferred();return this._undeliveredNotifications.length>0?o.resolve(this._undeliveredNotifications.shift()):(e&&e.registerOnCancelled(o,function(){t.stopListening()}),this._listenResult=o),o},e.prototype.stopListening=function(){this._listenResult&&(this._listenResult.reject(),this._listenResult=null)},e.prototype.addNotification=function(e){var t=this._listenResult;if(t){if(this._undeliveredNotifications.length>0)throw StoryApp.RethrowLogger.createError("There should be no undelivered notifications if there is already a listener.");this._listenResult=null,t.resolve(e)}else this._undeliveredNotifications.push(e)},e.prototype.dispose=function(){this._undeliveredNotifications.length=0,this.stopListening()},e}();e.NotificationQueue=t}(e.NotificationBus||(e.NotificationBus={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){!function(e){e[e.StoryModel=0]="StoryModel",e[e.SuggestedContent=1]="SuggestedContent",e[e.AuthorList=2]="AuthorList",e[e.AuthorPosition=3]="AuthorPosition",e[e.MediaProcessingProgress=4]="MediaProcessingProgress",e[e.MediaTransferProgress=5]="MediaTransferProgress"}(e.NotificationType||(e.NotificationType={}))}(e.NotificationBus||(e.NotificationBus={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=StoryApp.RethrowLogger,o=function(){function e(e){this._syncImmediately=!1,this._syncManager=e}return e.prototype.waitForNextSync=function(e,t){return this.syncType=e,this._waitForNextSyncTask&&(this._waitForNextSyncTask.reject(),this._waitForNextSyncTask=null),this._syncImmediately?(this._syncImmediately=!1,$.Deferred().resolve()):(this._syncCompletionTask&&(this._syncCompletionTask.resolve({lastSyncRenderTime:this._syncManager.getLastSyncRenderTime(),performanceMetrics:this._syncManager.getPerformanceMetrics()}),this._syncCompletionTask=null),this._waitForNextSyncTask=$.Deferred(),this._waitForNextSyncTask)},e.prototype.isSyncing=function(){return!!this._syncCompletionTask},e.prototype.sync=function(e){if(void 0===e&&(e=!1),this._syncManager.returnPerformanceDetails=e,this._syncCompletionTask)throw t.createError("The sync manager is already syncing.");if(this._syncCompletionTask=$.Deferred(),this._waitForNextSyncTask){var o=this._waitForNextSyncTask;this._waitForNextSyncTask=null,o.resolve()}else this._syncImmediately=!0;return this._syncCompletionTask},e.prototype.dispose=function(){this._waitForNextSyncTask&&this._waitForNextSyncTask.reject(),this._syncCompletionTask&&this._syncCompletionTask.reject()},e.prototype.registerSyncFailureCallback=function(e){var t=this._syncManager.getStoryAPI();t&&t.registerSyncFailureCallback(e)},e}();e.ManualSyncScheduler=o}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function e(e,t,o){this.modelType=e,this.rootId=t,this.serializer=o}return e}();e.ModelSyncConfig=t}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(t){!function(t){var o=e.Server.NotificationBus.NotificationType,n=function(){function e(e,t){this._notificationManager=e,this._notificationListener=this._notificationManager.createListener(o.StoryModel),this._syncThrottle=t,this.createCancellationSource(!1)}return e.Create=function(o,n,i){return new e(o,t.SyncThrottle.Create(n,i))},e.prototype.waitForNextSync=function(e,o){return this.createCancellationSource(!0),e==t.SyncType.PutChanges||e==t.SyncType.Forced?(this._notificationManager.sleeping()&&this._notificationManager.wakeUp(),this.scheduleNextSync()):this.listenForUpdate(o)},e.prototype.scheduleNextSync=function(){return this._syncThrottle.waitForSync(this.createCancellationSource(!1),(new Date).getTime())},e.prototype.listenForUpdate=function(e){var t=this;return this._notificationListener.listen(this.createCancellationSource(!1)).then(function(o){var n=o?parseInt(o):0;return!o||!e||n>e?t.scheduleNextSync():t.listenForUpdate(e)})},e.prototype.createCancellationSource=function(e){return e&&this._cancellationSource.cancel(),this._cancellationSource=new CancellationSource,this._cancellationSource},e.prototype.dispose=function(){this._cancellationSource.cancel()},e}();t.NotificationSyncScheduler=n}(t.Sync||(t.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function t(){}return t.prototype.waitForNextSync=function(t,o){var n=this;this._waitForNextSyncTask&&(this._waitForNextSyncTask.reject(),this._waitForNextSyncTask=null);var i;i=t==e.SyncType.PutChanges||t==e.SyncType.Forced?StoryApp.Utilities.waitForTimer(0):t==e.SyncType.GetExpectedChanges?StoryApp.Utilities.waitForTimer(StoryPageSettings.ActiveSyncInterval):StoryApp.Utilities.waitForTimer(StoryPageSettings.PassiveSyncInterval);var r=this._waitForNextSyncTask=$.Deferred();return i.then(function(){r===n._waitForNextSyncTask&&(n._waitForNextSyncTask=null,r.resolve())}),r},t.prototype.dispose=function(){this._waitForNextSyncTask&&(this._waitForNextSyncTask.reject(),this._waitForNextSyncTask=null)},t}();e.PeriodicSyncScheduler=t}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=StoryApp.Common,o=StoryApp.Server.StoryLeaveManager.StoryLeaveManager,n=function(){function n(e,t,n,i){this._syncFailureCallbacks=[],this._syncUrl=e,this._leaveUrl=t,this._shouldPostAsString=n,this._refreshPage=i,this.storyLeaveManager=new o(this._leaveUrl)}return n.prototype.syncStory=function(e,o,i){var r=this,a=0,s=this._syncUrl,l=function(){var t=JSON.stringify(e);return{name:"StorySync",description:"Story sync request "+(e.changes?"with":"without")+" changes.",type:"POST",data:r._shouldPostAsString?t:n.ConvertRequestToArrayBuffer(t),processData:!1,contentType:"application/octet-stream",dataType:"json",timeout:o}},c=function(e){e?i(e):StoryLog.StructuredTraceTag(595944981,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.warning,"Received falsy sync response",{missingBase:e&&e.missingBase})},u=function(e,o,i){var p=$.proxy(function(){a=0,$.ajax(s,l()).then(c,u)},r);if("timeout"==o)++a<=3?platform.setTimeout(function(){$.ajax(s,l()).then(c,u)},n.EmptyConnectionRetryDelay):(StoryLog.TraceTag(596475917,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"Timed out while trying to sync story, tried "+a+" times"),n.SyncRetryHandler(p),r.notifySyncFailureCallback("Timed out while trying to sync story, tried "+a+" times"));else if("abort"==o)r.notifySyncFailureCallback("Failed to sync due to aborted request");else if(502===e.status||4!==e.readyState)++a<=3?platform.setTimeout(function(){$.ajax(s,l()).then(c,u)},n.EmptyConnectionRetryDelay):(StoryLog.TraceTag(596475918,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"Failed to sync changes due to unresponsive server or other network error. Tried "+a+" times. Status code = "+e.status),n.SyncRetryHandler(p),r.notifySyncFailureCallback("Failed to sync changes due to unresponsive server or other network error. Tried "+a+" times. Status code = "+e.status));else if(404===e.status||401===e.status){y={title:Resources.DeletedDialogTitle,description:Resources.DeletedDialogTitle,allowCancel:!1,messages:[Resources.NativeDeletedDialogBody],buttonsArgs:[{caption:{value:Resources.NativeDeletedDialogButton},isDefault:!0,onAction:function(){window.location.href=t.UrlHelper.getInstance().mySwaysUrl()},id:"idsyncButtonHome"}]};StoryApp.View.Common.DialogManager.createAndShow(y);var d="Failed to sync changes due to a "+e.status+" error";StoryLog.TraceTag(596475919,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,d),r.notifySyncFailureCallback(d)}else{if(StoryLog.TraceTag(596475920,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.info,"Failed to sync changes due to server side exception or other unknown error. Status code = "+e.status),!StoryApp.View.Common.DialogManager.getInstance().isReady())return;var g=Resources.GenericErrorDialogTitle,y={title:g,description:g,messages:[Resources.GenericErrorDialogText],allowCancel:!1,dialogLogMessage:"Refresh Page: Sync failed",dialogType:StoryApp.View.ViewElements.DialogType.Error,buttonsArgs:[{caption:{value:Resources.GenericErrorDialogButtonText},isDefault:!0,dismissOnAction:!1,onAction:function(e,t){r._refreshPage()}}]};StoryApp.View.Common.DialogManager.createAndShow(y),r.notifySyncFailureCallback("Failed to sync changes due to server side exception or other unknown error. Status code = "+e.status)}};$.ajax(s,l()).then(c,u)},n.ConvertRequestToArrayBuffer=function(e){for(var t=unescape(encodeURIComponent(e)),o=new Uint8Array(t.length),n=0;n<t.length;n++)o[n]=t.charCodeAt(n);return o},n.prototype.leaveStory=function(e){this.storyLeaveManager.leaveStory(e)},n.SyncRetryHandler=function(t){new e.SyncRetryDialog(t).show()},n.prototype.registerSyncFailureCallback=function(e){this._syncFailureCallbacks.push(e)},n.prototype.notifySyncFailureCallback=function(e){for(var t=0,o=this._syncFailureCallbacks.length;t<o;++t)this._syncFailureCallbacks[t](e)},n.EmptyConnectionRetryDelay=5e3,n}();e.StoryAPI=n}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(t){!function(t){var o=StoryApp.Model.RM,n=e.Model.SM,i=e.Model.CSM,r=StoryApp.Settings,a=e.Server.Sync.ModelSyncConfig,s=StoryApp.Common,l=StoryApp.View.ViewElements,c=function(){function t(e,t){this.waitingForUpdate=TDB.watchableTag(596475909,this,!1),this.blockingWaitingFlag=TDB.watchableTag(596475910,this,!1),this._blockingAuthoringFlag=!1,this._documentContentIngestionInProgress=!1,this.modelSyncConfigs={},this.modelSyncConfigs[n.StoryModel.ModelType]=new a(n.StoryModel.ModelType,n.StoryModel.RootId,n.StoryModel.PropSerializer),this.modelSyncConfigs[i.ContentStorageModel.ModelType]=new a(i.ContentStorageModel.ModelType,i.ContentStorageModel.RootId,i.ContentStorageModel.PropSerializer),this.modelSyncConfigs[o.RenderModel.ModelType]=new a(o.RenderModel.ModelType,o.RenderModel.RootId,o.RenderModel.PropSerializer),this.rwModelType=n.StoryModel.ModelType,this.syncTimeout=e.syncTimeout,this.clientVersion=StoryPageSettings.ClientVersion,this._ingestionDialogShown=!1,this._syncClientSetup=e,this._textAggregator=t}return t.prototype.canApplyUpdateImmediately=function(){return!$.timers||0==$.timers.length},t.prototype.onChangeTriggeredSync=function(e){platform.setImmediate(e)},t.prototype.getWaitingIndicator=function(){return this.waitingForUpdate.getValue()},t.prototype.getClientInfo=function(){var e=l.ViewModel,t=UX.topBarHeight,o=!1;e?(e.isPreviewMode.getValue()&&(t=0),o=e.isEditMode.getValue()):(o=StoryPageSettings.Mode===StoryViewMode.Edit,StoryPageSettings.EnterAuthoringPlayMode&&(t=0,o=!1));var n,i,r=e?e.viewOptionOverridesWatchable.getValue():new ViewOptionOverrides;if(e)n=e.previewVE.getWidth(),i=e.previewVE.getHeight();else{var a=s.Environment.getInstance().getWindowSize();n=a.w,i=a.h-t}return{clientDevice:CommonSettings.ClientDevice,viewportWidth:n,viewportHeight:i,editMode:o,embedHostMode:StoryPageSettings.EmbedHostMode,accessible:StoryApp.Common.UrlHelper.getInstance().isAccessibilityView(),viewOptionOverrides:r}},t.prototype.setWaitingIndicator=function(e){var t=this,o=this.waitingForUpdate;if(e!==o.getValue()){if(e)this._startActiveSyncTime=platform.now(),platform.setTimeout(function(){t.onWaitTimerFinish()},500),TDB.applyUpdate(function(){o.setValue(e)});else{var n=platform.now()-this._startActiveSyncTime;StoryLog.TraceTag(596475911,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"Time spent syncing story: "+n+" ms"),ActionLogger.EndOperationLogging(),this._waitingOnUpdate?(TDB.applyUpdate(function(){t.waitingForUpdate.setValue(!1),t.blockingWaitingFlag.getValue()&&t.blockingWaitingFlag.setValue(!1)}),this._waitingOnUpdate=!1):this._waitingOnTimer=!0}TDB.applyUpdate(function(){o.setValue(e)})}},t.prototype.onWaitTimerFinish=function(){var e=this;this._waitingOnTimer?(TDB.applyUpdate(function(){e.waitingForUpdate.setValue(!1),e.blockingWaitingFlag.getValue()&&e.blockingWaitingFlag.setValue(!1)}),this._waitingOnTimer=!1):this._waitingOnUpdate=!0},t.prototype.setBlockingWaitingFlag=function(e){var t=this;e!==this.blockingWaitingFlag.getValue()&&(e?StoryLog.TraceTag(596475912,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"Starting syncing with blocking UI flag set"):StoryLog.TraceTag(596475913,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"Finished syncing with blocking UI flag set"),TDB.applyUpdate(function(){t.blockingWaitingFlag.setValue(e)}))},t.prototype.setBlockingAuthoringFlag=function(t){var o=this,n=e.Model.ContentStorageModel.contentRoot.getIngestionResultCode();if(n!==DocumentIngestion.IngestionResultCode.Success&&n!==DocumentIngestion.IngestionResultCode.WaitingForDocument&&!this._ingestionDialogShown)return platform.setImmediate(function(){o._ingestionDialogShown=!0,DocumentIngestion.DocumentIngestionAPI.showDocumentIngestionErrorMessage(n,function(){o._ingestionDialogShown=!1,(new Delete.DeleteServerInterface).obliterateStoryRequest(StoryPageSettings.LookupId,function(e,t,o){return StoryApp.Utilities.assignWindowLocation(s.UrlHelper.getInstance().mySwaysUrl())},function(e,t,o){StoryLog.TraceTag(596475914,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"Failed to delete sway after failed ingestion."),StoryApp.Utilities.assignWindowLocation(s.UrlHelper.getInstance().mySwaysUrl())})})}),void StoryApp.View.Common.BlockingProgressManager.getInstance().hide();if(t!==this._blockingAuthoringFlag){this._blockingAuthoringFlag=t;var r=e.Model.ContentStorageModel.contentRoot.getIngestionFilename();if(this._blockingAuthoringFlag)StoryLog.TraceTag(596475915,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"Starting syncing with blocking authoring UI flag set");else{var a=l.ViewModel;0===n&&r.length>0&&"pdf"===DocumentIngestion.DocumentIngestionAPI.getFileExtension(r)&&DocumentIngestion.DocumentIngestionAPI.showPdfNotification(Resources.DocumentIngestionFromNewPdfUserNotification,l.NotificationBarViewModel.getNotificationBar(a)),StoryLog.TraceTag(596475916,Diag.ULSCat.msoulscat_Story_RequestManager,Diag.ULSTraceLevel.verbose,"Finished syncing with blocking authoring UI flag set")}if(this._blockingAuthoringFlag){var c=ResourceManager.ResolveString(Resources.DocumentIngestionCreateNewBlockingUIMessage,[DocumentIngestion.DocumentIngestionAPI.getCappedFilenameString(r)]);e.Model.ContentStorageModel.contentRoot.getStoryCreationMethod()===i.CreationMethod.StartFromTopic&&(c=ResourceManager.ResolveString(Resources.ColdStartCreateNewBlockingUIMessage,[DocumentIngestion.DocumentIngestionAPI.getCappedFilenameString(r)])),StoryApp.View.Common.BlockingProgressManager.getInstance().show(c,function(){return window.open(StoryApp.Common.UrlHelper.getInstance().mySwaysUrl(),"_self")})}else StoryApp.View.Common.BlockingProgressManager.getInstance().hide()}},t.checkWaitingForUpdateForGroup=function(e){var o=e.getHeading(),i=o?o.getBackground():void 0;return!!(i&&i instanceof n.MediaWithTextComposite&&t.checkWaitingForUpdateContent(i.getMedia()))||t.checkWaitingForUpdate(e.children.getCollection())},t.checkWaitingForUpdate=function(e){for(var o=0;o<e.length;o++){var i=e[o];if(i instanceof n.SpecifiedGroup){if(t.checkWaitingForUpdateForGroup(i))return!0}else if(i instanceof n.Set){if(t.checkWaitingForUpdate(i.content.getCollection()))return!0}else if(i instanceof n.MediaWithTextComposite){if(t.checkWaitingForUpdateContent(i.getMedia()))return!0}else if(i instanceof n.StatusUpdateContent){if(t.checkWaitingForUpdateContent(i))return!0}else if(i instanceof n.EmbeddedContent&&t.checkWaitingForUpdateContent(i))return!0}return!1},t.checkWaitingForUpdateContent=function(t){var o=e.Model.ContentStorageModel.getModelObject(t.id);return!o||o.getContentState()==i.ContentState.PendingProcessing},t.prototype.refreshWaitingIndicator=function(){if(!s.Environment.getInstance().isClientOnline()&&StoryPageSettings.Mode!=StoryViewMode.Edit)return!1;var o=!0,n=!0,i=e.Model.StoryModel.traversalModel.getSpecifiedGrouping();return e.Model.ContentStorageModel.contentRoot.getDocumentIngestionInProcess()||(o=t.checkWaitingForUpdateForGroup(i.getRootGroup()),n=!1,StoryEditPageMain.FREHelper.calloutsBlockedDuringDocIngestion&&(StoryEditPageMain.FREHelper.calloutsBlockedDuringDocIngestion=!1,StoryEditPageMain.FREHelper.activateSwayLoadedTrigger(null))),this.setBlockingAuthoringFlag(n),this.setWaitingIndicator(o),o},t.prototype.refreshRequired=function(e,t){var o=this;if(void 0===t&&(t=!1),this._syncClientSetup.shouldRefreshImmediately())this.refreshPage();else if(StoryApp.View.Common.DialogManager.getInstance().isReady()){e||(e=Resources.RefreshPageNotification);var n={title:t?Resources.LimitExceededErrorDialogTitle:Resources.GenericErrorDialogTitle,description:t?Resources.LimitExceededErrorDialogTitle:Resources.GenericErrorDialogTitle,messages:[e],allowCancel:!1,dialogLogMessage:"Refresh Page: Sync reset required",dialogType:l.DialogType.Error,buttonsArgs:[{caption:{value:Resources.GenericErrorDialogButtonText},isDefault:!0,dismissOnAction:!1,onAction:function(e,t){o.refreshPage()}}]};StoryApp.View.Common.DialogManager.createAndShow(n)}else location.href=StoryApp.Common.UrlHelper.getInstance().errorUrl("ResetRequiredDuringInitialization",window.location.pathname+window.location.search+window.location.hash)},t.prototype.updateWatchableSwitches=function(t){if(t){r.ServiceSwitches||(r.ServiceSwitches=new r.WatchableSwitches);var o=r.ServiceSwitches.authoringDisabled.getValue();if(r.ServiceSwitches.SetupSwitchesFromTransportFormat(t),r.ServiceSwitches.siteDisabled.getValue())this.redirectToSiteDisabled();else{!o&&r.ServiceSwitches.authoringDisabled.getValue()&&AuthoringDisabledDialog.show(Resources.AuthoringDisabledButItsOkayTitle,[Resources.AuthoringDisabledButItsOkayDialogMessage]);var n=e.Model.StoryModel.traversalModel.getSpecifiedGrouping();this.setDocumentContentImportProgressFlag(n.getRootGroup())}}},t.prototype.redirectToSiteDisabled=function(){window.location.href=s.UrlHelper.getInstance().siteDisabledUrl()},t.prototype.redirectToHome=function(){window.location.href=CommonSettings.SiteRootUrl},t.prototype.logRenderTime=function(e){StoryApp.Utilities.weblog("SyncRenderTime","sync update (ms): "+e),ActionLogger.RecordRenderTiming(e)},t.prototype.hasUncommittedStructuralChanges=function(){return!!this._textAggregator&&this._textAggregator.hasUncommittedStructuralChanges()},t.prototype.refreshPage=function(){s.UserStories.getInstance().loadStory(StoryPageSettings.LookupId,!0,!0,!1,!0)},t.prototype.acknowledgeSyncResponse=function(e){return this._syncClientSetup.acknowledgeSyncResponse(e)},t.checkLimit=function(e,t,o,n,i){var r=!1;if((i&LimitMessageType.Error)==LimitMessageType.Error?r=t>o:(i&LimitMessageType.ExactOnLimit)==LimitMessageType.ExactOnLimit?r=t==o:(i&LimitMessageType.Warning)==LimitMessageType.Warning&&(r=t>=Math.floor(o*StoryPageEditSettings.ValidateStoryWarningMessageThreshold)),r){e.length>0&&e.push({text:", "});var a=Resources.LimitsOutOf.replace("{1}",o.toString()).replace("{2}",n).split("{0}");""!=a[0]&&e.push({text:a[0]}),e.push({text:t.toString(),cssClass:(i&LimitMessageType.Error)==LimitMessageType.Error?"NotificationContentLimitsError":null}),""!=a[1]&&e.push({text:a[1]})}},t.displayLimitNotification=function(e){var o=l.NotificationBarViewModel.getNotificationBar(l.ViewModel.getViewElement());if(e){var n=[];t.checkLimit(n,e.storyItemCounts.totalAudioCount,e.storyLimitCounts.totalAudioCount,Resources.LimitsAudios,e.messageType),t.checkLimit(n,e.storyItemCounts.totalItemCount,e.storyLimitCounts.totalItemCount,Resources.LimitsTotalItems,e.messageType),t.checkLimit(n,e.storyItemCounts.totalEmbedCount,e.storyLimitCounts.totalEmbedCount,Resources.LimitsEmbeds,e.messageType),t.checkLimit(n,e.storyItemCounts.totalHeadingCount,e.storyLimitCounts.totalHeadingCount,Resources.LimitsHeadings,e.messageType),t.checkLimit(n,e.storyItemCounts.totalImageCount,e.storyLimitCounts.totalImageCount,Resources.LimitsPictures,e.messageType),t.checkLimit(n,e.storyItemCounts.totalParagraphCount,e.storyLimitCounts.totalParagraphCount,Resources.LimitsParagraphs,e.messageType),t.checkLimit(n,e.storyItemCounts.totalTweetCount,e.storyLimitCounts.totalTweetCount,Resources.LimitsTweets,e.messageType),t.checkLimit(n,e.storyItemCounts.totalVideoCount,e.storyLimitCounts.totalVideoCount,Resources.LimitsVideos,e.messageType),n.length>0&&(n.last().text+=" ",n.push({text:Resources.LimitsInfoNotificationLink,url:"//go.microsoft.com/fwlink/?LinkID=746451"})),(e.messageType&LimitMessageType.Error)==LimitMessageType.Error?(n.unshift({text:Resources.LimitsError}),o.addNotification({messages:n,notificationSource:l.NotificationSource.Limits,notificationType:l.NotificationType.Error,showInConsumptionView:!1},!0,!0)):(e.messageType&LimitMessageType.ExactOnLimit)==LimitMessageType.ExactOnLimit?(n.unshift({text:Resources.LimitsReached}),o.addNotification({messages:n,notificationSource:l.NotificationSource.Limits,notificationType:l.NotificationType.Warning,showInConsumptionView:!1},!0,!0)):(e.messageType&LimitMessageType.Warning)==LimitMessageType.Warning&&(n.unshift({text:Resources.LimitsWarning}),o.addNotification({messages:n,notificationSource:l.NotificationSource.Limits,notificationType:l.NotificationType.Warning,showInConsumptionView:!1},!0,!0))}else o.getNotification()&&o.removeNotifications(l.NotificationSource.Limits)},t.displayPremiumContentRemovedNotification=function(e,t){if(!t){var o=ArrayExtensions.firstOrDefault(e.getNotifications(),function(e){return e.getArgs().notificationSource===l.NotificationSource.PremiumContentRestriction});return o&&(o.isDismissed=!1),void(e.getNotification()&&e.removeNotifications(l.NotificationSource.PremiumContentRestriction))}var n={messages:[{text:Resources.PremiumContentHiddenInOutputNotification}],notificationSource:l.NotificationSource.PremiumContentRestriction,notificationType:l.NotificationType.Warning,showInConsumptionView:!1};e.addNotification(n,!0,!0)},t.prototype.setDocumentContentImportProgressFlag=function(e){var o=t.checkDocumentContentImport(e.children.getCollection());this._documentContentIngestionInProgress&&!o?this._documentContentIngestionInProgress=!1:this._documentContentIngestionInProgress=o},t.checkDocumentContentImport=function(e){for(var o=0;o<e.length;o++){var i=e[o];if(i instanceof n.SpecifiedGroup)return t.checkDocumentContentImport(i.children.getCollection());if(i instanceof n.Set)return t.checkDocumentContentImport(i.content.getCollection());if(i instanceof n.DocumentContent)return!0}return!1},t.countStoryContentCards=function(e){for(var o=0,i=0;i<e.length;i++){var r=e[i];r instanceof n.SpecifiedGroup?o+=t.countStoryContentCards(r.children.getCollection()):r instanceof n.Set?o+=t.countStoryContentCards(r.content.getCollection()):(r instanceof n.TextGroup||r instanceof n.ImageContent||r instanceof n.VideoContent)&&o++}return o},t}();t.SyncClient=c}(t.Sync||(t.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){function t(){return o||(o=StoryApp.Common.PageCompartmentManager.getInstance().createAccessor("ISyncManager")),o}var o,n=StoryApp.RethrowLogger,i=StoryApp.Model.Store,r=StoryApp.Model.WP,a=StoryApp.View.ViewElements;e.currentSyncManager=t;var s=function(t){function o(o,n,i,r){var a=t.call(this)||this;return a.updateNotifier=TDB.notifierTag(596461073,a),a._storyAPI=o,a._syncClient=n,a._clientId=i,a._nextSyncType=e.SyncType.GetPotentialChanges,a._maxAttempts=10,a._waterline=0,a._syncing=!1,a._potentialQueueWork=!1,a._forceSyncThrottler=a.createForceSyncThrottler(),a.args=r,a._syncStatus=e.SyncStatus.InSyncWithService,a._inSyncWithService=$.Deferred().resolve(),StoryApp.View.Common.LayoutElementLogger.createInstance(!0),a}return __extends(o,t),o.prototype.watchForUpdate=function(e){e&&e.watch(this.updateNotifier)},o.prototype.createForceSyncThrottler=function(){var t=this,o=function(){return t._syncClient.setWaitingIndicator(!0),$.Deferred().resolve()},n=function(){ActionLogger.StartOperationLogging(),t._nextSyncType!=e.SyncType.PutChanges&&(t._nextSyncType=e.SyncType.Forced),t.triggerNextSync()};return new StoryApp.Common.EventThrottler(o,n,250)},o.prototype.initialize=function(t){var o=this;{if(!t.resetRequired){var a={};this._stores={},this._clientState=t.newClientState,this._waterline=t.waterline;for(var s=this._syncClient.modelSyncConfigs,l=0;l<t.cellChanges.length;l++){var c=t.cellChanges[l],u=s[c.modelType],p=c.modelType!==this._syncClient.rwModelType,d=new i(u.rootId,r.StoryDiff.Flatten(c.changes,u.serializer),p);if(this._stores[c.cellId]=d,a[c.modelType]=d,!p){if(this._rwCellId)throw n.createError("The client cannot write to more than one cell.");this._rwCellId=c.cellId,this._syncStore=new e.SyncStore(d,this)}}return StoryApp.Common.Environment.getInstance().subscribeToIsClientOnline(null,this,function(e){e&&StoryPageSettings.Mode===StoryViewMode.Edit&&o.forceSync()}),a}var g=t.storyLimitData&&t.storyLimitData.messageType===LimitMessageType.Error;this.requireRefresh(t.errorMessage,g)}},o.prototype.startSyncing=function(e){if(!this._stores)throw n.createError("The initial sync has not yet occured.");if(this._syncScheduler)throw n.createError("StartSyncing already called.");this._potentialQueueWork=this._syncClient.refreshWaitingIndicator(),this._syncScheduler=e,this.triggerNextSync()},o.prototype.stopSyncing=function(){this._syncScheduler&&(this._syncScheduler.dispose(),this._syncScheduler=void 0)},o.prototype.leaveStory=function(e){this._storyAPI.leaveStory(e),this.stopSyncing()},o.prototype.getSyncScheduler=function(){return this._syncScheduler},o.prototype.triggerNextSync=function(){var e=this;this._syncScheduler&&(this._syncing||this._syncScheduler.waitForNextSync(this._nextSyncType,this._waterline).then(function(){e._syncing=!0,e.sync().then(function(){e._syncing=!1,e.triggerNextSync()},function(){e._syncScheduler&&e.requireRefresh(Resources.GenericErrorDialogText)})}))},o.prototype.changeSyncScheduler=function(e){this._syncScheduler&&this._syncScheduler.dispose(),this._syncScheduler=e,this.triggerNextSync()},o.prototype.onPropBagAdd=function(){this._syncClient.setWaitingIndicator(!0),this.setSyncStatus(e.SyncStatus.WaitingToBecomeInSync),ActionLogger.StartOperationLogging(),this._nextSyncType!=e.SyncType.PutChanges&&(this._nextSyncType=e.SyncType.PutChanges,this._syncClient.onChangeTriggeredSync(this.triggerNextSync.bind(this)))},o.prototype.forceSync=function(e){this._forceSyncThrottler.activate(e)},o.prototype.sync=function(){var t=this;if(State.PauseUpdates||!this._syncScheduler)return $.Deferred().reject();var o=this._syncClient.modelSyncConfigs[this._syncClient.rwModelType],n=this._stores[this._rwCellId],i=this._syncStore,a=i.propBagsToSync;this._lastSyncRenderTime=0,this._lastSyncErrorMessage=null,$.isEmptyObject(a)||n.prunePropBagCollection(a);var s=[];for(var l in a)s.push(n.getPropBag(l));a=i.propBagsToSync={};var c=new r.StoryDiff(s,o.serializer);0==c.propBags.length&&(c=void 0);var u=new e.WP.SyncRequest(this._clientState,c,this._syncClient.clientVersion,this._clientId,this._syncClient.getClientInfo(),this.returnPerformanceDetails),p=$.Deferred(),d=this._nextSyncType;return this._potentialQueueWork=this._potentialQueueWork||this._nextSyncType==e.SyncType.PutChanges,this._nextSyncType=e.SyncType.GetPotentialChanges,this._storyAPI.syncStory(u,this._syncClient.syncTimeout,function(e){t._syncClient?t.processSyncResponse(0,d,a,s,e).then(function(e){return t._syncClient?t._syncClient.acknowledgeSyncResponse(e):$.Deferred().resolve()}).then(function(){p.resolve()},function(){StoryLog.StructuredTraceTag(596475908,Diag.ULSCat.msoulscat_Story_Storyline,Diag.ULSTraceLevel.error,"Processing or acknowledging sync response failed.",{}),p.reject()}):p.reject()}),p.promise()},o.prototype.processSyncResponse=function(t,o,n,i,r){var s=this;if(!this._syncClient.canApplyUpdateImmediately()&&t<this._maxAttempts)return StoryApp.Utilities.waitForTimer(100).then(function(){return s.processSyncResponse(t+1,o,n,i,r)});var l=this.getReadWriteCellChanges(r.cellChanges),c=l&&l.clientChangesCommitted,u=!$.isEmptyObject(n),p=l&&l.changes&&l.changes.propBags.length>0,d=r.switches;if(this._syncClient.updateWatchableSwitches(d),r.resetRequired){var g=r.storyLimitData&&r.storyLimitData.messageType===LimitMessageType.Error;return this.requireRefresh(r.errorMessage,g),$.Deferred().resolve(!1)}if(!c&&p&&(u||this._syncClient.hasUncommittedStructuralChanges()))return this.repopulatePreflightQueue(n,i),$.Deferred().resolve(!1);e.SyncClient.displayLimitNotification(r.storyLimitData),e.SyncClient.displayPremiumContentRemovedNotification(a.NotificationBarViewModel.getNotificationBar(a.ViewModel.getViewElement()),r.premiumContentRemoved);var y=r.newClientState,h=r.waterline;void 0!==y&&(this._clientState=y),void 0!==h&&(this._waterline=h),this._performanceMetrics=r.performanceMetrics,this.applyIncomingChanges(r.cellChanges);var f=l?l.propBagsToCommit:void 0;return this.handleMergeConflict(n,f),this.refreshUpdatingWaitingIndicator(o),this.args.syncResponseCallback(),$.isEmptyObject(n)&&this.setSyncStatus(e.SyncStatus.InSyncWithService),$.Deferred().resolve(!0)},o.prototype.getReadWriteCellChanges=function(e){if(!e)return null;for(var t=0;t<e.length;t++){var o=e[t];if(o.cellId===this._rwCellId)return o}return null},o.prototype.requireRefresh=function(e,t){void 0===t&&(t=!1),this.stopSyncing(),this._syncClient.refreshRequired(e,t)},o.prototype.repopulatePreflightQueue=function(e,t){for(var o=0;o<t.length;o++)e[t[o].id]=!0},o.prototype.applyIncomingChanges=function(e){var t=this;if(e&&e.length>0){var o=platform.now();StoryApp.View.Common.LayoutElementLogger.getInstance().start(),TDB.applyUpdate(function(){var o=t._syncStore;o.applyingSyncResult=!0;for(var i=0;i<e.length;i++){var a=e[i],s=a.cellId,l=t._stores[s],c=t._syncClient.modelSyncConfigs[a.modelType];if(a.changes){if(a.clientChangesCommitted)throw n.createError("If our changes were committed, there should not be additional changes coming from the server.");l.updatePropBags(r.StoryDiff.Flatten(a.changes,c.serializer),!0)}}o.applyingSyncResult=!1,t.updateNotifier.notify()},TDB.Justification.SynchronousBrowserEvent),StoryApp.View.Common.IframeLoadingManager.getInstance().notifyLayoutDone(),this._lastSyncRenderTime=platform.now()-o,this._syncClient.logRenderTime(this._lastSyncRenderTime)}else this.args.emptySyncResponseCallback()},o.prototype.refreshUpdatingWaitingIndicator=function(t){if(this._nextSyncType!=e.SyncType.PutChanges&&this._nextSyncType!=e.SyncType.Forced){if(this._syncClient.setBlockingWaitingFlag(!1),t==e.SyncType.PutChanges||this._potentialQueueWork)return this._potentialQueueWork=this._syncClient.refreshWaitingIndicator(),void(this._potentialQueueWork?this._nextSyncType=e.SyncType.GetExpectedChanges:this._nextSyncType=e.SyncType.GetPotentialChanges);this._syncClient.setWaitingIndicator(!1)}},o.prototype.handleMergeConflict=function(t,o){if(void 0!==o&&o.length>0){for(var n=0;n<o.length;n++)t[o[n]]=!0;this._nextSyncType=e.SyncType.PutChanges}},o.prototype.setSyncStatus=function(t){this._syncStatus!==t&&(t===e.SyncStatus.WaitingToBecomeInSync?this._inSyncWithService=$.Deferred():t===e.SyncStatus.InSyncWithService&&this._inSyncWithService.resolve(),this._syncStatus=t)},o.prototype.getLastSyncRenderTime=function(){return this._lastSyncRenderTime},o.prototype.getLastSyncErrorMessage=function(){return this._lastSyncErrorMessage},o.prototype.currentlySyncing=function(){return this._syncing},o.prototype.getClientId=function(){return this._clientId},o.prototype.getPerformanceMetrics=function(){return this._performanceMetrics},o.prototype.waitUntilInSyncAsync=function(){return this._inSyncWithService.promise()},o.prototype.getStoryAPI=function(){return this._storyAPI},o.prototype.dispose=function(){this._syncClient.getWaitingIndicator()&&this._syncClient.setWaitingIndicator(!1),this._syncClient=void 0,t.prototype.dispose.call(this)},o}(Disposable);e.SyncManager=s}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=StoryApp.View.ViewElements,o=function(){function e(e){this._syncFunction=e}return e.prototype.initDialog=function(){var e={title:Resources.SyncErrorDialogTitle,description:Resources.SyncErrorDialogTitle,messages:[Resources.SyncErrorDialogText],width:400,noFocus:!1,dialogLogMessage:"Sync Error",dialogType:t.DialogType.Error,allowCancel:!1,buttonsArgs:[{caption:{value:Resources.SyncErrorDialogButton},onAction:this._syncFunction,isDefault:!1,dismissOnAction:!0}]};this._dlg=StoryApp.View.Common.DialogManager.createAndShow(e)},e.prototype.show=function(){this.initDialog()},e}();e.SyncRetryDialog=o}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){!function(e){e[e.InSyncWithService=0]="InSyncWithService",e[e.WaitingToBecomeInSync=1]="WaitingToBecomeInSync"}(e.SyncStatus||(e.SyncStatus={}))}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function e(e,t){this.propBagsToSync={},this.applyingSyncResult=!1,this.syncManager=t,this.store=e,e.registerBagChangeCallback(this.onBagChange.bind(this)),e.registerUpdateCallback(this.onUpdate.bind(this)),e.registerPartialChangesCompletedCallback(this.onPartialChangesCompleted.bind(this))}return e.prototype.onUpdate=function(e){if(!this.applyingSyncResult){for(var t=0,o=e.length;t<o;++t)this.propBagsToSync[e[t].id]=!0;this.syncManager&&this.syncManager.onPropBagAdd()}},e.prototype.onBagChange=function(e,t,o,n){this.applyingSyncResult||(this.propBagsToSync[e]=!0,this.syncManager&&!n&&this.syncManager.onPropBagAdd())},e.prototype.onPartialChangesCompleted=function(){this.syncManager&&!$.isEmptyObject(this.propBagsToSync)&&this.syncManager.onPropBagAdd()},e}();e.SyncStore=t}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){var t=function(){function e(e,t,o){this._targetMaxSyncsInWindow=t,this._windowDuration=e,this._waitForSync=o,this._previousRequestToSyncTimes=[],this._targetAverageTimeBetweenSyncs=this._windowDuration/this._targetMaxSyncsInWindow}return e.Create=function(t,o){return new e(t||1e4,o||3,function(e,t){return StoryApp.Utilities.waitForTimer(t,e)})},e.prototype.waitForSync=function(e,t){var o=this;if(this._previousRequestToSyncTimes=this._previousRequestToSyncTimes.filter(function(e){return e>t-o._windowDuration}),this._previousRequestToSyncTimes.push(t),this._previousRequestToSyncTimes.length>this._targetMaxSyncsInWindow){var n=Math.min(this.getTimeUntilHealthySyncRate(),this._targetAverageTimeBetweenSyncs);return this._waitForSync(e,n)}return $.Deferred().resolve()},e.prototype.getTimeUntilHealthySyncRate=function(){var e=this._previousRequestToSyncTimes.length,t=this._previousRequestToSyncTimes[e-(this._targetMaxSyncsInWindow+1)],o=this._previousRequestToSyncTimes[e-1],n=t+this._windowDuration;return Math.max(n-o,0)},e}();e.SyncThrottle=t}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){!function(e){e[e.GetPotentialChanges=0]="GetPotentialChanges",e[e.GetExpectedChanges=1]="GetExpectedChanges",e[e.Forced=2]="Forced",e[e.PutChanges=3]="PutChanges"}(e.SyncType||(e.SyncType={}))}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryAppEdit;!function(e){!function(e){!function(e){!function(e){var t=function(){function e(e,t,o,n,i,r){this.clientState=e,this.changes=t,this.currentClientVersion=o,this.clientId=n,this.renderingClientInfo=i,this.returnPerformanceDetails=r}return e}();e.SyncRequest=t}(e.WP||(e.WP={}))}(e.Sync||(e.Sync={}))}(e.Server||(e.Server={}))}(StoryAppEdit||(StoryAppEdit={}));var StoryEditPageMain;StoryEditPageMain||(StoryEditPageMain={}),StoryLog.BufferedTraceTag(596444751,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize");var StoryEditPageMain;!function(e){function t(e,t,o,n){StoryLog.BufferedTraceTag(596444752,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::setupSyncManager",{pageId:e});var i=y.UrlHelper.getInstance().syncUrl(StoryPageSettings.LookupId),r=y.UrlHelper.getInstance().leaveUrl(StoryPageSettings.LookupId,t),a=new I(i,r,n.getShouldPostAsString(),n.refreshPage.bind(n)),s=new M(a,o,t,n);return T.currentSyncManager().set(e,s),StoryLog.BufferedTraceTag(596444753,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::setupSyncManager end",{pageId:e}),s}function o(e,t,o,n,i,r,a,s,l,c,u,p,d,g){void 0===d&&(d=!0),StoryLog.BufferedTraceTag(596444754,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::setupEditingModel",{pageId:e});var h={fullScreenManager:void 0},C=l.initialize(o.initialSyncResponse);StoryAppEdit.Model.currentUndoManager().set(e,new StoryAppEdit.Model.UndoManager),StoryPerformance.PerformanceManager.getInstance().measurePerformance("populateModels",function(){StoryApp.Model.RenderModel=TDB.watchableTag(596475974,null,new f.RenderModel(C[f.RenderModel.ModelType]).renderModelRoot),StoryAppEdit.Model.StoryModel=new S.StoryModel(C[S.StoryModel.ModelType]),StoryAppEdit.Model.ContentStorageModel=new m.ContentStorageModel(C[m.ContentStorageModel.ModelType]),StoryAppEdit.Model.IsPremiumSway=o.isPremiumSway,g&&g(StoryApp.Model.RenderModel.getValue().renderModel,StoryAppEdit.Model.StoryModel,StoryAppEdit.Model.ContentStorageModel)});var P=y.UrlHelper.getInstance().renewSubscriptionUrl(StoryPageSettings.LookupId,o.clientId,o.editSessionToken),I=v.Create(P,o.editSessionToken,o.clientId,e);b.currentNotificationManager().set(e,I),d&&I.startProcessingNotifications();var M=T.NotificationSyncScheduler.Create(I,StoryPageEditSettings.SyncThrottleWindowMs,StoryPageEditSettings.SyncThrottleMaximumInWindow);t.setupEditorManager(o,e);var A={createView:function(o){t.createControllers(e),t.createView(o,n,s,l,c,p);var a=StoryPageSettings.EnterAuthoringPlayMode?StoryViewMode.Preview:StoryPageSettings.Mode;return t.setupView(a,i,r,TDB.watchableTag(596475975,null,!1)),h.fullScreenManager=w.ViewModel.fullScreenManager,w.ViewModel.getViewElement()},parentElement:$(StoryApp.Utilities.eventWrapperSelector)[0],scenario:w.PageRootScenario[w.PageRootScenario.OpenStory_Edit],creationPolicy:u,pageId:e},_=StoryApp.View.Common.LayoutElementLogger.getInstance();return _&&_.start(),w.PageRootVE.createAndAttach(A),t.setInitDomFocus(),t.initializeUndo(C,a,e),d&&l.startSyncing(M),StoryLog.BufferedTraceTag(596444755,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::setupEditingModel end",{pageId:e}),h}function n(t,o,n){var i=StoryApp.Utilities.defaultEventThrottleDelay,r=!1,a=y.Environment.getInstance().getWindowSize(),s=a.w,l=a.h;StoryApp.Utilities.throttledEvent(e,StoryApp.Utilities.onResize,i,function(){var e=y.Environment.getInstance().getWindowSizeFromDOM(),o=e.w,i=e.h;return Math.abs(o-s)+Math.abs(i-l)<=1?$.Deferred().reject():!StoryApp.Utilities.ios||+(s>l)^+(o>i)||void 0===window.amp?(s=o,l=i,StoryApp.View.ViewElements.ViewModel.getVideoPlayerManager().whenNoVideosPlaying().then(function(){t.fullScreenManager.isExternalFullScreen()&&(r=!0),n.waitingForUpdate.getValue()||r||TDB.applyUpdate(function(){n.waitingForUpdate.setValue(!0)})})):$.Deferred().reject()},function(){StoryAppEdit.Model.ContentStorageModel.contentRoot.getDocumentIngestionInProcess()&&(r=!1),r?(t.fullScreenManager.isExternalFullScreen()||(r=!1),TDB.applyUpdate(function(){n.waitingForUpdate.setValue(!1)})):o.forceSync()}),_=function(){return o.leaveStory(!1)},StoryApp.Utilities.addUnloadEventListener(_,!0)}function i(i,a,s,l,c,u,p,d,g,f,S){if(StoryLog.BufferedTraceTag(596444756,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded",{pageId:i}),s.performanceMetrics&&(PerformanceMetrics?PerformanceMetrics=PerformanceMetrics.concat(s.performanceMetrics):PerformanceMetrics=s.performanceMetrics),StoryLog.BufferedTraceTag(596444757,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded past performanceMetrics",{pageId:i}),!s.joined)return StoryLog.BufferedTraceTag(596444758,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded !joined to redirect",{pageId:i}),void 0!=s.joinResult?window.location.href=y.UrlHelper.getInstance().storyJoinResultUrl(StoryPageSettings.LookupId,s.joinResult):window.location.href=y.UrlHelper.getInstance().readOnlyUrl(StoryPageSettings.LookupId),!1;if(!y.PageCompartmentManager.getInstance().isCompartmentAvailable(i))return StoryLog.BufferedTraceTag(596444759,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded compartment not available",{pageId:i}),!1;var m=t(i,s.clientId,l,a),v=o(i,a,s,c,l.waitingForUpdate,l.blockingWaitingFlag,u,g,m,f,new A.Common.CreationPolicy,S);if(StoryLog.BufferedTraceTag(596444760,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded setupPageHooks",{pageId:i}),n(v,m,l),StoryLog.BufferedTraceTag(596444761,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded setupPageHooks end",{pageId:i}),StoryPageEditSettings.RestoredSnapshotDate){StoryLog.BufferedTraceTag(596444762,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded setupPageHooks RestoredSnapshotDate",{pageId:i});var C=StoryApp.Utilities.adjustDateToUserTime(StoryPageEditSettings.RestoredSnapshotDate.toString()),P=ResourceManager.ResolveString(Resources.SnapshotRestoredNotification,[C]);StoryApp.View.ViewElements.NotificationBarViewModel.getNotificationBar(StoryApp.View.ViewElements.ViewModel.getViewElement()).addNotification({messages:[{text:P}],notificationSource:StoryApp.View.ViewElements.NotificationSource.InitializeSnapshot,notificationType:StoryApp.View.ViewElements.NotificationType.Info}),StoryLog.BufferedTraceTag(596444763,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded setupPageHooks RestoredSnapshotDate end",{pageId:i})}if(StoryLog.BufferedTraceTag(596444764,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded setupPageHooks clearing barrier",{pageId:i}),StoryPageMain.recordTimeForLoadingScreenToHide(!0),StoryPageMain.clearBarrier(),a.setupUponStoryLoad(),p.setCondition(d),StoryLog.BufferedTraceTag(596444765,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded setupPageHooks createOMCondition end",{pageId:i}),StoryApp.Utilities.query.has(StoryApp.Common.UrlHelper.URLParamRetry))try{window.history.replaceState(null,"",window.location.pathname+StoryApp.Utilities.query.erase(StoryApp.Common.UrlHelper.URLParamRetry))}catch(e){StoryLog.StructuredTraceTag(596475977,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Failed to remove retry parameter from URL.",{message:e.message},e.stack)}return r()===h.FirstRunType.FRENonEmpty&&StoryLog.TraceTag(596475978,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"FRENonEmpty not enabled, using FirstRunType.Default"),h.getFirstRunManager().updateFirstRunType(h.FirstRunType.Default),e.FREHelper.activateSwayLoadedTrigger(s.clientId),StoryPageSettings.EnterAuthoringPlayMode&&StoryApp.Utilities.checkDebugState(StoryApp.Utilities.DebugState.None)&&w.NavigationHelper.hasContentOverflow()&&h.StoryFirstRunHelper.triggerPlayEntered(),StoryLog.BufferedTraceTag(596444766,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinSucceeded end",{pageId:i}),!0}function r(){var e=[m.CreationMethod.StartFromTopic,m.CreationMethod.DocIngestionOneNote,m.CreationMethod.DocIngestionPdf,m.CreationMethod.DocIngestionPowerPoint,m.CreationMethod.DocIngestionWord,m.CreationMethod.Duplication,m.CreationMethod.Facebook,m.CreationMethod.TemplateDuplication,m.CreationMethod.Uploaded,m.CreationMethod.WinPhoto,m.CreationMethod.CreatedUsingApi,m.CreationMethod.CreateNewWithGhostedContent,m.CreationMethod.DuplicateStoryForFeedback,m.CreationMethod.ExampleSway,m.CreationMethod.DocsDotCom,m.CreationMethod.NearPod,m.CreationMethod.DocsDotComApiCopySway,m.CreationMethod.ApiCopySway,m.CreationMethod.PublishWordOnline,m.CreationMethod.PublishWordClient,m.CreationMethod.OfficeDotComWord,m.CreationMethod.OfficeDotComPowerPoint,m.CreationMethod.OfficeDotComPdf],t=StoryAppEdit.Model.ContentStorageModel.contentRoot.getStoryCreationMethod();return t===m.CreationMethod.CreateNew||t===m.CreationMethod.Unknown||t===m.CreationMethod.UnknownValue?h.FirstRunType.Default:-1!=e.indexOf(t)?h.FirstRunType.FRENonEmpty:(TDB.raiseRecoverableError("Unspecified creation method: "+t,TDB.LogLevel.error),h.FirstRunType.Default)}function a(e,t,o){function n(e,t,o){if(t>0&&$("#"+e).length>0){platform.setTimeout(function(){n(e,t-100,o)},100)}else o()}StoryLog.BufferedTraceTag(596444767,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinFailed"),StoryApp.Utilities.weblog(StoryPageMain.RenderModelManager.FirstModelWeblogTag,"The /join failed.");var i={status:e.status,textStatus:t,errorThrown:o,href:window.location.href};StoryLog.StructuredTraceTag(596475979,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.warning,"Error attempting to call JoinStory.",i),n("RenewTokenIFrame",401==e.status||403==e.status?CommonSettings.RenewTokenTimeout:0,function(){StoryApp.Utilities.tryRefreshOnce("ModelLoadFailed_Author_"+e.status)}),StoryLog.BufferedTraceTag(596444768,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::onJoinFailedEnd")}function s(e,t,o,n,r,s){StoryLog.BufferedTraceTag(596444769,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::initializeEditPage",{pageId:e});var l=StoryPageMain.createSharingManager(),c=["join","getContentSources"],u=new ConditionalExecute(function(){return StoryApp.Common.MessageBus.getInstance().fireMessage(StoryApp.Common.MessageType.StoryEditPageReady)},c),p=new C.ContentSourcesManager(StoryPageSettings.LookupId,function(){y.PageCompartmentManager.getInstance().isCompartmentAvailable(e)&&u.setCondition(c[1])});C.currentContentSourcesManager().set(e,p),p.getContentSources(),StoryApp.Server.Styles.currentStyleGalleryManager().set(e,new StoryApp.Server.Styles.StyleGalleryManager(e)),StoryApp.Server.Styles.currentStylePreviewManager().set(e,new StoryApp.Server.Styles.StylePreviewManager(e));var d=t.createTextAggregator(),g=new P(t,d),h=y.SinglePageAppHelper.buildJoinStoryRequest(StoryPageSettings.ClientVersion,function(){return g.getClientInfo()}),f=new DeferredTask,S="";if(r){var m=i(e,t,r,g,d,o,u,c[0],n,l,s);f.resolve(m)}else{var v=$.Deferred();t.createFirstModelJoiner().join(StoryPageSettings.LookupId,h,v),v.done(function(r){StoryApp.Utilities.weblog(StoryPageMain.RenderModelManager.FirstModelWeblogTag,"The /join request finished successfully."),platform.setImmediate(function(){var a=i(e,t,r,g,d,o,u,c[0],n,l,s);S="viewStory",f.resolve(a)})}).fail(a,function(){return f.resolve(!1)})}return t.initializeAgaveEditMode(e),f.then(function(e){var t=StoryPerformance.PerformanceManager.getInstance();if(e&&t.isPerformanceSupported()){var o=t.buildTTFVPerformanceReport("editStory",S);t.clearAll(),StoryLog.StructuredTraceTag(19248130,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"Create and Join performance report",o),StoryApp.Utilities.weblog("performance",JSON.stringify(o))}}),StoryLog.BufferedTraceTag(596444770,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::initializeEditPage end",{pageId:e}),f}function l(t,o,n,i){if(n&&(StoryPageEditSettings=n.StoryPageEditSettings),!StoryPageEditSettings)return StoryPageMain.useStoryPage(!0),StoryPageMain.initialize(t,o,n,i);y.NavigationContext.CurrentType=y.NavigationContextType.Story,y.NavigationContext.IsConsumption=!1,y.NavigationContext.IsAuthoringPlay=StoryPageSettings.EnterAuthoringPlayMode;var r=y.PageCompartmentManager.getInstance().createNewPageCompartment();StoryLog.BufferedTraceTag(596444771,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::initializeImpl",{pageId:r});var a=n?n.StoryJoinResponse:void 0,l=new DeferredTask,u=e.createSetupHelpers();return u.setupForInitialize(t).then(function(e){StoryPageMain.commonInitializePrePageAttach(r),s(r,u,t,o,a,i).then(function(e){StoryLog.BufferedTraceTag(596444800,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::initializeImpl - initialized Edit Page",{pageId:r}),e&&StoryPageMain.commonInitializePostPageAttach(r),l.resolve({CommonSettings:CommonSettings,StoryPageSettings:StoryPageSettings,StoryPageEditSettings:StoryPageEditSettings})})}),c(r),StoryLog.BufferedTraceTag(596444801,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::initializeImpl end",{pageId:r}),l}function c(e){O=function(){return u(e)}}function u(t){if(StoryLog.BufferedTraceTag(596444802,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::destroyImpl",{pageId:t}),!CommonSettings.AuthoringFromLandingPageContextEnabled||y.NavigationContext.CurrentType!==y.NavigationContextType.Story)return Task.fromResult(!0);var o=new DeferredTask,n=new DeferredTask;if(StoryPageMain.commonDestroyStart(t),D===t)throw StoryApp.RethrowLogger.createError("Construction and destruction of pages must be synchronized");return D=t,p(t,o),platform.setImmediate(function(){StoryLog.BufferedTraceTag(596444803,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::destroyImpl - start destroying",{pageId:t}),y.NavigationContext.CurrentType=y.NavigationContextType.None,h.deleteCalloutManager(),h.FirstRunTriggers.digitalPrintPlayCalloutDismissed=!1,h.FirstRunTriggers.digitalPrintShareCalloutDismissed=!1,CommonSettings.IsPublish=!1,StoryApp.View.Common.IframeLoadingManager.releaseInstance(),StoryApp.Common.Environment.clearInstance(),e.createSetupHelpers().stopRefreshingEditors(t),StoryApp.Utilities.resetResizeCallbacks();var o=T.currentSyncManager().get(t);null!=o?o.waitUntilInSyncAsync().then(function(){StoryLog.BufferedTraceTag(596444804,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::destroyImpl - waited until in Sync",{pageId:t}),o.stopSyncing(),b.currentNotificationManager().get(t).gotoSleep(),n.resolve(!0),o.leaveStory(!0)}):n.resolve(!0)}),n.then(function(){StoryLog.BufferedTraceTag(596444805,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::destroyImpl - in Sync",{pageId:t}),StoryLog.resetForStoryPage(),_&&(StoryApp.Utilities.removeUnloadEventListener(_),_=void 0),platform.setImmediate(function(){StoryPageMain.commonDestroyEnd(t),StoryApp.Common.MessageBus.getInstance().fireMessage(StoryApp.Common.MessageType.StoryEditPageDispose),o.resolve(!0)})}),StoryLog.BufferedTraceTag(596444806,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::destroyImpl end",{pageId:t}),o}function p(t,o){w.DomEventRegister.isInitialized()&&w.DomEventRegister.getInstance().unregisterAllHandlers();var n=w.ViewModel?w.ViewModel.getViewElement().findFirstNode():void 0;n&&(n.style.display="none"),o.then(function(){StoryLog.BufferedTraceTag(596444111,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::destroyPageViewElements - cleanAfter was resolved",{pageId:t}),TDB.ViewElementUpdater.clean(),y.PageCompartmentManager.getInstance().removePageCompartment(t),StoryApp.View.ViewElements.ViewModel=null,StoryAppEdit.Model.StoryModel=null,StoryAppEdit.Model.ContentStorageModel=null,StoryApp.Model.RenderModel=null,e.createSetupHelpers().deleteView()})}function d(e){StoryPageMain.canOverrideViewOptions()&&(w.ViewModel.getViewElement().previewVE.setRestoreState(),StoryAppEdit.Server.Sync.currentSyncManager().get(e).forceSync())}function g(e){void 0===e&&(e=!1),StoryLog.BufferedTraceTag(596444807,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::useStoryEditPage"),(e||StoryPageEditSettings)&&(StoryPageMain.initialize=l,StoryPageMain.destroy=function(){return O()},StoryPageMain.overrideViewOptions=d),StoryLog.BufferedTraceTag(596444808,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize::useStoryEditPage end")}var y=StoryApp.Common,h=StoryApp.View.Common.FRE,f=StoryApp.Model.RM,S=StoryAppEdit.Model.SM,m=StoryAppEdit.Model.CSM,v=StoryAppEdit.Server.NotificationBus.NotificationManager,C=StoryAppEdit.Server.ContentSourcesManager,P=StoryAppEdit.Server.Sync.SyncClient,I=StoryAppEdit.Server.Sync.StoryAPI,T=StoryAppEdit.Server.Sync,M=StoryAppEdit.Server.Sync.SyncManager,b=StoryAppEdit.Server.NotificationBus,A=StoryApp.View,w=A.ViewElements;e.setupEditingModel=o;var _,O=function(){return Task.fromResult(!0)},D=-1;e.useStoryEditPage=g,StoryPageMain.useStoryEditPage=g,g()}(StoryEditPageMain||(StoryEditPageMain={})),StoryLog.BufferedTraceTag(596444809,Diag.ULSCat.msoulscat_Story_Site,Diag.ULSTraceLevel.info,"StoryPageEdit::Initialize end");var StoryEditPageMain;!function(e){var t=StoryApp.Server.Styles,o=StoryAppEdit.Model.SM,n=function(){function e(){}return e.getSelectedWorld=function(e){return(StoryAppEdit.Model&&StoryAppEdit.Model.StoryModel).traversalModel.getWorldId(e)},e.getSelectedStyle=function(e){return(StoryAppEdit.Model&&StoryAppEdit.Model.StoryModel).traversalModel.getStyleId(e)},e.getFontSetOptions=function(o){var n=e.getSelectedStyle(o),i=StoryAppEdit.Model.StoryModel.traversalModel.getCulture(o),r=e.getSelectedFontSet(o);return t.getFontSetOptions(n,i,r,o)},e.getSelectedStyleOption=function(o){var n=new t.StyleOption(e.getSelectedStyle(o));return n.setFontSetId(e.getSelectedFontSet(o)),n.setBackgroundSetId(e.getSelectedBackgroundSet(o)),n.setAnimationLevel(e.getSelectedAnimationAmount(o).toString()),n.setColorPalette(e.getSelectedColorPalette(o)),n.setColorOptionId(e.getSelectedColorOption(o)),n.setSeedColorOverrides(e.getSelectedSeedColorOverrides(o)),n},e.getSelectedBackgroundSet=function(t){var o=e.getStyleOverrides();return o?o.getBackgroundSetId(t):null},e.getSelectedColorOption=function(e){return(StoryAppEdit.Model&&StoryAppEdit.Model.StoryModel).traversalModel.getColorOptionId(e)},e.getSelectedSeedColorOverrides=function(t){var o=e.getStyleOverrides();if(o){for(var n={},i=o.getSeedColorOverrides(t).getColors(t).getCollection(),r=0;r<i.length;++r)n[i[r].getId(t)]=i[r].getValue(t);return n}return null},e.getSelectedColorPalette=function(e){for(var t={},o=(StoryAppEdit.Model&&StoryAppEdit.Model.StoryModel).traversalModel.getColorPalette(e).getCollection(),n=0;n<o.length;++n)t[o[n].getId(e)]=o[n].getValue(e);return t},e.getSelectedFontSet=function(t){var o=e.getStyleOverrides();return o?o.getFontSetId(t):null},e.getSelectedAnimationAmount=function(t){var n=e.getStyleOverrides();return n?n.getAnimationAmount(t):o.AnimationLevel.Auto},e.getSelectedFontScale=function(t){var o=e.getStyleOverrides();return o?o.getFontScale(t):1},e.getStyleOverrides=function(){var e=StoryAppEdit.Model&&StoryAppEdit.Model.StoryModel;return e?e.traversalModel.getStyleOverrides():null},e}();e.StyleHelper=n}(StoryEditPageMain||(StoryEditPageMain={}));