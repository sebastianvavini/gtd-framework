if (typeof performance !== "undefined" && performance.mark) performance.mark("MeasureParseTime::start::Sway~DocumentNavigation.chunk.js");(window.webpackJsonp=window.webpackJsonp||[]).push([[4],{455:
/*!*******************************************************!*\
  !*** ./src/DocumentNavigation/index.tsx + 20 modules ***!
  \*******************************************************/
/*! exports provided: DocumentNavigationSelectors, initialize */
/*! all exports used */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@sway/documentmodel/js/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/@sway/internalapi/js/InternalApi.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/aria-roles/aria-roles.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/inversify/lib/inversify.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/mobx-safe/src/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/mobx/lib/mobx.module.js (<- Module uses injected variables (process, global)) */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/FocusZone/FocusZone.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/FocusZone/FocusZone.types.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/MessageBar/MessageBar.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/MessageBar/MessageBar.types.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Panel/Panel.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Panel/Panel.types.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Shimmer/Shimmer.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Shimmer/Shimmer.types.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/office-ui-fabric-react/lib/components/Shimmer/ShimmerElementsGroup/ShimmerElementsGroup.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/react-truncate-sway-fork/lib/Truncate.js */
/*! ModuleConcatenation bailout: Cannot concat with ./node_modules/react/index.js (<- Module is not an ECMAScript module) */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Adapters/InitializeOfficeFabric.tsx */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Common/BackgroundTaskWrapper.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Components/BootSelectors.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Components/Router/RouterStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Injection/BootInjectionTypes.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Logging/Logger.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Settings/FeatureGateList.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Boot/Utilities/NamedObserver.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/Referencing/ViewReferenceCache.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Components/SiteComponents/Navigation/DocumentNavigationLauncherStore.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Injection/ConsumptionInjectionTypes.ts */
/*! ModuleConcatenation bailout: Cannot concat with ./src/Consumption/Models/DocumentModelStore.ts */function(e,t,n){"use strict";n.r(t);var o={};n.r(o),n.d(o,"CannotBuildNavigation",function(){return m}),n.d(o,"CannotNavigate",function(){return f}),n.d(o,"CloseNavigation",function(){return b}),n.d(o,"NavigationHeader",function(){return y}),n.d(o,"TopOfSway",function(){return S});var i,r=n(346),a=n(0),c=n(49),s={Panel:c.b+"document-navigation-panel",Section:c.b+"document-navigation-section",SectionBody:c.b+"document-navigation-section-body",SectionHeading:c.b+"document-navigation-section-heading",SectionsList:c.b+"document-navigation-sections-list"},l=n(59),d=n(483),u=n(352),p=n(75),g=n(457),v=n(488),h=n(44),m="We're having trouble building your navigation. Try refreshing the page.",f="Oops! We just lost our place. Try navigating to another section.",b="Close navigation",y="Navigation",S="Top of Sway",_=n(504),N=n(299),E=n(19),j=n(2),w=n(3),x=n(7),O=function(){function e(e,t){this.lookupId=e,this.documentNavigationApi=t}return Object.defineProperty(e.prototype,"navigationResponse",{get:function(){return this._navigationResponse},enumerable:!0,configurable:!0}),e.prototype.refresh=function(){return __awaiter(this,void 0,void 0,function(){var e;return __generator(this,function(t){switch(t.label){case 0:return e=this.setNavigationResponse,[4,this.documentNavigationApi.getDocumentNavigation(this.lookupId)];case 1:return e.apply(this,[t.sent()]),[2]}})})},e.prototype.setNavigationResponse=function(e){this._navigationResponse=e},__decorate([w.observable],e.prototype,"_navigationResponse",void 0),__decorate([w.computed],e.prototype,"navigationResponse",null),__decorate([x.action],e.prototype,"setNavigationResponse",null),e=__decorate([Object(j.injectable)()],e)}();!function(e){e.CannotBuildNavigation="CannotBuildNavigation",e.CannotNavigate="CannotNavigate",e.NoError="NoError"}(i||(i={}));var P,C,R=function(){function e(e,t){this.documentNavigationResponseStore=e,this.logger=t,this.manualError=i.NoError}return Object.defineProperty(e.prototype,"errorType",{get:function(){var e=this.documentNavigationResponseStore.navigationResponse;return void 0===e||e.isSuccess?this.manualError:i.CannotBuildNavigation},enumerable:!0,configurable:!0}),e.prototype.receiveError=function(e){this.logger.logTag(595945614,E.b.Info,"Received navigation error",{errorType:e}),this.errorType===i.NoError&&(this.manualError=e)},__decorate([w.observable],e.prototype,"manualError",void 0),__decorate([w.computed],e.prototype,"errorType",null),__decorate([x.action],e.prototype,"receiveError",null),e=__decorate([Object(j.injectable)(),__param(0,Object(j.inject)(O)),__param(1,Object(j.inject)(E.c))],e)}(),k=((P={})[i.CannotBuildNavigation]=o.CannotBuildNavigation,P[i.CannotNavigate]=o.CannotNavigate,P),L=Object(h.a)("NavigationError",function(e){var t=e.store;return t.errorType===i.NoError?null:a.createElement(_.a,{messageBarType:N.a.warning},k[t.errorType])}),T=n(17);
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */!function(e){e[e.Small=0]="Small",e[e.Medium=1]="Medium",e[e.Large=2]="Large"}(C||(C={}));var D,I,F=function(){function e(e){this.viewport=e}return Object.defineProperty(e.prototype,"panelType",{get:function(){var e=this.viewport.size;return void 0===e||e.width<1024?C.Small:e.width<1920?C.Medium:C.Large},enumerable:!0,configurable:!0}),__decorate([w.computed],e.prototype,"panelType",null),e=__decorate([Object(j.injectable)(),__param(0,Object(j.inject)(T.a.Viewport))],e)}(),B=n(456),M=n(366),V=n(507),A=function(e){var t=e.height;return a.createElement(B.a,{flexWrap:!0,width:"100%",shimmerElements:[{type:M.a.gap,width:"100%",height:t}]})},H=function(e){var t=e.height,n=e.width;return a.createElement(B.a,{flexWrap:!0,width:"100%",shimmerElements:[{type:M.a.line,width:n+"%",height:t},{type:M.a.gap,width:100-n+"%",height:t}]})},z=Object(h.a)("SectionShimmer",function(){return a.createElement(V.a,{style:{padding:"0 20px"},customElementsGroup:a.createElement("div",{style:{display:"flex",flexDirection:"column"}},a.createElement(A,{height:25}),a.createElement(H,{height:2,width:100}),a.createElement(A,{height:25}),a.createElement("div",{style:{display:"flex",flexDirection:"row-reverse"}},a.createElement(B.a,{width:"90px",shimmerElements:[{type:M.a.gap,width:10,height:80},{type:M.a.line,height:80,width:80}]}),a.createElement("div",{style:{display:"flex",flexWrap:"wrap",width:"100%"}},a.createElement(A,{height:5}),a.createElement(H,{height:15,width:60}),a.createElement(A,{height:10}),a.createElement(H,{height:50,width:80})))),width:"100%"})}),W=n(58),G=n(453),q=4,U=12,J=4,K=16,X="#E2E1Df",Q={background:"none",border:"1px solid rgba(0, 0, 0, 0)",borderLeft:J+"px solid rgba(0, 0, 0, 0)",display:"block",outline:"none",textAlign:"initial",width:"100%","&:focus, &:hover":{backgroundColor:{background:"#F4F4F4",focus:{border:"#666"}}.background},"&:focus":{border:"1px solid "+{background:"#E3ECEA",border:"#666"}.border,borderLeft:J+"px solid "+"#008272","&:hover":{backgroundColor:{background:"#CEE0DD"}.background}}},Y=Object(h.a)("Section",function(e){var t=e.store,n=""!==t.entry.image,o=function(e,t,n,o){var i=o?4:0;return{fontStyleOverrides:{fontSize:16+function(e,t){return t?e?4:0:e?6:1}(e,o)+"px"},styles:{body:{color:"#484644",fontSize:"16px",fontFamily:"Segoe UI Regular",margin:"0 0 12px"},container:{alignItems:"center",borderLeft:t?"3px solid #008272":void 0,backgroundColor:t?"rgba(0,130,114,0.1)":void 0,cursor:"pointer",display:"flex",textAlign:"left",padding:[U+i+"px",K+i+"px",U+i+"px",K+i-J+"px"].join(" "),position:"relative",":not(:first-of-type):before":{background:X,bottom:0,content:" ",height:"1px",left:K+i+"px",position:"absolute",right:K+i+"px",top:0},"&:hover":{backgroundColor:t?"rgba(0,130,114,0.2)":"#F4F4F4",borderLeft:t?"3px solid #008272":void 0},"&:focus":{backgroundColor:t?"rgba(0,130,114,0.2)":"#F4F4F4",border:t?void 0:"2px solid #777"},"@media screen and (-ms-high-contrast: active)":{border:"1px solid #777",borderLeft:t?"3px solid #008272":void 0,"&:hover":{border:t?void 0:"3px solid #777",borderLeft:t?"3px solid #008272":void 0},"&:focus":{border:t?"3px solid #008272":"3px solid #777"}}},contents:{width:"100%"},heading:{color:"#252423",fontSize:"18px",fontFamily:"Segoe UI Semibold",margin:"0 0 "+(q+i)+"px"},image:{margin:n?"0 "+(i+16)+"px":"0",maxHeight:(o?90:72)+"px",maxWidth:(o?100:80)+"px"}}}}(n,t.isNearestEntry,t.isRtl,t.largePanel),i=o.fontStyleOverrides,r=o.styles;return a.createElement("button",{className:l(s.Section,t.styleProvider.css(Q),t.styleProvider.css(r.container)),onClick:t.navigate,role:W.Roles.Link},a.createElement("div",{className:t.styleProvider.css(r.contents)},a.createElement("h2",{className:l(s.SectionHeading,t.styleProvider.css(r.heading))},t.entry.heading),a.createElement(G.a,{className:l(s.SectionBody,t.styleProvider.css(r.body)),fontOverrides:i,lines:2,trimWhitespace:!0},t.entry.body)),n?a.createElement("img",{alt:"",className:t.styleProvider.css(r.image),role:W.Roles.Presentation,src:t.entry.image}):null)}),Z=Object(h.a)("SectionsList",function(e){var t=e.store;return void 0===t.sections?a.createElement(a.Fragment,null,a.createElement(z,null),a.createElement(z,null),a.createElement(z,null),a.createElement(z,null)):a.createElement("div",{className:s.SectionsList},t.sections.map(function(e){return e.available?a.createElement(Y,{store:e,key:e.entry.contractModelNodeId}):a.createElement(z,{key:e.key})}))}),$=((D={})[C.Small]=p.a.smallFixedFar,D[C.Medium]=p.a.medium,D[C.Large]=p.a.medium,D),ee=Object(h.a)("DocumentNavigation",function(e){var t=e.store,n=function(e){var t=e===C.Small?0:4;return{"& .ms-Overlay":{cursor:"default"},"& .ms-Panel-main":{borderLeft:0,"@media screen and (-ms-high-contrast: active)":{border:"1px solid #777"}},"& .ms-Button-flexContainer":{color:v.a.neutralPrimary},"& .ms-Panel-contentInner":{overflowX:"hidden"},"& .ms-Panel-contentInner .ms-Panel-content":{margin:0,padding:0},"& .ms-Panel-contentInner .ms-Panel-header":{margin:"0 "+(t+16)+"px "+(t+24)+"px",padding:0}}}(t.navigationPanelTypeStore.panelType);return a.createElement(g.a,{className:l(s.Panel,t.styleProvider.css(n)),closeButtonAriaLabel:o.CloseNavigation,headerText:o.NavigationHeader,isBlocking:!0,isLightDismiss:!0,isOpen:t.documentNavigationLauncherStore.launchStatus.requestedOpen,onDismiss:t.onDismiss,type:$[t.navigationPanelTypeStore.panelType]},a.createElement(d.a,{handleTabKey:u.b.all,isCircularNavigation:!0},a.createElement(L,{store:t.navigationErrorStore}),a.createElement(Z,{store:t.sectionsListStore})))}),te=n(29),ne=n(5);!function(e){e[e.Ready=0]="Ready",e[e.NotLoaded=1]="NotLoaded",e[e.Stale=2]="Stale"}(I||(I={}));var oe,ie=function(){function e(e,t,n,o,i,r){this.documentNavigationResponseStore=e,this.sectionStoreFactory=t,this.viewReferenceCache=n,this.viewport=o,this.featureGateList=i,this.syncStateStore=r}return e.prototype.startObservingChanges=function(){var e=this;this.sectionListState=I.NotLoaded,void 0!==this.syncStateStore&&this.featureGateList.isEnabled(ne.FeatureGates.OnCanvasAuthoring)&&Object(w.observe)(this.syncStateStore,"editVersion",function(t){return __awaiter(e,void 0,void 0,function(){return __generator(this,function(e){return[2,this.refreshNavigationEntriesIfNeeded(t)]})})}),Object(w.observe)(this.documentNavigationResponseStore,"navigationResponse",function(t){return e.refreshNavigationEntryState(t)})},e.prototype.updateNearestEntry=function(e){this._nearestEntry=e},e.prototype.refreshNavigationEntriesIfNeeded=function(e){return __awaiter(this,void 0,Promise,function(){return __generator(this,function(t){switch(t.label){case 0:return void 0!==e.oldValue&&void 0!==e.newValue&&e.oldValue<e.newValue?(this.sectionListState=I.Stale,[4,this.documentNavigationResponseStore.refresh()]):[3,2];case 1:t.sent(),t.label=2;case 2:return[2]}})})},e.prototype.refreshNavigationEntryState=function(e){void 0!==e.newValue&&e.newValue.isSuccess&&e.oldValue!==e.newValue&&(this.sectionListState=I.Ready)},Object.defineProperty(e.prototype,"sections",{get:function(){var e=this,t=this.documentNavigationResponseStore.navigationResponse;if(this.sectionListState===I.Ready&&void 0!==t&&t.isSuccess){var n=[__assign({},t.result.documentHeading,{heading:""===t.result.documentHeading.heading?o.TopOfSway:t.result.documentHeading.heading})].concat(Array.from(t.result.entries)),i=void 0!==this._nearestEntry?this._nearestEntry:this.findNearestEntry(n);return n.map(function(t,n){var o=e.viewReferenceCache.getPendingRef(t.contractModelNodeId),r=0===n||void 0!==o&&o.exists.get();return r?e.sectionStoreFactory.createSectionStore(t,t.contractModelNodeId===i.contractModelNodeId,function(t){return e.updateNearestEntry(t)}):{available:r,key:t.contractModelNodeId}})}},enumerable:!0,configurable:!0}),e.prototype.findNearestEntry=function(e){for(var t=this.viewport.getScroll(),n=[],o=0,i=e;o<i.length;o++){var r=i[o],a=this.viewReferenceCache.getPendingRef(r.contractModelNodeId);if(void 0!==a){var c=a.element.get();if(null!==c&&void 0!==c){var s=c.getBoundingClientRect().top,l=void 0!==this.viewport.size?this.viewport.size.height:0,d=s+t.top;if(t.top>=d&&n.push(r),t.top<=d&&t.top+l>d)return r}}}return 0===n.length?e[0]:n.slice(-1)[0]},__decorate([w.observable],e.prototype,"_nearestEntry",void 0),__decorate([w.observable],e.prototype,"sectionListState",void 0),__decorate([w.action],e.prototype,"updateNearestEntry",null),__decorate([w.action],e.prototype,"refreshNavigationEntriesIfNeeded",null),__decorate([w.action],e.prototype,"refreshNavigationEntryState",null),__decorate([w.computed],e.prototype,"sections",null),e=__decorate([Object(j.injectable)()],e)}(),re=function(){function e(e,t,n,o,i){var r=this;this.documentNavigationLauncherStore=e,this.navigationErrorStore=t,this.navigationPanelTypeStore=n,this.sectionsListStore=o,this.styleProvider=i,this.onDismiss=function(){r.documentNavigationLauncherStore.requestClose(),r.sectionsListStore.updateNearestEntry(void 0)}}return e=__decorate([Object(j.injectable)(),__param(0,Object(j.inject)(te.a)),__param(1,Object(j.inject)(R)),__param(2,Object(j.inject)(F)),__param(3,Object(j.inject)(ie)),__param(4,Object(j.inject)(T.a.StyleProvider))],e)}(),ae=n(61),ce=n(286),se=n(26),le=n(15),de=function(){function e(e,t){this.documentNavigationLauncherStore=e,this.navigationPanelTypeStore=t}return e.prototype.handleNavigation=function(){this.navigationPanelTypeStore.panelType===C.Small&&this.documentNavigationLauncherStore.requestClose()},e=__decorate([Object(j.injectable)(),__param(0,Object(j.inject)(te.a)),__param(1,Object(j.inject)(F))],e)}(),ue=n(18),pe=function(){function e(e,t,n,o,i,r,a,c){this.documentModelStore=e,this.navigationErrorStore=t,this.navigationPanelTypeStore=n,this.scrollTo=o,this.sectionNavigationHandler=i,this.styleProvider=r,this.viewReferenceCache=a,this.viewport=c}return e=__decorate([Object(j.injectable)(),__param(0,Object(j.inject)(ue.a)),__param(1,Object(j.inject)(R)),__param(2,Object(j.inject)(F)),__param(3,Object(j.inject)(T.a.ScrollTo)),__param(4,Object(j.inject)(de)),__param(5,Object(j.inject)(T.a.StyleProvider)),__param(6,Object(j.inject)(se.c)),__param(7,Object(j.inject)(T.a.Viewport))],e)}(),ge=n(69),ve=function(e){return e.type===ge.ContentNodeType.H1||e.type===ge.ContentNodeType.DocumentHeading},he=100,me=function(){function e(e,t,n,o){var r=this;this.backingSectionStore=e,this.entry=t,this.isNearestEntry=n,this.updateNearestEntry=o,this.available=!0,this.navigate=function(){return __awaiter(r,void 0,void 0,function(){var e,t,n,o,r,a;return __generator(this,function(c){switch(c.label){case 0:return e=this.findNavigationEntryParent(this.entry.contractModelNodeId),void 0!==(t=this.backingSectionStore.viewReferenceCache.getPendingRef(e))&&t.exists.get()?[4,t.elementPromise]:(this.backingSectionStore.navigationErrorStore.receiveError(i.CannotNavigate),[2]);case 1:return n=c.sent().get(),o=this.getScrollPosition(n,this.backingSectionStore.viewport.getScroll()),r=o.x,a=o.y,this.backingSectionStore.scrollTo(r,a),this.backingSectionStore.sectionNavigationHandler.handleNavigation(),this.updateNearestEntry(this.entry),[2]}})})},this.findNavigationEntryParent=function(e){for(var t=e,n=r.backingSectionStore.documentModelStore.model.contentNodes,o=e;void 0!==n[o]&&void 0!==n[o].parentId;){if(ve(n[o])){t=o;break}o=n[o].parentId}return t},this.getScrollPosition=function(e,t){var n=e.getBoundingClientRect();return{x:Math.max(0,n.left+t.left-he),y:Math.max(0,n.top+t.top-he)}}}return Object.defineProperty(e.prototype,"isRtl",{get:function(){return this.backingSectionStore.documentModelStore.model.documentProperties.isRtl},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"largePanel",{get:function(){return this.backingSectionStore.navigationPanelTypeStore.panelType!==C.Small},enumerable:!0,configurable:!0}),Object.defineProperty(e.prototype,"styleProvider",{get:function(){return this.backingSectionStore.styleProvider},enumerable:!0,configurable:!0}),__decorate([w.computed],e.prototype,"isRtl",null),__decorate([w.computed],e.prototype,"largePanel",null),e}(),fe=function(){function e(e){this.backingSectionStore=e}return e.prototype.createSectionStore=function(e,t,n){return new me(this.backingSectionStore,e,t,n)},e=__decorate([Object(j.injectable)(),__param(0,Object(j.inject)(pe))],e)}();
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */!function(e){e.DocumentNavigationApi="DocumentNavigationApi"}(oe||(oe={}));n.d(t,"initialize",function(){return be}),n.d(t,"DocumentNavigationSelectors",function(){return s});
/*!
 * Copyright Microsoft Corporation. All rights reserved.
 */
var be=function(e){return function(e){e.bind(pe).toSelf(),e.bind(re).toSelf(),e.bind(R).toSelf(),e.bind(F).toSelf(),e.bind(de).toSelf(),e.bind(fe).toSelf(),e.get(T.a.OpenWindow);var t=e.get(T.a.SiteSettingsStore),n=new ne.DocumentNavigationApi(t.settings.siteRootUrl,e.get(T.a.SwayApiFetcher));e.bind(oe.DocumentNavigationApi).toConstantValue(n);var o=e.get(ae.a).routeDetails,i=new O(o.lookupId,n);e.bind(O).toConstantValue(i),e.bind(ie).toConstantValue(new ie(e.get(O),e.get(fe),e.get(se.c),e.get(T.a.Viewport),e.get(ce.a),e.isBound(le.a.SyncStateStore)?e.get(le.a.SyncStateStore):void 0)),e.get(ie).startObservingChanges()}(e),e.get(r.a).wrapInBackground(e.get(O).refresh()),{view:a.createElement(ee,{store:e.get(re)})}}}}]);
if (typeof performance !== "undefined" && performance.mark) performance.mark("MeasureParseTime::end::Sway~DocumentNavigation.chunk.js");//# sourceMappingURL=Sway~DocumentNavigation.chunk.js.map